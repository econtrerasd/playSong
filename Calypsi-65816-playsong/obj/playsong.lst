###############################################################################
#                                                                             #
# Calypsi ISO C compiler for 65816                              version 3.6.6 #
#                                                       17/Aug/2022  23:46:32 #
# Command line: --core=65816 --code-model=large --data-model=small            #
#               --target=Foenix -I ./include --speed -O2 --debug              #
#               --list-file=obj/playsong.lst -o obj/playsong.o                #
#               src/playsong.c                                                #
#                                                                             #
###############################################################################

    \ 000000                      .rtmodel version,"1"
    \ 000000                      .rtmodel codeModel,"large"
    \ 000000                      .rtmodel dataModel,"small"
    \ 000000                      .rtmodel core,"65816"
    \ 000000                      .rtmodel huge,"0"
    \ 000000                      .rtmodel doubleSize,"32"
    \ 000000                      .rtmodel target,"foenix"
    \ 000000                      .extern _Div32
    \ 000000                      .extern _Dp
    \ 000000                      .extern _Float32Add
    \ 000000                      .extern _Float32LT
    \ 000000                      .extern _Float32Mul
    \ 000000                      .extern _Float32ToSInt32
    \ 000000                      .extern _SInt32ToFloat32
    \ 000000                      .extern _ValueSwitch16
    \ 000000                      .extern _Vfp
    \ 000000                      .extern exit
    \ 000000                      .extern printf
    \ 000000                      .extern strcmp
    \ 000000                      .extern strlen
0001                  // ------------------------------------------------
0002                  // playsong.c
0003                  // Functions to implement the Simple Music commands
0004                  // ------------------------------------------------
0005                  
0006                  #include <stdio.h>
0007                  #include <stdlib.h>
0008                  #include <string.h>
0009                  
0010                  // function prototype
0011                  int addTrack(char tune[], int trackNumber, int rows, int cols, unsigned char (*Tracker)[cols]);
0012                  void cleanTracks(int rows,int cols,unsigned char (*Tracker)[cols]);
0013                  void showTracks(int rows,int cols,unsigned char (*Tracker)[cols]);
0014                  void playSongSID(int rows,int cols, unsigned char (*Tracker)[cols], int tempo);
0015                  int setInstrumentSID(int voice, int instrument);
0016                  void delay (float value);
0017                  void resetSID();
0018                  
0019                  // SID DEFINITIONS (Foenix U+ C256)
0020                  #define SID0_V1_FREQ_LO          (*(volatile __far uint8_t *)0xafe400)  //voice 1 Freq Low (Write Only)
0021                  #define SID0_V1_FREQ_HI          (*(volatile __far uint8_t *)0xafe401)  //voice 1 Freq Hi  (Write Only)
0022                  #define SID0_V1_PW_LO            (*(volatile __far uint8_t *)0xafe402)  //voice 1 Pulse Width Low (Write Only)
0023                  #define SID0_V1_PW_HI            (*(volatile __far uint8_t *)0xafe403)  //voice 1 Pulse Width Hi (Write Only)   [Unused (bits 7-4), Pulse Hi Nibble (bits 0-3)]
0024                  #define SID0_V1_CTRL             (*(volatile __far uint8_t *)0xafe404)  //voice 1 Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc3->Osc1 (bit 2), Sync Osc1->Osc3 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0025                  #define SID0_V1_ATCK_DECY        (*(volatile __far uint8_t *)0xafe405)  //voice 1 Attack/Decay (Write Only)     [Attack (bits 7-4), Decay (bits 0- 3)]
0026                  #define SID0_V1_SSTN_RLSE        (*(volatile __far uint8_t *)0xafe406)  //voice 1 Sustain/Release (Write Only)  [Sustain (bits 7-4), Release (bits 0- 3)]
0027                  #define SID0_V2_FREQ_LO          (*(volatile __far uint8_t *)0xafe407)  //voice 2 Freq Low (Write Only)
0028                  #define SID0_V2_FREQ_HI          (*(volatile __far uint8_t *)0xafe408)  //voice 2 Freq Hi  (Write Only)
0029                  #define SID0_V2_PW_LO            (*(volatile __far uint8_t *)0xafe409)  //voice 2 Pulse Width Low (Write Only)
0030                  #define SID0_V2_PW_HI            (*(volatile __far uint8_t *)0xafe40A)  //voice 2 Pulse Width Hi (Write Only)   [Unused (bits 7-4), Pulse Hi Nibble (bits 0-3)]
0031                  #define SID0_V2_CTRL             (*(volatile __far uint8_t *)0xafe40B)  //voice 2 Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc1->Osc2 (bit 2), Sync Osc1->Osc2 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0032                  #define SID0_V2_ATCK_DECY        (*(volatile __far uint8_t *)0xafe40C)  //voice 2 Attack/Decay (Write Only)     [Attack (bits 7-4), Decay (bits 0- 3)]
0033                  #define SID0_V2_SSTN_RLSE        (*(volatile __far uint8_t *)0xafe40D)  //voice 2 Sustain/Release (Write Only)  [Sustain (bits 7-4), Release (bits 0- 3)]
0034                  #define SID0_V3_FREQ_LO          (*(volatile __far uint8_t *)0xafe40E)  //voice 2 Freq Low (Write Only)
0035                  #define SID0_V3_FREQ_HI          (*(volatile __far uint8_t *)0xafe40F)  //voice 2 Freq Hi  (Write Only)
0036                  #define SID0_V3_PW_LO            (*(volatile __far uint8_t *)0xafe410)  //voice 2 Pulse Width Low (Write Only)
0037                  #define SID0_V3_PW_HI            (*(volatile __far uint8_t *)0xafe411)  //voice 2 Pulse Width Hi (Write Only)   [Unused (bits 7-4), Pulse Hi Nibble (bits 0-3)]
0038                  #define SID0_V3_CTRL             (*(volatile __far uint8_t *)0xafe412)  //voice 2 Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc2->Osc3 (bit 2), Sync Osc2->Osc3 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0039                  #define SID0_V3_ATCK_DECY        (*(volatile __far uint8_t *)0xafe413)  //voice 2 Attack/Decay (Write Only)     [Attack (bits 7-4), Decay (bits 0- 3)]
0040                  #define SID0_V3_SSTN_RLSE        (*(volatile __far uint8_t *)0xafe414)  //voice 2 Sustain/Release (Write Only)  [Sustain (bits 7-4), Release (bits 0- 3)]
0041                  #define SID0_FC_LO               (*(volatile __far uint8_t *)0xafe415)  //Filter Cutoff Low (Write Only)        [Unused (bits 7-4), Low-Nybble Bits (3-0)]
0042                  #define SID0_FC_HI               (*(volatile __far uint8_t *)0xafe416)  //Filter Cutoff Hi  (Write Only)        
0043                  #define SID0_RES_FILT            (*(volatile __far uint8_t *)0xafe417)  //Resonance/Filter Enable  (Write Only) [Resonance (bits 4-7), Filter voice 3 (bit 2), Filter voice 2 (bit 1), Filter voice 1 (bit 0)]
0044                  #define SID0_MODE_VOL            (*(volatile __far uint8_t *)0xafe418)  //Volume/Filter Type  (Write Only)      [High pass (bit 6), Bandpass (bit 5), Low pass (bit 4), Volume (bits 0- 3 )]
0045                  #define SID0_POT_X               (*(volatile __far uint8_t *)0xafe419)  //POT X (C256 - NOT USED)
0046                  #define SID0_POT_Y               (*(volatile __far uint8_t *)0xafe41A)  //POT Y (C256 - NOT USED)
0047                  #define SID0_OSC3_RND            (*(volatile __far uint8_t *)0xafe41B)  //OSC3 / RANDOM (Read Only)
0048                  #define SID0_ENV3                (*(volatile __far uint8_t *)0xafe41C)  //Misc (Read Only)  - ENV3
0049                  #define SID0_U1                  (*(volatile __far uint8_t *)0xafe41D)  //SID - L - NOT USED
0050                  #define SID0_U2                  (*(volatile __far uint8_t *)0xafe41E)  //SID - L - NOT USED
0051                  #define SID0_U3                  (*(volatile __far uint8_t *)0xafe41F)  //SID - L - NOT USED
0052                  
0053                  
0054                  const char notes[96][4]={
    \ 000000                      .section cdata,rodata
    \ 000000                      .public notes
    \ 000000 43300000 notes:      .byte   67,48,0,0
    \ 000004 43233000             .byte   67,35,48,0
    \ 000008 44300000             .byte   68,48,0,0
    \ 00000c 44233000             .byte   68,35,48,0
    \ 000010 45300000             .byte   69,48,0,0
    \ 000014 46300000             .byte   70,48,0,0
    \ 000018 46233000             .byte   70,35,48,0
    \ 00001c 47300000             .byte   71,48,0,0
    \ 000020 47233000             .byte   71,35,48,0
    \ 000024 41300000             .byte   65,48,0,0
    \ 000028 41233000             .byte   65,35,48,0
    \ 00002c 42300000             .byte   66,48,0,0
    \ 000030 43310000             .byte   67,49,0,0
    \ 000034 43233100             .byte   67,35,49,0
    \ 000038 44310000             .byte   68,49,0,0
    \ 00003c 44233100             .byte   68,35,49,0
    \ 000040 45310000             .byte   69,49,0,0
    \ 000044 46310000             .byte   70,49,0,0
    \ 000048 46233100             .byte   70,35,49,0
    \ 00004c 47310000             .byte   71,49,0,0
    \ 000050 47233100             .byte   71,35,49,0
    \ 000054 41310000             .byte   65,49,0,0
    \ 000058 41233100             .byte   65,35,49,0
    \ 00005c 42310000             .byte   66,49,0,0
    \ 000060 43320000             .byte   67,50,0,0
    \ 000064 43233200             .byte   67,35,50,0
    \ 000068 44320000             .byte   68,50,0,0
    \ 00006c 44233200             .byte   68,35,50,0
    \ 000070 45320000             .byte   69,50,0,0
    \ 000074 46320000             .byte   70,50,0,0
    \ 000078 46233200             .byte   70,35,50,0
    \ 00007c 47320000             .byte   71,50,0,0
    \ 000080 47233200             .byte   71,35,50,0
    \ 000084 41320000             .byte   65,50,0,0
    \ 000088 41233200             .byte   65,35,50,0
    \ 00008c 42320000             .byte   66,50,0,0
    \ 000090 43330000             .byte   67,51,0,0
    \ 000094 43233300             .byte   67,35,51,0
    \ 000098 44330000             .byte   68,51,0,0
    \ 00009c 44233300             .byte   68,35,51,0
    \ 0000a0 45330000             .byte   69,51,0,0
    \ 0000a4 46330000             .byte   70,51,0,0
    \ 0000a8 46233300             .byte   70,35,51,0
    \ 0000ac 47330000             .byte   71,51,0,0
    \ 0000b0 47233300             .byte   71,35,51,0
    \ 0000b4 41330000             .byte   65,51,0,0
    \ 0000b8 41233300             .byte   65,35,51,0
    \ 0000bc 42330000             .byte   66,51,0,0
    \ 0000c0 43340000             .byte   67,52,0,0
    \ 0000c4 43233400             .byte   67,35,52,0
    \ 0000c8 44340000             .byte   68,52,0,0
    \ 0000cc 44233400             .byte   68,35,52,0
    \ 0000d0 45340000             .byte   69,52,0,0
    \ 0000d4 46340000             .byte   70,52,0,0
    \ 0000d8 46233400             .byte   70,35,52,0
    \ 0000dc 47340000             .byte   71,52,0,0
    \ 0000e0 47233400             .byte   71,35,52,0
    \ 0000e4 41340000             .byte   65,52,0,0
    \ 0000e8 41233400             .byte   65,35,52,0
    \ 0000ec 42340000             .byte   66,52,0,0
    \ 0000f0 43350000             .byte   67,53,0,0
    \ 0000f4 43233500             .byte   67,35,53,0
    \ 0000f8 44350000             .byte   68,53,0,0
    \ 0000fc 44233500             .byte   68,35,53,0
    \ 000100 45350000             .byte   69,53,0,0
    \ 000104 46350000             .byte   70,53,0,0
    \ 000108 46233500             .byte   70,35,53,0
    \ 00010c 47350000             .byte   71,53,0,0
    \ 000110 47233500             .byte   71,35,53,0
    \ 000114 41350000             .byte   65,53,0,0
    \ 000118 41233500             .byte   65,35,53,0
    \ 00011c 42350000             .byte   66,53,0,0
    \ 000120 43360000             .byte   67,54,0,0
    \ 000124 43233600             .byte   67,35,54,0
    \ 000128 44360000             .byte   68,54,0,0
    \ 00012c 44233600             .byte   68,35,54,0
    \ 000130 45360000             .byte   69,54,0,0
    \ 000134 46360000             .byte   70,54,0,0
    \ 000138 46233600             .byte   70,35,54,0
    \ 00013c 47360000             .byte   71,54,0,0
    \ 000140 47233600             .byte   71,35,54,0
    \ 000144 41360000             .byte   65,54,0,0
    \ 000148 41233600             .byte   65,35,54,0
    \ 00014c 42360000             .byte   66,54,0,0
    \ 000150 43370000             .byte   67,55,0,0
    \ 000154 43233700             .byte   67,35,55,0
    \ 000158 44370000             .byte   68,55,0,0
    \ 00015c 44233700             .byte   68,35,55,0
    \ 000160 45370000             .byte   69,55,0,0
    \ 000164 46370000             .byte   70,55,0,0
    \ 000168 46233700             .byte   70,35,55,0
    \ 00016c 47370000             .byte   71,55,0,0
    \ 000170 47233700             .byte   71,35,55,0
    \ 000174 41370000             .byte   65,55,0,0
    \ 000178 41233700             .byte   65,35,55,0
    \ 00017c 42370000             .byte   66,55,0,0
0055                  	"C0","C#0","D0","D#0","E0","F0","F#0","G0","G#0","A0","A#0","B0",
0056                  	"C1","C#1","D1","D#1","E1","F1","F#1","G1","G#1","A1","A#1","B1",
0057                  	"C2","C#2","D2","D#2","E2","F2","F#2","G2","G#2","A2","A#2","B2",
0058                  	"C3","C#3","D3","D#3","E3","F3","F#3","G3","G#3","A3","A#3","B3",
0059                  	"C4","C#4","D4","D#4","E4","F4","F#4","G4","G#4","A4","A#4","B4",
0060                  	"C5","C#5","D5","D#5","E5","F5","F#5","G5","G#5","A5","A#5","B5",
0061                  	"C6","C#6","D6","D#6","E6","F6","F#6","G6","G#6","A6","A#6","B6",
0062                  	"C7","C#7","D7","D#7","E7","F7","F#7","G7","G#7","A7","A#7","B7"
0063                  };
0064                  
0065                  const float frequency[]  // Equal tempered scale values (Frequency)
    \ 000000                      .section cdata,rodata
    \ 000000                      .public frequency
    \ 000000 e5d08241 frequency:  .long   1099092197,1099599708,1100139725,1100716442,1101319373,1101964247,1102640579,1103364096
    \ 000004 5c8f8a41
    \ 000008 cdcc9241
    \ 00000c 9a999b41
    \ 000010 cdcca441
    \ 000014 d7a3ae41
    \ 000018 c3f5b841
    \ 00001c 0000c441
    \ 000020 14aecf41             .long   1104129556,1104936960,1105794276,1106702605,1107480596,1107990361,1108530456,1109102664
    \ 000024 0000dc41
    \ 000028 e414e941
    \ 00002c 0df1f641
    \ 000030 14d00242
    \ 000034 59970a42
    \ 000038 18d51242
    \ 00003c 48901b42
    \ 000040 48d02442             .long   1109708872,1110351151,1111031624,1111752547,1112516356,1113325568,1114182910,1115091213
    \ 000044 2f9d2e42
    \ 000048 48ff3842
    \ 00004c 63ff4342
    \ 000050 04a74f42
    \ 000054 00005c42
    \ 000058 fe146942
    \ 00005c 0df17642
    \ 000060 14d08242             .long   1115869204,1116378982,1116919064,1117491259,1118097493,1118739772,1119420232,1120141168
    \ 000064 66978a42
    \ 000068 18d59242
    \ 00006c 3b909b42
    \ 000070 55d0a442
    \ 000074 3c9dae42
    \ 000078 48ffb842
    \ 00007c 70ffc342
    \ 000080 e9a6cf42             .long   1120904937,1121714176,1122571518,1123479847,1124257825,1124767564,1125307646,1125879841
    \ 000084 0000dc42
    \ 000088 fe14e942
    \ 00008c 27f1f642
    \ 000090 21d00243
    \ 000094 4c970a43
    \ 000098 fed41243
    \ 00009c 21901b43
    \ 0000a0 62d02443             .long   1126486114,1127128367,1127808827,1128529789,1129293545,1130102784,1130960126,1131868455
    \ 0000a4 2f9d2e43
    \ 0000a8 3bff3843
    \ 0000ac 7dff4343
    \ 0000b0 e9a64f43
    \ 0000b4 00005c43
    \ 0000b8 fe146943
    \ 0000bc 27f17643
    \ 0000c0 21d08243             .long   1132646433,1133156205,1133696287,1134268482,1134874722,1135516975,1136197435,1136918364
    \ 0000c4 6d978a43
    \ 0000c8 1fd59243
    \ 0000cc 42909b43
    \ 0000d0 62d0a443
    \ 0000d4 2f9dae43
    \ 0000d8 3bffb843
    \ 0000dc 5cffc343
    \ 0000e0 0aa7cf43             .long   1137682186,1138491392,1139348734,1140257030,1141035024,1141544796,1142084895,1142657090
    \ 0000e4 0000dc43
    \ 0000e8 fe14e943
    \ 0000ec 06f1f643
    \ 0000f0 10d00244
    \ 0000f4 5c970a44
    \ 0000f8 1fd51244
    \ 0000fc 42901b44
    \ 000100 52d02444             .long   1143263314,1143905583,1144586060,1145306989,1146070778,1146880000,1147737342,1148645655
    \ 000104 2f9d2e44
    \ 000108 4cff3844
    \ 00010c 6dff4344
    \ 000110 faa64f44
    \ 000114 00005c44
    \ 000118 fe146944
    \ 00011c 17f17644
    \ 000120 00d08244             .long   1149423616,1149933404,1150473503,1151045714,1151651922,1152294175,1152974684,1153695580
    \ 000124 5c978a44
    \ 000128 1fd59244
    \ 00012c 52909b44
    \ 000130 52d0a444
    \ 000134 1f9dae44
    \ 000138 5cffb844
    \ 00013c 5cffc344
    \ 000140 0aa7cf44             .long   1154459402,1155268608,1156125983,1157034230,1157812224,1158322012,1158862111,1159434322
    \ 000144 0000dc44
    \ 000148 1f15e944
    \ 00014c f6f0f644
    \ 000150 00d00245
    \ 000154 5c970a45
    \ 000158 1fd51245
    \ 00015c 52901b45
    \ 000160 52d02445             .long   1160040530,1160682824,1161363292,1162084188,1162848010,1163657216,1164514550,1165422879
    \ 000164 489d2e45
    \ 000168 5cff3845
    \ 00016c 5cff4345
    \ 000170 0aa74f45
    \ 000174 00005c45
    \ 000178 f6146945
    \ 00017c 1ff17645
0066                  ={
0067                  	16.3520,17.3200,18.3500,19.4500,20.6000,21.8300,23.1200,24.5000,25.9600,27.5000,29.1352,30.8677,
0068                  	32.7032,34.6478,36.7081,38.8909,41.2034,43.6535,46.2493,48.9994,51.9131,55.0000,58.2705,61.7354,
0069                  	65.4064,69.2957,73.4162,77.7817,82.4069,87.3071,92.4986,97.9989,103.826,110.000,116.541,123.471,
0070                  	130.813,138.591,146.832,155.563,164.814,174.614,184.997,195.998,207.652,220.000,233.082,246.942,
0071                  	261.626,277.183,293.665,311.127,329.628,349.228,369.994,391.995,415.305,440.000,466.164,493.883,
0072                  	523.251,554.365,587.330,622.254,659.255,698.456,739.989,783.991,830.609,880.000,932.328,987.767,
0073                  	1046.50,1108.73,1174.66,1244.51,1318.51,1396.91,1479.98,1567.98,1661.22,1760.00,1864.66,1975.53,
0074                  	2093.00,2217.46,2349.32,2489.02,2637.02,2793.83,2959.96,3135.96,3322.44,3520.00,3729.31,3951.07
0075                  };
0076                  
0077                  const unsigned char SidNotes[96][2]={  // Sid HI, Sid Low
    \ 000000                      .section cdata,rodata
    \ 000000                      .public SidNotes
    \ 000000 010c     SidNotes:   .byte   1,12
    \ 000002 011c                 .byte   1,28
    \ 000004 012d                 .byte   1,45
    \ 000006 013e                 .byte   1,62
    \ 000008 0151                 .byte   1,81
    \ 00000a 0166                 .byte   1,102
    \ 00000c 017b                 .byte   1,123
    \ 00000e 0191                 .byte   1,-111
    \ 000010 01a9                 .byte   1,-87
    \ 000012 01c3                 .byte   1,-61
    \ 000014 01dd                 .byte   1,-35
    \ 000016 01fa                 .byte   1,-6
    \ 000018 0218                 .byte   2,24
    \ 00001a 0238                 .byte   2,56
    \ 00001c 025a                 .byte   2,90
    \ 00001e 027d                 .byte   2,125
    \ 000020 02a3                 .byte   2,-93
    \ 000022 02cc                 .byte   2,-52
    \ 000024 02f6                 .byte   2,-10
    \ 000026 0323                 .byte   3,35
    \ 000028 0353                 .byte   3,83
    \ 00002a 0386                 .byte   3,-122
    \ 00002c 03bb                 .byte   3,-69
    \ 00002e 03f4                 .byte   3,-12
    \ 000030 0430                 .byte   4,48
    \ 000032 0470                 .byte   4,112
    \ 000034 04b4                 .byte   4,-76
    \ 000036 04fb                 .byte   4,-5
    \ 000038 0547                 .byte   5,71
    \ 00003a 0598                 .byte   5,-104
    \ 00003c 05ed                 .byte   5,-19
    \ 00003e 0647                 .byte   6,71
    \ 000040 06a7                 .byte   6,-89
    \ 000042 070c                 .byte   7,12
    \ 000044 0777                 .byte   7,119
    \ 000046 07e9                 .byte   7,-23
    \ 000048 0861                 .byte   8,97
    \ 00004a 08e1                 .byte   8,-31
    \ 00004c 0968                 .byte   9,104
    \ 00004e 09f7                 .byte   9,-9
    \ 000050 0a8f                 .byte   10,-113
    \ 000052 0b30                 .byte   11,48
    \ 000054 0bda                 .byte   11,-38
    \ 000056 0c8f                 .byte   12,-113
    \ 000058 0d4e                 .byte   13,78
    \ 00005a 0e18                 .byte   14,24
    \ 00005c 0eef                 .byte   14,-17
    \ 00005e 0fd2                 .byte   15,-46
    \ 000060 10c3                 .byte   16,-61
    \ 000062 11c3                 .byte   17,-61
    \ 000064 12d1                 .byte   18,-47
    \ 000066 13ef                 .byte   19,-17
    \ 000068 151f                 .byte   21,31
    \ 00006a 1660                 .byte   22,96
    \ 00006c 17b5                 .byte   23,-75
    \ 00006e 191e                 .byte   25,30
    \ 000070 169c                 .byte   22,-100
    \ 000072 1c31                 .byte   28,49
    \ 000074 1ddf                 .byte   29,-33
    \ 000076 1fa5                 .byte   31,-91
    \ 000078 2187                 .byte   33,-121
    \ 00007a 2386                 .byte   35,-122
    \ 00007c 25a2                 .byte   37,-94
    \ 00007e 27df                 .byte   39,-33
    \ 000080 2a3e                 .byte   42,62
    \ 000082 2cc1                 .byte   44,-63
    \ 000084 2f6b                 .byte   47,107
    \ 000086 323c                 .byte   50,60
    \ 000088 3539                 .byte   53,57
    \ 00008a 3863                 .byte   56,99
    \ 00008c 3bbe                 .byte   59,-66
    \ 00008e 3f4b                 .byte   63,75
    \ 000090 430f                 .byte   67,15
    \ 000092 470c                 .byte   71,12
    \ 000094 4b45                 .byte   75,69
    \ 000096 4fbf                 .byte   79,-65
    \ 000098 547d                 .byte   84,125
    \ 00009a 5983                 .byte   89,-125
    \ 00009c 5ed6                 .byte   94,-42
    \ 00009e 6479                 .byte   100,121
    \ 0000a0 6a73                 .byte   106,115
    \ 0000a2 70c7                 .byte   112,-57
    \ 0000a4 777c                 .byte   119,124
    \ 0000a6 7e97                 .byte   126,-105
    \ 0000a8 861e                 .byte   -122,30
    \ 0000aa 8e18                 .byte   -114,24
    \ 0000ac 968b                 .byte   -106,-117
    \ 0000ae 9f7e                 .byte   -97,126
    \ 0000b0 a8fa                 .byte   -88,-6
    \ 0000b2 b306                 .byte   -77,6
    \ 0000b4 bdac                 .byte   -67,-84
    \ 0000b6 c8f3                 .byte   -56,-13
    \ 0000b8 d4e6                 .byte   -44,-26
    \ 0000ba e18f                 .byte   -31,-113
    \ 0000bc eef8                 .byte   -18,-8
    \ 0000be fdf6                 .byte   -3,-10
0078                  	{1,12},{1,28},{1,45},{1,62},{1,81},{1,102},{1,123},{1,145},{1,169},{1,195},{1,221},{1,250}, //Octave0
0079                  	{2,24},{2,56},{2,90},{2,125},{2,163},{2,204},{2,246},{3,35},{3,83},{3,134},{3,187},{3,244}, //Octave1
0080                  	{4,48},{4,112},{4,180},{4,251},{5,71},{5,152},{5,237},{6,71},{6,167},{7,12},{7,119},{7,233}, //Octave2
0081                  	{8,97},{8,225},{9,104},{9,247},{10,143},{11,48},{11,218},{12,143},{13,78},{14,24},{14,239},{15,210}, //Octave3
0082                  	{16,195},{17,195},{18,209},{19,239},{21,31},{22,96},{23,181},{25,30},{026,156},{28,49},{29,223},{31,165}, //Octave4
0083                  	{33,135},{35,134},{37,162},{39,223},{42,62},{44,193},{47,107},{50,60},{53,57},{56,99},{59,190},{63,75}, //Octave5
0084                  	{67,15},{71,12},{75,69},{79,191},{84,125},{89,131},{94,214},{100,121},{106,115},{112,199},{119,124},{126,151}, //Octave6
0085                  	{134,30},{142,24},{150,139},{159,126},{168,250},{179,6},{189,172},{200,243},{212,230},{225,143},{238,248},{253,246}  //Octave7
0086                  };
0087                  
0088                  // list of Instruments from c128 user manual
0089                  const int SID_envelope[16][8]={
    \ 000000                      .section cdata,rodata
    \ 000000                      .public SID_envelope
    \ 000000          SID_envelope:
    \ 000000 00000900             .word   0,9,0,0,4,2048,2,0
    \ 000004 00000000
    \ 000008 04000008
    \ 00000c 02000000
    \ 000010 08000200             .word   8,2,6,1,2,0,3,0
    \ 000014 06000100
    \ 000018 02000000
    \ 00001c 03000000
    \ 000020 05000800             .word   5,8,13,2,4,128,3,0
    \ 000024 0d000200
    \ 000028 04008000
    \ 00002c 03000000
    \ 000030 00000500             .word   0,5,5,0,8,0,1,0
    \ 000034 05000000
    \ 000038 08000000
    \ 00003c 01000000
    \ 000040 05000200             .word   5,2,15,0,1,0,1,0
    \ 000044 0f000000
    \ 000048 01000000
    \ 00004c 01000000
    \ 000050 00000800             .word   0,8,3,4,2,0,3,0
    \ 000054 03000400
    \ 000058 02000000
    \ 00005c 03000000
    \ 000060 00000900             .word   0,9,0,0,4,512,2,0
    \ 000064 00000000
    \ 000068 04000002
    \ 00006c 02000000
    \ 000070 00000300             .word   0,3,15,0,4,2560,1,0
    \ 000074 0f000000
    \ 000078 0400000a
    \ 00007c 01000000
    \ 000080 07000700             .word   7,7,3,1,4,768,3,0
    \ 000084 03000100
    \ 000088 04000003
    \ 00008c 03000000
    \ 000090 00000800             .word   0,8,0,0,1,0,3,0
    \ 000094 00000000
    \ 000098 01000000
    \ 00009c 03000000
    \ 0000a0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000a4 00000000
    \ 0000a8 00000000
    \ 0000ac 00000000
    \ 0000b0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000b4 00000000
    \ 0000b8 00000000
    \ 0000bc 00000000
    \ 0000c0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000c4 00000000
    \ 0000c8 00000000
    \ 0000cc 00000000
    \ 0000d0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000d4 00000000
    \ 0000d8 00000000
    \ 0000dc 00000000
    \ 0000e0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000e4 00000000
    \ 0000e8 00000000
    \ 0000ec 00000000
    \ 0000f0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000f4 00000000
    \ 0000f8 00000000
    \ 0000fc 00000000
0090                  	// atk, dcy, sust, rel, wave [8-Noise Wave, 4-Pulse Wave, 2-Saw Wave, 1-Triangle Wave], pulseWidth, note length [1-normal, 2-legato (long), 3-staccato (short)]
0091                  	// note it's rarely used but you can add wave numbers to produce a more complex wave!! - see Distorted Synth, it has 5 as wave value (4 pulse + 1 triangle)
0092                  	{0,9,0,0,4,2048,2},  // 1.Piano
0093                  	{8,2,6,1,2,0,3},    // 2.Accordion
0094                  	{5,8,13,2,4,128,3},  // 3.Distorted Synth
0095                  	{0,5,5,0,8,0,1},     // 4.GunShots
0096                  	{5,2,15,0,1,0,1},     // 5.Flute
0097                  	{0,8,3,4,2,0,3},     // 6.Guitar
0098                  	{0,9,0,0,4,512,2},   // 7.Harpsichord
0099                  	{0,3,15,0,4,2560,1},  // 8.Organ
0100                  	{7,7,3,1,4,768,3},   // 9.Oboe
0101                  	{0,8,0,0,1,0,3}      // 10.Xylophone
0102                  };
0103                  
0104                  const float noteLen[4]={0.75, 1.00 ,0.51}; // notelength for voices 1-3 (normal, legatto, staccatto)
    \ 000000                      .section cdata,rodata
    \ 000000                      .public noteLen
    \ 000000 0000403f noteLen:    .long   1061158912,1065353216,1057132380,0
    \ 000004 0000803f
    \ 000008 5c8f023f
    \ 00000c 00000000
0105                  
0106                  int addTrack(char tune[], int trackNumber, int rows, int cols, unsigned char (*Tracker)[cols])
0107                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public addTrack
    \ 000000 a8       addTrack:   tay
    \ 000001 3b                   tsc
    \ 000002 38                   sec
    \ 000003 e92600               sbc     ##38
    \ 000006 1b                   tcs
    \ 000007 98                   tya
    \ 000008 8324                 sta     36,s
0108                  	int tuneSize, c, t, pos, octave, octaveSubs, instrument, duration, volume, index;
0109                  	bool noteFlag, modFlag;
0110                  	char note[5];
0111                  	int gateOff, lengthNote;
0112                  	
0113                  	// set default value for parameters
0114                  	
0115                  	octave=4; // set default octave
    \ 00000a a90400               lda     ##4
    \ 00000d 8303                 sta     3,s
0116                  	instrument=1; // set default Instrument (SID Piano)
    \ 00000f a90100               lda     ##1
    \ 000012 8305                 sta     5,s
0117                  	volume=10; // set default volume 
    \ 000014 a90a00               lda     ##10
    \ 000017 8307                 sta     7,s
0118                  	trackNumber-=1; // First Tracks for users is track 1, but for functions it is track 0
    \ 000019 a5..                 lda     dp:.tiny _Dp
    \ 00001b 3a                   dec     a
    \ 00001c 8322                 sta     34,s
0119                  	
0120                  	// Initialize counters
0121                  	c=0;t=0; octaveSubs=0;
    \ 00001e a90000               lda     ##0
    \ 000021 8309                 sta     9,s
    \ 000023 830b                 sta     11,s
    \ 000025 1a                   inc     a
    \ 000026 3a                   dec     a
    \ 000027 8301                 sta     1,s
0122                  	
0123                  	tuneSize = strlen(tune);
    \ 000029 a324                 lda     36,s
    \ 00002b 22......             jsl     long:strlen
    \ 00002f 8311                 sta     17,s
0124                  	
0125                  	while (c<tuneSize)
    \ 000031 a309                 lda     9,s
    \ 000033 8317                 sta     23,s
    \ 000035 a30b                 lda     11,s
    \ 000037 8315                 sta     21,s
    \ 000039 a303                 lda     3,s
    \ 00003b 8319                 sta     25,s
    \ 00003d a305                 lda     5,s
    \ 00003f 830f                 sta     15,s
    \ 000041 a30d                 lda     13,s
    \ 000043 8303                 sta     3,s
    \ 000045 a307                 lda     7,s
    \ 000047 830d     `?L281`:    sta     13,s
    \ 000049 a317                 lda     23,s
    \ 00004b 38                   sec
    \ 00004c e311                 sbc     17,s
    \ 00004e 5003                 bvc     `?L215`
    \ 000050 490080               eor     ##-32768
    \ 000053 3003     `?L215`:    bmi     `?L357`
    \ 000055 4c....               jmp     .kbank `?L5`
    \ 000058          `?L357`:
0126                  	{
0127                  		pos=0;
    \ 000058 a90000               lda     ##0
    \ 00005b 8313                 sta     19,s
0128                  		octaveSubs=0;
    \ 00005d 8309                 sta     9,s
0129                  		modFlag=false;
    \ 00005f 830b                 sta     11,s
0130                  		noteFlag=false;
    \ 000061 1a                   inc     a
    \ 000062 3a                   dec     a
    \ 000063 8301                 sta     1,s
0131                  		// is code a note (A-G) or rest (R)?, if it is check the following: 
0132                  		// 1. is it sharp or flat? 
0133                  		// 2. has a specified Octave?
0134                  		// 3. has a duration?
0135                  		if ((tune[c]>='A' && tune[c]<='G') || (tune[c]=='R'))
    \ 000065 22......             jsl     long:`?L303`
    \ 000069 c941                 cmp     #65
    \ 00006b c220                 rep     #32
    \ 00006d 900e                 bcc     `?L194`
    \ 00006f a324                 lda     36,s
    \ 000071 a8                   tay
    \ 000072 a94700               lda     ##71
    \ 000075 e220                 sep     #32
    \ 000077 d317                 cmp     (23,s),y
    \ 000079 c220                 rep     #32
    \ 00007b b00d                 bcs     `?L9`
    \ 00007d          `?L194`:
    \ 00007d 22......             jsl     long:`?L303`
    \ 000081 c952                 cmp     #82
    \ 000083 c220                 rep     #32
    \ 000085 f003                 beq     `?L358`
    \ 000087 4c....               jmp     .kbank `?L7`
    \ 00008a          `?L358`:
    \ 00008a          `?L9`:
0136                  		{
0137                  			noteFlag=true;
    \ 00008a a90100               lda     ##1
    \ 00008d 8301                 sta     1,s
0138                  			// copy base note
0139                  			note[0]=tune[c];
0140                  			pos++;
0141                  			c++;
0142                  			if (tune[c] =='#')
    \ 00008f 22......             jsl     long:`?L303`
    \ 000093 831d                 sta     29,s
    \ 000095 c220                 rep     #32
    \ 000097 a313                 lda     19,s
    \ 000099 1a                   inc     a
    \ 00009a 8305                 sta     5,s
    \ 00009c a317                 lda     23,s
    \ 00009e 1a                   inc     a
    \ 00009f 8307                 sta     7,s
    \ 0000a1 22......             jsl     long:`?L310`
    \ 0000a5 c923                 cmp     #35
    \ 0000a7 c220                 rep     #32
    \ 0000a9 d03d                 bne     `?L10`
0143                  			{
0144                  				// Verify it's a valid Sharp note!
0145                  				if (note[0]!='B' && note[0]!='E')
    \ 0000ab a31d                 lda     29,s
    \ 0000ad e220                 sep     #32
    \ 0000af c942                 cmp     #66
    \ 0000b1 c220                 rep     #32
    \ 0000b3 f01b                 beq     `?L13`
    \ 0000b5 a31d                 lda     29,s
    \ 0000b7 e220                 sep     #32
    \ 0000b9 c945                 cmp     #69
    \ 0000bb c220                 rep     #32
    \ 0000bd f011                 beq     `?L13`
0146                  				{
    \ 0000bf 22......             jsl     long:`?L310`
0147                  					// Make it Sharp!	
0148                  					note[1]=tune[c];
    \ 0000c3 831e                 sta     30,s
    \ 0000c5 c220                 rep     #32
0149                  					pos++;
    \ 0000c7 a305                 lda     5,s
    \ 0000c9 1a                   inc     a
    \ 0000ca 8303                 sta     3,s
    \ 0000cc a303                 lda     3,s
    \ 0000ce 8004                 bra     `?L14`
    \ 0000d0 a305     `?L13`:     lda     5,s
    \ 0000d2 8303                 sta     3,s
    \ 0000d4          `?L14`:
0150                  				}
0151                  				c++;
    \ 0000d4 a307                 lda     7,s
    \ 0000d6 1a                   inc     a
    \ 0000d7 8305                 sta     5,s
    \ 0000d9 a305                 lda     5,s
    \ 0000db 8307                 sta     7,s
    \ 0000dd a303                 lda     3,s
    \ 0000df 8313                 sta     19,s
    \ 0000e1 a309                 lda     9,s
    \ 0000e3 8303                 sta     3,s
    \ 0000e5 4c....               jmp     .kbank `?L11`
    \ 0000e8          `?L10`:
0152                  			}
0153                  			else
0154                  			if (tune[c] =='$')
    \ 0000e8 22......             jsl     long:`?L310`
    \ 0000ec c924                 cmp     #36
    \ 0000ee c220                 rep     #32
    \ 0000f0 d07d                 bne     `?L16`
0155                  				// is it a flat note?
0156                  			{
0157                  				// modify note to be represented with a Sharp
0158                  				if (tune[c-1]==65)
    \ 0000f2 a307                 lda     7,s
    \ 0000f4 3a                   dec     a
    \ 0000f5 a8                   tay
    \ 0000f6 b324                 lda     (36,s),y
    \ 0000f8 e220                 sep     #32
    \ 0000fa c941                 cmp     #65
    \ 0000fc c220                 rep     #32
    \ 0000fe d024                 bne     `?L19`
0159                  					{
0160                  						note[0]='G';
    \ 000100 e220                 sep     #32
    \ 000102 a947                 lda     #71
    \ 000104 831d                 sta     29,s
    \ 000106 c220                 rep     #32
0161                  						if (octave > 0)
    \ 000108 a90000               lda     ##0
    \ 00010b 38                   sec
    \ 00010c e319                 sbc     25,s
    \ 00010e 5003                 bvc     `?L217`
    \ 000110 490080               eor     ##-32768
    \ 000113 1007     `?L217`:    bpl     `?L22`
0162                  							{octaveSubs=1;}
    \ 000115 a90100               lda     ##1
    \ 000118 8303                 sta     3,s
    \ 00011a 8002                 bra     `?L285`
    \ 00011c a309     `?L22`:     lda     9,s
    \ 00011e 8303     `?L285`:    sta     3,s
    \ 000120 a303                 lda     3,s
    \ 000122 8011                 bra     `?L20`
    \ 000124          `?L19`:
0163                  					}
0164                  				else
0165                  					{note[0]=tune[c-1]-1;}
    \ 000124 a307                 lda     7,s
    \ 000126 3a                   dec     a
    \ 000127 a8                   tay
    \ 000128 b324                 lda     (36,s),y
    \ 00012a 3a                   dec     a
    \ 00012b e220                 sep     #32
    \ 00012d 831d                 sta     29,s
    \ 00012f c220                 rep     #32
    \ 000131 a309                 lda     9,s
    \ 000133 8303                 sta     3,s
    \ 000135          `?L20`:
0166                  				// Add Sharp # symbol if needed
0167                  				if (note[0]!='E' && note[0]!='B' && note[0]!='R')
    \ 000135 a31d                 lda     29,s
    \ 000137 e220                 sep     #32
    \ 000139 c945                 cmp     #69
    \ 00013b c220                 rep     #32
    \ 00013d f025                 beq     `?L25`
    \ 00013f a31d                 lda     29,s
    \ 000141 e220                 sep     #32
    \ 000143 c942                 cmp     #66
    \ 000145 c220                 rep     #32
    \ 000147 f01b                 beq     `?L25`
    \ 000149 a31d                 lda     29,s
    \ 00014b e220                 sep     #32
    \ 00014d c952                 cmp     #82
    \ 00014f c220                 rep     #32
    \ 000151 f011                 beq     `?L25`
0168                  				{
0169                  					note[1]='#';
    \ 000153 e220                 sep     #32
    \ 000155 a923                 lda     #35
    \ 000157 831e                 sta     30,s
    \ 000159 c220                 rep     #32
0170                  					pos++;
    \ 00015b a305                 lda     5,s
    \ 00015d 1a                   inc     a
    \ 00015e 8305                 sta     5,s
    \ 000160 a305                 lda     5,s
    \ 000162 8002                 bra     `?L26`
    \ 000164 a305     `?L25`:     lda     5,s
    \ 000166          `?L26`:
0171                  				}
0172                  				c++;
    \ 000166 a307                 lda     7,s
    \ 000168 1a                   inc     a
    \ 000169 8307                 sta     7,s
    \ 00016b a303                 lda     3,s
    \ 00016d 8004                 bra     `?L17`
    \ 00016f a309     `?L16`:     lda     9,s
    \ 000171 8303                 sta     3,s
    \ 000173 a305     `?L17`:     lda     5,s
    \ 000175 8313                 sta     19,s
    \ 000177 a303                 lda     3,s
    \ 000179          `?L11`:
0173                  			}
0174                  			// ---------------
0175                  			// OCTAVE
0176                  			// ---------------
0177                  			if (tune[c] >='0' && tune[c]<='7') 
    \ 000179 a324                 lda     36,s
    \ 00017b a8                   tay
    \ 00017c b307                 lda     (7,s),y
    \ 00017e 22......             jsl     long:`?L309`
    \ 000182 9035                 bcc     `?L28`
    \ 000184 a324                 lda     36,s
    \ 000186 a8                   tay
    \ 000187 a93700               lda     ##55
    \ 00018a e220                 sep     #32
    \ 00018c d307                 cmp     (7,s),y
    \ 00018e c220                 rep     #32
    \ 000190 9027                 bcc     `?L28`
0178                  			{
0179                  			// verify if Octave was provided after note
0180                  				octave = tune[c]-48; // modify current octave number
    \ 000192 a324                 lda     36,s
    \ 000194 a8                   tay
    \ 000195 b307                 lda     (7,s),y
    \ 000197 22......             jsl     long:`?L304`
    \ 00019b 8305                 sta     5,s
0181                  				note[pos]=48+octave-octaveSubs; // get octave & add OctaveSubs just in case!
    \ 00019d a93000               lda     ##48
    \ 0001a0 18                   clc
    \ 0001a1 6305                 adc     5,s
    \ 0001a3 38                   sec
    \ 0001a4 e303                 sbc     3,s
    \ 0001a6 aa                   tax
    \ 0001a7 3b                   tsc
    \ 0001a8 22......             jsl     long:`?L305`
0182                  				c++;
    \ 0001ac a307                 lda     7,s
    \ 0001ae 1a                   inc     a
    \ 0001af 8303                 sta     3,s
    \ 0001b1 a303                 lda     3,s
    \ 0001b3 8307                 sta     7,s
    \ 0001b5 a305                 lda     5,s
    \ 0001b7 8011                 bra     `?L284`
    \ 0001b9          `?L28`:
0183                  			}
0184                  			else
0185                  			{
0186                  				// add Octave to note
0187                  				note[pos]=48+octave-octaveSubs;
    \ 0001b9 a93000               lda     ##48
    \ 0001bc 18                   clc
    \ 0001bd 6319                 adc     25,s
    \ 0001bf 38                   sec
    \ 0001c0 e303                 sbc     3,s
    \ 0001c2 aa                   tax
    \ 0001c3 3b                   tsc
    \ 0001c4 22......             jsl     long:`?L305`
    \ 0001c8 a319                 lda     25,s
    \ 0001ca 8303     `?L284`:    sta     3,s
0188                  			}
0189                  			// ---------------
0190                  			// LENGTH
0191                  			// ---------------
0192                  			switch (tune[c])
    \ 0001cc a9....               lda     ##.word0 `?L200`
    \ 0001cf 85..                 sta     dp:.tiny _Dp
    \ 0001d1 a9....               lda     ##.word2 `?L200`
    \ 0001d4 85..                 sta     dp:.tiny (_Dp+2)
    \ 0001d6 a324                 lda     36,s
    \ 0001d8 a8                   tay
    \ 0001d9 b307                 lda     (7,s),y
    \ 0001db 29ff00               and     ##255
    \ 0001de 22......             jsl     long:_ValueSwitch16
    \ 0001e2          `?L38`:
0193                  			{
0194                  				case 'w': // whole
0195                  					duration=16;
    \ 0001e2 a91000               lda     ##16
    \ 0001e5 8305                 sta     5,s
0196                  					c++;
    \ 0001e7 a307                 lda     7,s
    \ 0001e9 1a                   inc     a
    \ 0001ea 8307                 sta     7,s
0197                  					break;
    \ 0001ec a307                 lda     7,s
    \ 0001ee 8309                 sta     9,s
    \ 0001f0 a305                 lda     5,s
    \ 0001f2 8053                 bra     `?L283`
    \ 0001f4          `?L35`:
0198                  				case 'h': // half
0199                  					duration=8;
0200                  					c++;
0201                  					break;
0202                  				case 'q': // quarter
0203                  					duration=4;
0204                  					c++;
0205                  					break;
0206                  				case 't': // eight
0207                  					duration=2;
    \ 0001f4 a90200               lda     ##2
    \ 0001f7 8305                 sta     5,s
0208                  					c++;
    \ 0001f9 a307                 lda     7,s
    \ 0001fb 1a                   inc     a
    \ 0001fc 8307                 sta     7,s
0209                  					break;
    \ 0001fe a307                 lda     7,s
    \ 000200 8309                 sta     9,s
    \ 000202 a305                 lda     5,s
    \ 000204 8041                 bra     `?L283`
    \ 000206          `?L34`:
0210                  				case 's': // sixteenth
0211                  					duration=1;
    \ 000206 a90100               lda     ##1
    \ 000209 8305                 sta     5,s
0212                  					c++;
    \ 00020b a307                 lda     7,s
    \ 00020d 1a                   inc     a
    \ 00020e 8307                 sta     7,s
0213                  					break;
    \ 000210 a307                 lda     7,s
    \ 000212 8309                 sta     9,s
    \ 000214 a305                 lda     5,s
    \ 000216 802f                 bra     `?L283`
    \ 000218 a90400   `?L36`:     lda     ##4
    \ 00021b 8305                 sta     5,s
    \ 00021d a307                 lda     7,s
    \ 00021f 1a                   inc     a
    \ 000220 8307                 sta     7,s
    \ 000222 a307                 lda     7,s
    \ 000224 8309                 sta     9,s
    \ 000226 a305                 lda     5,s
    \ 000228 801d                 bra     `?L283`
    \ 00022a a90800   `?L37`:     lda     ##8
    \ 00022d 8305                 sta     5,s
    \ 00022f a307                 lda     7,s
    \ 000231 1a                   inc     a
    \ 000232 8307                 sta     7,s
    \ 000234 a307                 lda     7,s
    \ 000236 8309                 sta     9,s
    \ 000238 a305                 lda     5,s
    \ 00023a 800b                 bra     `?L283`
    \ 00023c          `?L33`:
0214                  				default:
0215                  					// if no duration is specified use quarter
0216                  					duration=4;
    \ 00023c a90400               lda     ##4
    \ 00023f 8305                 sta     5,s
    \ 000241 a307                 lda     7,s
    \ 000243 8309                 sta     9,s
    \ 000245 a305                 lda     5,s
    \ 000247 8307     `?L283`:    sta     7,s
0217                  			}
0218                  			// Check for dotted duration
0219                  			if (tune[c]=='.')
    \ 000249 a324                 lda     36,s
    \ 00024b a8                   tay
    \ 00024c b309                 lda     (9,s),y
    \ 00024e e220                 sep     #32
    \ 000250 c92e                 cmp     #46
    \ 000252 c220                 rep     #32
    \ 000254 d01f                 bne     `?L44`
0220                  			{
0221                  				duration+=duration/2;
    \ 000256 a307                 lda     7,s
    \ 000258 08                   php
    \ 000259 78                   sei
    \ 00025a 8d1a01               sta     282
    \ 00025d a90200               lda     ##2
    \ 000260 8d1801               sta     280
    \ 000263 ad1c01               lda     284
    \ 000266 28                   plp
    \ 000267 18                   clc
    \ 000268 6307                 adc     7,s
    \ 00026a 8307                 sta     7,s
0222                  				c++;
    \ 00026c a309                 lda     9,s
    \ 00026e 1a                   inc     a
    \ 00026f 8305                 sta     5,s
    \ 000271 a307                 lda     7,s
    \ 000273 8006                 bra     `?L282`
    \ 000275 a309     `?L44`:     lda     9,s
    \ 000277 8305                 sta     5,s
    \ 000279 a307                 lda     7,s
    \ 00027b 8309     `?L282`:    sta     9,s
    \ 00027d a305                 lda     5,s
    \ 00027f 8317                 sta     23,s
    \ 000281 a313                 lda     19,s
    \ 000283 8307                 sta     7,s
    \ 000285 a303                 lda     3,s
    \ 000287 8305                 sta     5,s
    \ 000289 a30f                 lda     15,s
    \ 00028b 831b                 sta     27,s
    \ 00028d a309                 lda     9,s
    \ 00028f 8319                 sta     25,s
    \ 000291 a30d                 lda     13,s
    \ 000293 8313                 sta     19,s
    \ 000295 a301                 lda     1,s
    \ 000297 830d                 sta     13,s
    \ 000299 a30b                 lda     11,s
    \ 00029b 4c....               jmp     .kbank `?L276`
    \ 00029e          `?L7`:
0223                  			}
0224                  		}
0225                  		else
0226                  		{
0227                  		//--------------------------
0228                  		// OTHER OPTIONS
0229                  		//--------------------------
0230                  			// no note was provided, only parameter changed!
0231                  			note[0]='\0';
    \ 00029e e220                 sep     #32
    \ 0002a0 a900                 lda     #0
    \ 0002a2 831d                 sta     29,s
    \ 0002a4 c220                 rep     #32
0232                  			noteFlag=false;
    \ 0002a6 a90000               lda     ##0
    \ 0002a9 8301                 sta     1,s
0233                  			// Modify Volume
0234                  			if (tune[c]=='V')
    \ 0002ab 22......             jsl     long:`?L303`
    \ 0002af c956                 cmp     #86
    \ 0002b1 c220                 rep     #32
    \ 0002b3 d07b                 bne     `?L47`
0235                  			{
0236                  				modFlag=true;
    \ 0002b5 a90100               lda     ##1
    \ 0002b8 8305                 sta     5,s
0237                  				c++;
    \ 0002ba a317                 lda     23,s
    \ 0002bc 1a                   inc     a
    \ 0002bd 8309                 sta     9,s
0238                  				if (tune[c]>='0' && tune[c]<='9')
    \ 0002bf a324                 lda     36,s
    \ 0002c1 a8                   tay
    \ 0002c2 b309                 lda     (9,s),y
    \ 0002c4 22......             jsl     long:`?L309`
    \ 0002c8 9022                 bcc     `?L50`
    \ 0002ca a324                 lda     36,s
    \ 0002cc a8                   tay
    \ 0002cd a93900               lda     ##57
    \ 0002d0 e220                 sep     #32
    \ 0002d2 d309                 cmp     (9,s),y
    \ 0002d4 c220                 rep     #32
    \ 0002d6 9014                 bcc     `?L50`
0239                  					{
0240                  						volume=tune[c]-48;
    \ 0002d8 a324                 lda     36,s
    \ 0002da a8                   tay
    \ 0002db b309                 lda     (9,s),y
    \ 0002dd 22......             jsl     long:`?L304`
    \ 0002e1 8307                 sta     7,s
0241                  						c++;
    \ 0002e3 a309                 lda     9,s
    \ 0002e5 1a                   inc     a
    \ 0002e6 8309                 sta     9,s
    \ 0002e8 a307                 lda     7,s
    \ 0002ea 8004                 bra     `?L51`
    \ 0002ec a30d     `?L50`:     lda     13,s
    \ 0002ee 8307                 sta     7,s
    \ 0002f0          `?L51`:
0242                  					}
0243                  				if (tune[c]>='a' && tune[c]<='f')
    \ 0002f0 a324                 lda     36,s
    \ 0002f2 a8                   tay
    \ 0002f3 b309                 lda     (9,s),y
    \ 0002f5 e220                 sep     #32
    \ 0002f7 c961                 cmp     #97
    \ 0002f9 c220                 rep     #32
    \ 0002fb 9025                 bcc     `?L53`
    \ 0002fd a324                 lda     36,s
    \ 0002ff a8                   tay
    \ 000300 a96600               lda     ##102
    \ 000303 e220                 sep     #32
    \ 000305 d309                 cmp     (9,s),y
    \ 000307 c220                 rep     #32
    \ 000309 9017                 bcc     `?L53`
0244                  					{	
0245                  						volume=tune[c]-87;
    \ 00030b a324                 lda     36,s
    \ 00030d a8                   tay
    \ 00030e b309                 lda     (9,s),y
    \ 000310 29ff00               and     ##255
    \ 000313 38                   sec
    \ 000314 e95700               sbc     ##87
    \ 000317 8307                 sta     7,s
0246                  						c++;
    \ 000319 a309                 lda     9,s
    \ 00031b 1a                   inc     a
    \ 00031c 8309                 sta     9,s
    \ 00031e a307                 lda     7,s
    \ 000320 8002                 bra     `?L54`
    \ 000322 a307     `?L53`:     lda     7,s
    \ 000324 a309     `?L54`:     lda     9,s
    \ 000326 8317                 sta     23,s
    \ 000328 a307                 lda     7,s
    \ 00032a 8309                 sta     9,s
    \ 00032c a305                 lda     5,s
    \ 00032e 8008                 bra     `?L48`
    \ 000330 a30d     `?L47`:     lda     13,s
    \ 000332 8309                 sta     9,s
    \ 000334 a30b                 lda     11,s
    \ 000336 8305                 sta     5,s
    \ 000338          `?L48`:
0247                  					}
0248                  			}
0249                  			// Modify Octave
0250                  			if (tune[c]=='O')
    \ 000338 a324                 lda     36,s
    \ 00033a a8                   tay
    \ 00033b b317                 lda     (23,s),y
    \ 00033d e220                 sep     #32
    \ 00033f c94f                 cmp     #79
    \ 000341 c220                 rep     #32
    \ 000343 d047                 bne     `?L56`
0251                  			{
0252                  				modFlag=true;
    \ 000345 a90100               lda     ##1
    \ 000348 8305                 sta     5,s
0253                  				c++;
    \ 00034a a317                 lda     23,s
    \ 00034c 1a                   inc     a
    \ 00034d 830b                 sta     11,s
0254                  				if (tune[c]>='0' && tune[c]<='7')
    \ 00034f a324                 lda     36,s
    \ 000351 a8                   tay
    \ 000352 b30b                 lda     (11,s),y
    \ 000354 22......             jsl     long:`?L309`
    \ 000358 9022                 bcc     `?L59`
    \ 00035a a324                 lda     36,s
    \ 00035c a8                   tay
    \ 00035d a93700               lda     ##55
    \ 000360 e220                 sep     #32
    \ 000362 d30b                 cmp     (11,s),y
    \ 000364 c220                 rep     #32
    \ 000366 9014                 bcc     `?L59`
0255                  				{
0256                  					octave=tune[c]-48;
    \ 000368 a324                 lda     36,s
    \ 00036a a8                   tay
    \ 00036b b30b                 lda     (11,s),y
    \ 00036d 22......             jsl     long:`?L304`
    \ 000371 8307                 sta     7,s
0257                  					c++;
    \ 000373 a30b                 lda     11,s
    \ 000375 1a                   inc     a
    \ 000376 830b                 sta     11,s
    \ 000378 a307                 lda     7,s
    \ 00037a 8004                 bra     `?L60`
    \ 00037c a319     `?L59`:     lda     25,s
    \ 00037e 8307                 sta     7,s
    \ 000380 a30b     `?L60`:     lda     11,s
    \ 000382 830d                 sta     13,s
    \ 000384 a307                 lda     7,s
    \ 000386 830b                 sta     11,s
    \ 000388 a305                 lda     5,s
    \ 00038a 800a                 bra     `?L57`
    \ 00038c a317     `?L56`:     lda     23,s
    \ 00038e 830d                 sta     13,s
    \ 000390 a319                 lda     25,s
    \ 000392 830b                 sta     11,s
    \ 000394 a305                 lda     5,s
    \ 000396          `?L57`:
0258                  				}
0259                  			}
0260                  			// Modify Instrument
0261                  			if (tune[c]=='I')
    \ 000396 a324                 lda     36,s
    \ 000398 a8                   tay
    \ 000399 b30d                 lda     (13,s),y
    \ 00039b e220                 sep     #32
    \ 00039d c949                 cmp     #73
    \ 00039f c220                 rep     #32
    \ 0003a1 d07b                 bne     `?L62`
0262                  			{
0263                  				modFlag=true;
    \ 0003a3 a90100               lda     ##1
    \ 0003a6 8305                 sta     5,s
0264                  				c++;
    \ 0003a8 a30d                 lda     13,s
    \ 0003aa 1a                   inc     a
    \ 0003ab 830d                 sta     13,s
0265                  				if (tune[c]>='0' && tune[c]<='9')
    \ 0003ad a324                 lda     36,s
    \ 0003af a8                   tay
    \ 0003b0 b30d                 lda     (13,s),y
    \ 0003b2 22......             jsl     long:`?L309`
    \ 0003b6 9022                 bcc     `?L65`
    \ 0003b8 a324                 lda     36,s
    \ 0003ba a8                   tay
    \ 0003bb a93900               lda     ##57
    \ 0003be e220                 sep     #32
    \ 0003c0 d30d                 cmp     (13,s),y
    \ 0003c2 c220                 rep     #32
    \ 0003c4 9014                 bcc     `?L65`
0266                  				{
0267                  					instrument=tune[c]-48;
    \ 0003c6 a324                 lda     36,s
    \ 0003c8 a8                   tay
    \ 0003c9 b30d                 lda     (13,s),y
    \ 0003cb 22......             jsl     long:`?L304`
    \ 0003cf 8307                 sta     7,s
0268                  					c++;
    \ 0003d1 a30d                 lda     13,s
    \ 0003d3 1a                   inc     a
    \ 0003d4 830d                 sta     13,s
    \ 0003d6 a307                 lda     7,s
    \ 0003d8 8004                 bra     `?L66`
    \ 0003da a30f     `?L65`:     lda     15,s
    \ 0003dc 8307                 sta     7,s
    \ 0003de          `?L66`:
0269                  				}
0270                  				if (tune[c]>='a' && tune[c]<='f')
    \ 0003de a324                 lda     36,s
    \ 0003e0 a8                   tay
    \ 0003e1 b30d                 lda     (13,s),y
    \ 0003e3 e220                 sep     #32
    \ 0003e5 c961                 cmp     #97
    \ 0003e7 c220                 rep     #32
    \ 0003e9 9025                 bcc     `?L68`
    \ 0003eb a324                 lda     36,s
    \ 0003ed a8                   tay
    \ 0003ee a96600               lda     ##102
    \ 0003f1 e220                 sep     #32
    \ 0003f3 d30d                 cmp     (13,s),y
    \ 0003f5 c220                 rep     #32
    \ 0003f7 9017                 bcc     `?L68`
0271                  				{
0272                  					instrument=tune[c]-87;
    \ 0003f9 a324                 lda     36,s
    \ 0003fb a8                   tay
    \ 0003fc b30d                 lda     (13,s),y
    \ 0003fe 29ff00               and     ##255
    \ 000401 38                   sec
    \ 000402 e95700               sbc     ##87
    \ 000405 8307                 sta     7,s
0273                  					c++;
    \ 000407 a30d                 lda     13,s
    \ 000409 1a                   inc     a
    \ 00040a 830d                 sta     13,s
    \ 00040c a307                 lda     7,s
    \ 00040e 8002                 bra     `?L69`
    \ 000410 a307     `?L68`:     lda     7,s
    \ 000412 a30d     `?L69`:     lda     13,s
    \ 000414 8317                 sta     23,s
    \ 000416 a307                 lda     7,s
    \ 000418 830d                 sta     13,s
    \ 00041a a305                 lda     5,s
    \ 00041c 800a                 bra     `?L63`
    \ 00041e a30d     `?L62`:     lda     13,s
    \ 000420 8317                 sta     23,s
    \ 000422 a30f                 lda     15,s
    \ 000424 830d                 sta     13,s
    \ 000426 a305                 lda     5,s
    \ 000428          `?L63`:
0274                  				}
0275                  			}
0276                  			// spaces are accepted but they do nothing
0277                  			if (tune[c]==' ')
    \ 000428 a324                 lda     36,s
    \ 00042a a8                   tay
    \ 00042b b317                 lda     (23,s),y
    \ 00042d e220                 sep     #32
    \ 00042f c920                 cmp     #32
    \ 000431 c220                 rep     #32
    \ 000433 d00e                 bne     `?L71`
0278                  			{
0279                  				modFlag=true;
    \ 000435 a90100               lda     ##1
    \ 000438 8305                 sta     5,s
0280                  				c++;
    \ 00043a a317                 lda     23,s
    \ 00043c 1a                   inc     a
    \ 00043d 8307                 sta     7,s
    \ 00043f a305                 lda     5,s
    \ 000441 8006                 bra     `?L280`
    \ 000443 a317     `?L71`:     lda     23,s
    \ 000445 8307                 sta     7,s
    \ 000447 a305                 lda     5,s
    \ 000449 830f     `?L280`:    sta     15,s
    \ 00044b a307                 lda     7,s
    \ 00044d 8317                 sta     23,s
    \ 00044f a313                 lda     19,s
    \ 000451 8307                 sta     7,s
    \ 000453 a30b                 lda     11,s
    \ 000455 8305                 sta     5,s
    \ 000457 a30d                 lda     13,s
    \ 000459 831b                 sta     27,s
    \ 00045b a303                 lda     3,s
    \ 00045d 8319                 sta     25,s
    \ 00045f a309                 lda     9,s
    \ 000461 8313                 sta     19,s
    \ 000463 a301                 lda     1,s
    \ 000465 830d                 sta     13,s
    \ 000467 a30f                 lda     15,s
    \ 000469 8301     `?L276`:    sta     1,s
0281                  			}
0282                  		}
0283                  			note[++pos]='\0';
    \ 00046b a307                 lda     7,s
    \ 00046d 1a                   inc     a
    \ 00046e 8303                 sta     3,s
    \ 000470 3b                   tsc
    \ 000471 18                   clc
    \ 000472 691d00               adc     ##29
    \ 000475 a8                   tay
    \ 000476 e220                 sep     #32
    \ 000478 a900                 lda     #0
    \ 00047a 9303                 sta     (3,s),y
    \ 00047c c220                 rep     #32
0284                  		//-------------------------------
0285                  		// Output Note in Track notation
0286                  		//-------------------------------
0287                  		if (noteFlag==true)
    \ 00047e a30d                 lda     13,s
    \ 000480 c90100               cmp     ##1
    \ 000483 f003                 beq     `?L359`
    \ 000485 4c....               jmp     .kbank `?L74`
    \ 000488          `?L359`:
0288                  		{	
0289                  			t++;
    \ 000488 a315                 lda     21,s
    \ 00048a 1a                   inc     a
    \ 00048b 830f                 sta     15,s
0290                  			
0291                  			// Calculate normal, legatto or staccato duration of note 
0292                  			lengthNote=SID_envelope[instrument-1][6];
    \ 00048d a31b                 lda     27,s
    \ 00048f 3a                   dec     a
    \ 000490 0a                   asl     a
    \ 000491 0a                   asl     a
    \ 000492 0a                   asl     a
    \ 000493 0a                   asl     a
    \ 000494 18                   clc
    \ 000495 69....               adc     ##SID_envelope
    \ 000498 aa                   tax
    \ 000499 bd0c00               lda     12,x
    \ 00049c 8303                 sta     3,s
0293                  			gateOff= (int) (duration*noteLen[lengthNote-1]);
    \ 00049e a319                 lda     25,s
    \ 0004a0 a20000               ldx     ##0
    \ 0004a3 a8                   tay
    \ 0004a4 1001                 bpl     `?L220`
    \ 0004a6 ca                   dex
    \ 0004a7          `?L220`:
    \ 0004a7 22......             jsl     long:_SInt32ToFloat32
    \ 0004ab da                   phx
    \ 0004ac 48                   pha
    \ 0004ad a307                 lda     7,s
    \ 0004af 3a                   dec     a
    \ 0004b0 0a                   asl     a
    \ 0004b1 0a                   asl     a
    \ 0004b2 aa                   tax
    \ 0004b3 bc....               ldy     noteLen+2,x
    \ 0004b6 84..                 sty     dp:.tiny (_Dp+2)
    \ 0004b8 bc....               ldy     noteLen,x
    \ 0004bb 84..                 sty     dp:.tiny _Dp
    \ 0004bd 68                   pla
    \ 0004be fa                   plx
    \ 0004bf 22......             jsl     long:_Float32Mul
    \ 0004c3 22......             jsl     long:_Float32ToSInt32
    \ 0004c7 8303                 sta     3,s
0294                  			if (gateOff<=1)
    \ 0004c9 a90100               lda     ##1
    \ 0004cc 38                   sec
    \ 0004cd e303                 sbc     3,s
    \ 0004cf 5003                 bvc     `?L225`
    \ 0004d1 490080               eor     ##-32768
    \ 0004d4 3009     `?L225`:    bmi     `?L77`
0295                  				gateOff=2; // if gateoff is calculated on the same 1/16th period as gateon we won't use parameter.
    \ 0004d6 a90200               lda     ##2
    \ 0004d9 8303                 sta     3,s
    \ 0004db 8303                 sta     3,s
    \ 0004dd 8002                 bra     `?L78`
    \ 0004df a303     `?L77`:     lda     3,s
    \ 0004e1          `?L78`:
0296                  			//printf("Duration:%d lengthNote:%d factor:%f calc:%d GateOff: %d\r",duration,lengthNote,noteLen[lengthNote-1],(int) (duration*noteLen[lengthNote-1]),gateOff);
0297                  			
0298                  			index=0;
    \ 0004e1 a90000               lda     ##0
    \ 0004e4 8307                 sta     7,s
0299                  			if (note[0]=='R') // Rest
    \ 0004e6 a31d                 lda     29,s
    \ 0004e8 e220                 sep     #32
    \ 0004ea c952                 cmp     #82
    \ 0004ec c220                 rep     #32
    \ 0004ee f003                 beq     `?L360`
    \ 0004f0 4c....               jmp     .kbank `?L80`
    \ 0004f3          `?L360`:
0300                  			{
0301                  				Tracker[t][(trackNumber*3)]=100;
    \ 0004f3 a322                 lda     34,s
    \ 0004f5 8307                 sta     7,s
    \ 0004f7 8303                 sta     3,s
    \ 0004f9 a307                 lda     7,s
    \ 0004fb 0a                   asl     a
    \ 0004fc 8307                 sta     7,s
    \ 0004fe 18                   clc
    \ 0004ff 6303                 adc     3,s
    \ 000501 8303                 sta     3,s
    \ 000503 a32a                 lda     42,s
    \ 000505 08                   php
    \ 000506 78                   sei
    \ 000507 8d0201               sta     258
    \ 00050a a310                 lda     16,s
    \ 00050c 8d0001               sta     256
    \ 00050f ad0401               lda     260
    \ 000512 28                   plp
0302                  				Tracker[t][(trackNumber*3)+1]=volume;
0303                  				Tracker[t][(trackNumber*3)+2]=instrument;
0304                  				while (--duration>0)
    \ 000513 22......             jsl     long:`?L306`
    \ 000517 a964                 lda     #100
    \ 000519 9303                 sta     (3,s),y
    \ 00051b c220                 rep     #32
    \ 00051d a322                 lda     34,s
    \ 00051f 8307                 sta     7,s
    \ 000521 8303                 sta     3,s
    \ 000523 a307                 lda     7,s
    \ 000525 0a                   asl     a
    \ 000526 8307                 sta     7,s
    \ 000528 18                   clc
    \ 000529 6303                 adc     3,s
    \ 00052b 8303                 sta     3,s
    \ 00052d a32a                 lda     42,s
    \ 00052f 08                   php
    \ 000530 78                   sei
    \ 000531 8d0201               sta     258
    \ 000534 a310                 lda     16,s
    \ 000536 8d0001               sta     256
    \ 000539 ad0401               lda     260
    \ 00053c 28                   plp
    \ 00053d 18                   clc
    \ 00053e 632c                 adc     44,s
    \ 000540 85..                 sta     dp:.tiny _Dp
    \ 000542 a303                 lda     3,s
    \ 000544 22......             jsl     long:`?L297`
    \ 000548 8307                 sta     7,s
    \ 00054a 8303                 sta     3,s
    \ 00054c a307                 lda     7,s
    \ 00054e 0a                   asl     a
    \ 00054f 8307                 sta     7,s
    \ 000551 18                   clc
    \ 000552 6303                 adc     3,s
    \ 000554 8303                 sta     3,s
    \ 000556 a32a                 lda     42,s
    \ 000558 08                   php
    \ 000559 78                   sei
    \ 00055a 8d0201               sta     258
    \ 00055d a310                 lda     16,s
    \ 00055f 8d0001               sta     256
    \ 000562 ad0401               lda     260
    \ 000565 28                   plp
    \ 000566 18                   clc
    \ 000567 632c                 adc     44,s
    \ 000569 85..                 sta     dp:.tiny _Dp
    \ 00056b a303                 lda     3,s
    \ 00056d 1a                   inc     a
    \ 00056e 22......             jsl     long:`?L302`
    \ 000572 8307                 sta     7,s
    \ 000574 a319                 lda     25,s
    \ 000576          `?L278`:
0305                  				{
    \ 000576 8303                 sta     3,s
    \ 000578 a303                 lda     3,s
    \ 00057a 3a                   dec     a
    \ 00057b 8309                 sta     9,s
    \ 00057d a90000               lda     ##0
    \ 000580 38                   sec
    \ 000581 e309                 sbc     9,s
    \ 000583 5003                 bvc     `?L227`
    \ 000585 490080               eor     ##-32768
    \ 000588 3003     `?L227`:    bmi     `?L361`
    \ 00058a 4c....               jmp     .kbank `?L84`
    \ 00058d          `?L361`:
0306                  					t+=1;
    \ 00058d a307                 lda     7,s
    \ 00058f 1a                   inc     a
    \ 000590 830b                 sta     11,s
0307                  					Tracker[t][(trackNumber*3)]=0;
    \ 000592 a322                 lda     34,s
    \ 000594 8307                 sta     7,s
    \ 000596 8303                 sta     3,s
    \ 000598 a307                 lda     7,s
    \ 00059a 0a                   asl     a
    \ 00059b 8307                 sta     7,s
    \ 00059d 18                   clc
    \ 00059e 6303                 adc     3,s
    \ 0005a0 8303                 sta     3,s
    \ 0005a2 a32a                 lda     42,s
    \ 0005a4 08                   php
    \ 0005a5 78                   sei
    \ 0005a6 8d0201               sta     258
    \ 0005a9 a30c                 lda     12,s
    \ 0005ab 8d0001               sta     256
    \ 0005ae ad0401               lda     260
    \ 0005b1 28                   plp
    \ 0005b2 22......             jsl     long:`?L306`
    \ 0005b6 a900                 lda     #0
    \ 0005b8 9303                 sta     (3,s),y
    \ 0005ba c220                 rep     #32
0308                  					Tracker[t][(trackNumber*3)+1]=0;
    \ 0005bc a322                 lda     34,s
    \ 0005be 8307                 sta     7,s
    \ 0005c0 8303                 sta     3,s
    \ 0005c2 a307                 lda     7,s
    \ 0005c4 0a                   asl     a
    \ 0005c5 8307                 sta     7,s
    \ 0005c7 18                   clc
    \ 0005c8 6303                 adc     3,s
    \ 0005ca 8303                 sta     3,s
    \ 0005cc a32a                 lda     42,s
    \ 0005ce 08                   php
    \ 0005cf 78                   sei
    \ 0005d0 8d0201               sta     258
    \ 0005d3 a30c                 lda     12,s
    \ 0005d5 8d0001               sta     256
    \ 0005d8 ad0401               lda     260
    \ 0005db 28                   plp
    \ 0005dc 18                   clc
    \ 0005dd 632c                 adc     44,s
    \ 0005df 85..                 sta     dp:.tiny _Dp
    \ 0005e1 a303                 lda     3,s
    \ 0005e3 22......             jsl     long:`?L300`
0309                  					Tracker[t][(trackNumber*3)+2]=0;
    \ 0005e7 a322                 lda     34,s
    \ 0005e9 8307                 sta     7,s
    \ 0005eb 8303                 sta     3,s
    \ 0005ed a307                 lda     7,s
    \ 0005ef 0a                   asl     a
    \ 0005f0 8307                 sta     7,s
    \ 0005f2 18                   clc
    \ 0005f3 6303                 adc     3,s
    \ 0005f5 8303                 sta     3,s
    \ 0005f7 a32a                 lda     42,s
    \ 0005f9 08                   php
    \ 0005fa 78                   sei
    \ 0005fb 8d0201               sta     258
    \ 0005fe a30c                 lda     12,s
    \ 000600 8d0001               sta     256
    \ 000603 ad0401               lda     260
    \ 000606 28                   plp
    \ 000607 18                   clc
    \ 000608 632c                 adc     44,s
    \ 00060a 85..                 sta     dp:.tiny _Dp
    \ 00060c a303                 lda     3,s
    \ 00060e 1a                   inc     a
    \ 00060f 22......             jsl     long:`?L300`
    \ 000613 a30b                 lda     11,s
    \ 000615 8307                 sta     7,s
    \ 000617 a309                 lda     9,s
    \ 000619 4c....               jmp     .kbank `?L278`
    \ 00061c a309     `?L84`:     lda     9,s
    \ 00061e 4c....               jmp     .kbank `?L279`
    \ 000621          `?L80`:
0310                  				}
0311                  			}
0312                  			else 
0313                  			{ 
0314                  				// search for Note
0315                  				while (index<=96)
    \ 000621 a307                 lda     7,s
    \ 000623          `?L277`:
0316                  				{
    \ 000623 830b                 sta     11,s
    \ 000625 a96000               lda     ##96
    \ 000628 38                   sec
    \ 000629 e30b                 sbc     11,s
    \ 00062b 5003                 bvc     `?L229`
    \ 00062d 490080               eor     ##-32768
    \ 000630 3020     `?L229`:    bmi     `?L87`
0317                  					if (strcmp(note,notes[index])==0)
    \ 000632 a30b                 lda     11,s
    \ 000634 0a                   asl     a
    \ 000635 0a                   asl     a
    \ 000636 18                   clc
    \ 000637 69....               adc     ##notes
    \ 00063a 85..                 sta     dp:.tiny _Dp
    \ 00063c 3b                   tsc
    \ 00063d 18                   clc
    \ 00063e 691d00               adc     ##29
    \ 000641 22......             jsl     long:strcmp
    \ 000645 1a                   inc     a
    \ 000646 3a                   dec     a
    \ 000647 f009                 beq     `?L87`
0318                  						break;
0319                  					index++;
    \ 000649 a30b                 lda     11,s
    \ 00064b 1a                   inc     a
    \ 00064c 8307                 sta     7,s
    \ 00064e a307                 lda     7,s
    \ 000650 80d1                 bra     `?L277`
    \ 000652          `?L87`:
0320                  				}
0321                  				Tracker[t][(trackNumber*3)]=index;
    \ 000652 a322                 lda     34,s
    \ 000654 8309                 sta     9,s
    \ 000656 8307                 sta     7,s
    \ 000658 a309                 lda     9,s
    \ 00065a 0a                   asl     a
    \ 00065b 8309                 sta     9,s
    \ 00065d 18                   clc
    \ 00065e 6307                 adc     7,s
    \ 000660 8307                 sta     7,s
    \ 000662 a32a                 lda     42,s
    \ 000664 08                   php
    \ 000665 78                   sei
    \ 000666 8d0201               sta     258
    \ 000669 a310                 lda     16,s
    \ 00066b 8d0001               sta     256
    \ 00066e ad0401               lda     260
    \ 000671 28                   plp
0322                  				Tracker[t][(trackNumber*3)+1]=volume;
0323                  				Tracker[t][(trackNumber*3)+2]=instrument;
0324                  				
0325                  				while (--duration>0)
    \ 000672 22......             jsl     long:`?L306`
    \ 000676 a30b                 lda     11,s
    \ 000678 9307                 sta     (7,s),y
    \ 00067a c220                 rep     #32
    \ 00067c a322                 lda     34,s
    \ 00067e 8309                 sta     9,s
    \ 000680 8307                 sta     7,s
    \ 000682 a309                 lda     9,s
    \ 000684 0a                   asl     a
    \ 000685 8309                 sta     9,s
    \ 000687 18                   clc
    \ 000688 6307                 adc     7,s
    \ 00068a 8307                 sta     7,s
    \ 00068c a32a                 lda     42,s
    \ 00068e 08                   php
    \ 00068f 78                   sei
    \ 000690 8d0201               sta     258
    \ 000693 a310                 lda     16,s
    \ 000695 8d0001               sta     256
    \ 000698 ad0401               lda     260
    \ 00069b 28                   plp
    \ 00069c 18                   clc
    \ 00069d 632c                 adc     44,s
    \ 00069f 85..                 sta     dp:.tiny _Dp
    \ 0006a1 a307                 lda     7,s
    \ 0006a3 22......             jsl     long:`?L297`
    \ 0006a7 8309                 sta     9,s
    \ 0006a9 8307                 sta     7,s
    \ 0006ab a309                 lda     9,s
    \ 0006ad 0a                   asl     a
    \ 0006ae 8309                 sta     9,s
    \ 0006b0 18                   clc
    \ 0006b1 6307                 adc     7,s
    \ 0006b3 8307                 sta     7,s
    \ 0006b5 a32a                 lda     42,s
    \ 0006b7 08                   php
    \ 0006b8 78                   sei
    \ 0006b9 8d0201               sta     258
    \ 0006bc a310                 lda     16,s
    \ 0006be 8d0001               sta     256
    \ 0006c1 ad0401               lda     260
    \ 0006c4 28                   plp
    \ 0006c5 18                   clc
    \ 0006c6 632c                 adc     44,s
    \ 0006c8 85..                 sta     dp:.tiny _Dp
    \ 0006ca a307                 lda     7,s
    \ 0006cc 1a                   inc     a
    \ 0006cd 22......             jsl     long:`?L302`
    \ 0006d1 8309                 sta     9,s
    \ 0006d3 a319                 lda     25,s
    \ 0006d5          `?L275`:
0326                  				{
    \ 0006d5 8307                 sta     7,s
    \ 0006d7 a307                 lda     7,s
    \ 0006d9 3a                   dec     a
    \ 0006da 830b                 sta     11,s
    \ 0006dc a90000               lda     ##0
    \ 0006df 38                   sec
    \ 0006e0 e30b                 sbc     11,s
    \ 0006e2 5003                 bvc     `?L232`
    \ 0006e4 490080               eor     ##-32768
    \ 0006e7 3003     `?L232`:    bmi     `?L362`
    \ 0006e9 4c....               jmp     .kbank `?L94`
    \ 0006ec          `?L362`:
0327                  					t+=1;
    \ 0006ec a309                 lda     9,s
    \ 0006ee 1a                   inc     a
    \ 0006ef 830f                 sta     15,s
0328                  					if (gateOff==duration)
    \ 0006f1 a30b                 lda     11,s
    \ 0006f3 c303                 cmp     3,s
    \ 0006f5 f003                 beq     `?L363`
    \ 0006f7 4c....               jmp     .kbank `?L96`
    \ 0006fa          `?L363`:
0329                  					{
0330                  						Tracker[t][(trackNumber*3)]=101;
    \ 0006fa a322                 lda     34,s
    \ 0006fc 8309                 sta     9,s
    \ 0006fe 8307                 sta     7,s
    \ 000700 a309                 lda     9,s
    \ 000702 0a                   asl     a
    \ 000703 8309                 sta     9,s
    \ 000705 18                   clc
    \ 000706 6307                 adc     7,s
    \ 000708 8307                 sta     7,s
    \ 00070a a32a                 lda     42,s
    \ 00070c 08                   php
    \ 00070d 78                   sei
    \ 00070e 8d0201               sta     258
    \ 000711 a310                 lda     16,s
    \ 000713 8d0001               sta     256
    \ 000716 ad0401               lda     260
    \ 000719 28                   plp
0331                  						Tracker[t][(trackNumber*3)+1]=volume;
0332                  						Tracker[t][(trackNumber*3)+2]=instrument;
    \ 00071a 22......             jsl     long:`?L306`
    \ 00071e a965                 lda     #101
    \ 000720 9307                 sta     (7,s),y
    \ 000722 c220                 rep     #32
    \ 000724 a322                 lda     34,s
    \ 000726 8309                 sta     9,s
    \ 000728 8307                 sta     7,s
    \ 00072a a309                 lda     9,s
    \ 00072c 0a                   asl     a
    \ 00072d 8309                 sta     9,s
    \ 00072f 18                   clc
    \ 000730 6307                 adc     7,s
    \ 000732 8307                 sta     7,s
    \ 000734 a32a                 lda     42,s
    \ 000736 08                   php
    \ 000737 78                   sei
    \ 000738 8d0201               sta     258
    \ 00073b a310                 lda     16,s
    \ 00073d 8d0001               sta     256
    \ 000740 ad0401               lda     260
    \ 000743 28                   plp
    \ 000744 18                   clc
    \ 000745 632c                 adc     44,s
    \ 000747 85..                 sta     dp:.tiny _Dp
    \ 000749 a307                 lda     7,s
    \ 00074b 22......             jsl     long:`?L297`
    \ 00074f 8309                 sta     9,s
    \ 000751 8307                 sta     7,s
    \ 000753 a309                 lda     9,s
    \ 000755 0a                   asl     a
    \ 000756 8309                 sta     9,s
    \ 000758 18                   clc
    \ 000759 6307                 adc     7,s
    \ 00075b 8307                 sta     7,s
    \ 00075d a32a                 lda     42,s
    \ 00075f 08                   php
    \ 000760 78                   sei
    \ 000761 8d0201               sta     258
    \ 000764 a310                 lda     16,s
    \ 000766 8d0001               sta     256
    \ 000769 ad0401               lda     260
    \ 00076c 28                   plp
    \ 00076d 18                   clc
    \ 00076e 632c                 adc     44,s
    \ 000770 85..                 sta     dp:.tiny _Dp
    \ 000772 a307                 lda     7,s
    \ 000774 1a                   inc     a
    \ 000775 1a                   inc     a
    \ 000776 18                   clc
    \ 000777 65..                 adc     dp:.tiny _Dp
    \ 000779 aa                   tax
    \ 00077a a31b                 lda     27,s
    \ 00077c e220                 sep     #32
    \ 00077e 4c....               jmp     .kbank `?L274`
    \ 000781          `?L96`:
0333                  					}
0334                  					else
0335                  					{
0336                  						Tracker[t][(trackNumber*3)]=0;
    \ 000781 a322                 lda     34,s
    \ 000783 8309                 sta     9,s
    \ 000785 8307                 sta     7,s
    \ 000787 a309                 lda     9,s
    \ 000789 0a                   asl     a
    \ 00078a 8309                 sta     9,s
    \ 00078c 18                   clc
    \ 00078d 6307                 adc     7,s
    \ 00078f 8307                 sta     7,s
    \ 000791 a32a                 lda     42,s
    \ 000793 08                   php
    \ 000794 78                   sei
    \ 000795 8d0201               sta     258
    \ 000798 a310                 lda     16,s
    \ 00079a 8d0001               sta     256
    \ 00079d ad0401               lda     260
    \ 0007a0 28                   plp
0337                  						Tracker[t][(trackNumber*3)+1]=0;
0338                  						Tracker[t][(trackNumber*3)+2]=0;
    \ 0007a1 22......             jsl     long:`?L306`
    \ 0007a5 a900                 lda     #0
    \ 0007a7 9307                 sta     (7,s),y
    \ 0007a9 c220                 rep     #32
    \ 0007ab a322                 lda     34,s
    \ 0007ad 8309                 sta     9,s
    \ 0007af 8307                 sta     7,s
    \ 0007b1 a309                 lda     9,s
    \ 0007b3 0a                   asl     a
    \ 0007b4 8309                 sta     9,s
    \ 0007b6 18                   clc
    \ 0007b7 6307                 adc     7,s
    \ 0007b9 8307                 sta     7,s
    \ 0007bb a32a                 lda     42,s
    \ 0007bd 08                   php
    \ 0007be 78                   sei
    \ 0007bf 8d0201               sta     258
    \ 0007c2 a310                 lda     16,s
    \ 0007c4 8d0001               sta     256
    \ 0007c7 ad0401               lda     260
    \ 0007ca 28                   plp
    \ 0007cb 18                   clc
    \ 0007cc 632c                 adc     44,s
    \ 0007ce 85..                 sta     dp:.tiny _Dp
    \ 0007d0 a307                 lda     7,s
    \ 0007d2 22......             jsl     long:`?L300`
    \ 0007d6 a322                 lda     34,s
    \ 0007d8 8309                 sta     9,s
    \ 0007da 8307                 sta     7,s
    \ 0007dc a309                 lda     9,s
    \ 0007de 0a                   asl     a
    \ 0007df 8309                 sta     9,s
    \ 0007e1 18                   clc
    \ 0007e2 6307                 adc     7,s
    \ 0007e4 8307                 sta     7,s
    \ 0007e6 a32a                 lda     42,s
    \ 0007e8 08                   php
    \ 0007e9 78                   sei
    \ 0007ea 8d0201               sta     258
    \ 0007ed a310                 lda     16,s
    \ 0007ef 8d0001               sta     256
    \ 0007f2 ad0401               lda     260
    \ 0007f5 28                   plp
    \ 0007f6 18                   clc
    \ 0007f7 632c                 adc     44,s
    \ 0007f9 85..                 sta     dp:.tiny _Dp
    \ 0007fb a307                 lda     7,s
    \ 0007fd 1a                   inc     a
    \ 0007fe 1a                   inc     a
    \ 0007ff 18                   clc
    \ 000800 65..                 adc     dp:.tiny _Dp
    \ 000802 aa                   tax
    \ 000803 e220                 sep     #32
    \ 000805 a900                 lda     #0
    \ 000807 9d0000   `?L274`:    sta     0,x
    \ 00080a c220                 rep     #32
    \ 00080c a30f                 lda     15,s
    \ 00080e 8309                 sta     9,s
    \ 000810 a30b                 lda     11,s
    \ 000812 4c....               jmp     .kbank `?L275`
    \ 000815 a309     `?L94`:     lda     9,s
    \ 000817 8307                 sta     7,s
    \ 000819 a30b                 lda     11,s
    \ 00081b 8303     `?L279`:    sta     3,s
    \ 00081d a303                 lda     3,s
    \ 00081f 8008                 bra     `?L75`
    \ 000821 a315     `?L74`:     lda     21,s
    \ 000823 8307                 sta     7,s
    \ 000825 a319                 lda     25,s
    \ 000827 8303                 sta     3,s
    \ 000829          `?L75`:
0339                  					}
0340                  				}
0341                  			}
0342                  		}
0343                  		// Check for Errors on Song string
0344                  		
0345                  		if (noteFlag==false && modFlag==false && c!=tuneSize)
    \ 000829 a30d                 lda     13,s
    \ 00082b d049                 bne     `?L100`
    \ 00082d a301                 lda     1,s
    \ 00082f d045                 bne     `?L100`
    \ 000831 a311                 lda     17,s
    \ 000833 c317                 cmp     23,s
    \ 000835 f03f                 beq     `?L100`
0346                  		{
0347                  			// invalid character
0348                  			for (index=0;index<=c;index++)
    \ 000837 a90000               lda     ##0
    \ 00083a 8301                 sta     1,s
    \ 00083c 8309     `?L286`:    sta     9,s
    \ 00083e a317                 lda     23,s
    \ 000840 38                   sec
    \ 000841 e309                 sbc     9,s
    \ 000843 5003                 bvc     `?L234`
    \ 000845 490080               eor     ##-32768
    \ 000848 1010     `?L234`:    bpl     `?L102`
0349                  				printf("%c",tune[index]);
0350                  			printf ("<- Unexpected character\r");
    \ 00084a a9....               lda     ##`_StringLiteral_[60,45,32,85,110,101,120,112,101,99,116,101,100,32,99,104,97,114,97,99,116,101,114,13]`
    \ 00084d 22......             jsl     long:printf
0351                  			exit(-1);
    \ 000851 a9ffff               lda     ##-1
    \ 000854 22......             jsl     long:exit
    \ 000858 801c                 bra     `?L100`
    \ 00085a a324     `?L102`:    lda     36,s
    \ 00085c a8                   tay
    \ 00085d b309                 lda     (9,s),y
    \ 00085f 29ff00               and     ##255
    \ 000862 48                   pha
    \ 000863 a9....               lda     ##`_StringLiteral_%c`
    \ 000866 22......             jsl     long:printf
    \ 00086a 8303                 sta     3,s
    \ 00086c 68                   pla
    \ 00086d a309                 lda     9,s
    \ 00086f 1a                   inc     a
    \ 000870 8301                 sta     1,s
    \ 000872 a301                 lda     1,s
    \ 000874 80c6                 bra     `?L286`
    \ 000876 a307     `?L100`:    lda     7,s
    \ 000878 8315                 sta     21,s
    \ 00087a a305                 lda     5,s
    \ 00087c 8319                 sta     25,s
    \ 00087e a31b                 lda     27,s
    \ 000880 830f                 sta     15,s
    \ 000882 a313                 lda     19,s
    \ 000884 4c....               jmp     .kbank `?L281`
    \ 000887          `?L5`:
0352                  		}
0353                  	}
0354                  	return t;
    \ 000887 a315                 lda     21,s
0355                  }
    \ 000889 a8                   tay
    \ 00088a 3b                   tsc
    \ 00088b 18                   clc
    \ 00088c 692600               adc     ##38
    \ 00088f 1b                   tcs
    \ 000890 98                   tya
    \ 000891 6b                   rtl
0356                  
0357                  // Clean Track Memory
0358                  void cleanTracks(int rows,int cols,unsigned char (*Tracker)[cols])
0359                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public cleanTracks
    \ 000000          cleanTracks:
    \ 000000 5a                   phy
    \ 000001 5a                   phy
    \ 000002 5a                   phy
    \ 000003 5a                   phy
    \ 000004 8301                 sta     1,s
    \ 000006 a5..                 lda     dp:.tiny _Dp
    \ 000008 8305                 sta     5,s
0360                  	int i,j;
0361                  	for (i=0;i<rows;i++)
    \ 00000a a90000               lda     ##0
    \ 00000d 8307     `?L287`:    sta     7,s
    \ 00000f a307                 lda     7,s
    \ 000011 38                   sec
    \ 000012 e301                 sbc     1,s
    \ 000014 5003                 bvc     `?L239`
    \ 000016 490080               eor     ##-32768
    \ 000019 3005     `?L239`:    bmi     `?L110`
0362                  		for (j=0;j<cols;j++)
0363                  			Tracker[i][j]=0;
0364                  }
    \ 00001b 7a                   ply
    \ 00001c 7a                   ply
    \ 00001d 7a                   ply
    \ 00001e 7a                   ply
    \ 00001f 6b                   rtl
    \ 000020 a90000   `?L110`:    lda     ##0
    \ 000023 8303                 sta     3,s
    \ 000025 a303     `?L115`:    lda     3,s
    \ 000027 38                   sec
    \ 000028 e305                 sbc     5,s
    \ 00002a 5003                 bvc     `?L241`
    \ 00002c 490080               eor     ##-32768
    \ 00002f 3009     `?L241`:    bmi     `?L114`
    \ 000031 a307                 lda     7,s
    \ 000033 1a                   inc     a
    \ 000034 8303                 sta     3,s
    \ 000036 a303                 lda     3,s
    \ 000038 80d3                 bra     `?L287`
    \ 00003a a305     `?L114`:    lda     5,s
    \ 00003c 08                   php
    \ 00003d 78                   sei
    \ 00003e 8d0201               sta     258
    \ 000041 a308                 lda     8,s
    \ 000043 8d0001               sta     256
    \ 000046 ad0401               lda     260
    \ 000049 28                   plp
    \ 00004a 18                   clc
    \ 00004b 65..                 adc     dp:.tiny (_Dp+2)
    \ 00004d a8                   tay
    \ 00004e e220                 sep     #32
    \ 000050 a900                 lda     #0
    \ 000052 9303                 sta     (3,s),y
    \ 000054 c220                 rep     #32
    \ 000056 a303                 lda     3,s
    \ 000058 1a                   inc     a
    \ 000059 8303                 sta     3,s
    \ 00005b 80c8                 bra     `?L115`
0365                  
0366                  // Print Track Memory
0367                  void showTracks(int rows,int cols, unsigned char (*Tracker)[cols])
0368                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public showTracks
    \ 000000          showTracks:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 a8                   tay
    \ 000003 3b                   tsc
    \ 000004 38                   sec
    \ 000005 e90a00               sbc     ##10
    \ 000008 1b                   tcs
    \ 000009 98                   tya
    \ 00000a 8303                 sta     3,s
    \ 00000c a5..                 lda     dp:.tiny _Dp
    \ 00000e 8305                 sta     5,s
    \ 000010 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000012 85..                 sta     dp:.tiny (_Dp+8)
0369                  	int i,j;
0370                  	for (i=0;i<=rows;i++)
    \ 000014 a90000               lda     ##0
    \ 000017 8309     `?L289`:    sta     9,s
    \ 000019 a303                 lda     3,s
    \ 00001b 38                   sec
    \ 00001c e309                 sbc     9,s
    \ 00001e 5003                 bvc     `?L243`
    \ 000020 490080               eor     ##-32768
    \ 000023 100a     `?L243`:    bpl     `?L121`
0371                  	{
0372                  		printf("%d-",i);
0373                  		for (j=0;j<cols;j++)
0374                  		{
0375                  			printf("%d ",Tracker[i][j]);
0376                  		}
0377                  		printf("\r");
0378                  	}
0379                  }
    \ 000025 3b                   tsc
    \ 000026 18                   clc
    \ 000027 690a00               adc     ##10
    \ 00002a 1b                   tcs
    \ 00002b 7a                   ply
    \ 00002c 84..                 sty     dp:.tiny (_Dp+8)
    \ 00002e 6b                   rtl
    \ 00002f a309     `?L121`:    lda     9,s
    \ 000031 48                   pha
    \ 000032 a9....               lda     ##`_StringLiteral_%d-`
    \ 000035 22......             jsl     long:printf
    \ 000039 8303                 sta     3,s
    \ 00003b 68                   pla
    \ 00003c a90000               lda     ##0
    \ 00003f 8301                 sta     1,s
    \ 000041 8307     `?L288`:    sta     7,s
    \ 000043 a307                 lda     7,s
    \ 000045 38                   sec
    \ 000046 e305                 sbc     5,s
    \ 000048 5003                 bvc     `?L246`
    \ 00004a 490080               eor     ##-32768
    \ 00004d 3010     `?L246`:    bmi     `?L125`
    \ 00004f a9....               lda     ##`_StringLiteral_[13]`
    \ 000052 22......             jsl     long:printf
    \ 000056 a309                 lda     9,s
    \ 000058 1a                   inc     a
    \ 000059 8301                 sta     1,s
    \ 00005b a301                 lda     1,s
    \ 00005d 80b8                 bra     `?L289`
    \ 00005f a305     `?L125`:    lda     5,s
    \ 000061 08                   php
    \ 000062 78                   sei
    \ 000063 8d0201               sta     258
    \ 000066 a30a                 lda     10,s
    \ 000068 8d0001               sta     256
    \ 00006b ad0401               lda     260
    \ 00006e 28                   plp
    \ 00006f 18                   clc
    \ 000070 65..                 adc     dp:.tiny (_Dp+8)
    \ 000072 a8                   tay
    \ 000073 b307                 lda     (7,s),y
    \ 000075 29ff00               and     ##255
    \ 000078 48                   pha
    \ 000079 a9....               lda     ##`_StringLiteral_%d `
    \ 00007c 22......             jsl     long:printf
    \ 000080 8303                 sta     3,s
    \ 000082 68                   pla
    \ 000083 a307                 lda     7,s
    \ 000085 1a                   inc     a
    \ 000086 8301                 sta     1,s
    \ 000088 a301                 lda     1,s
    \ 00008a 80b5                 bra     `?L288`
0380                  
0381                  // Play Trak in Track Memory
0382                  void playSongSID(int rows,int cols, unsigned char (*Tracker)[cols], int tempo)
0383                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public playSongSID
    \ 000000          playSongSID:
    \ 000000 a8                   tay
    \ 000001 3b                   tsc
    \ 000002 38                   sec
    \ 000003 e91c00               sbc     ##28
    \ 000006 1b                   tcs
    \ 000007 98                   tya
    \ 000008 8301                 sta     1,s
    \ 00000a a5..                 lda     dp:.tiny _Dp
    \ 00000c 830f                 sta     15,s
    \ 00000e a5..                 lda     dp:.tiny (_Dp+2)
    \ 000010 830d                 sta     13,s
0384                  	int i,j,note,volume,instrument,wave1,wave2,wave3;
0385                  	unsigned char hiFreq, loFreq;
0386                  	int tracks=cols/3;
    \ 000012 a30f                 lda     15,s
    \ 000014 08                   php
    \ 000015 78                   sei
    \ 000016 8d1a01               sta     282
    \ 000019 a90300               lda     ##3
    \ 00001c 8d1801               sta     280
    \ 00001f ad1c01               lda     284
    \ 000022 28                   plp
    \ 000023 8303                 sta     3,s
0387                  	
0388                  	// Initialize SID CHIP
0389                  	resetSID();
    \ 000025 22......             jsl     long:resetSID
0390                  	
0391                  	// set the Default Instrument to Piano for the 3 voices
0392                  	 wave1=setInstrumentSID(1, 1);
    \ 000029 a20100               ldx     ##1
    \ 00002c 86..                 stx     dp:.tiny _Dp
    \ 00002e 8a                   txa
    \ 00002f 22......             jsl     long:setInstrumentSID
    \ 000033 8305                 sta     5,s
0393                  	 wave2=setInstrumentSID(2, 1);
    \ 000035 a20100               ldx     ##1
    \ 000038 86..                 stx     dp:.tiny _Dp
    \ 00003a a90200               lda     ##2
    \ 00003d 22......             jsl     long:setInstrumentSID
    \ 000041 8307                 sta     7,s
0394                  	 wave3=setInstrumentSID(3, 1);
    \ 000043 a20100               ldx     ##1
    \ 000046 86..                 stx     dp:.tiny _Dp
    \ 000048 a90300               lda     ##3
    \ 00004b 22......             jsl     long:setInstrumentSID
    \ 00004f 8309                 sta     9,s
0395                  	
0396                  	// Init Music playing
0397                  	for (i=1;i<=rows;i++)
    \ 000051 a90100               lda     ##1
    \ 000054 830b                 sta     11,s
    \ 000056 8311                 sta     17,s
    \ 000058 a305                 lda     5,s
    \ 00005a 830b                 sta     11,s
    \ 00005c a309                 lda     9,s
    \ 00005e 8305     `?L295`:    sta     5,s
    \ 000060 a301                 lda     1,s
    \ 000062 38                   sec
    \ 000063 e311                 sbc     17,s
    \ 000065 5003                 bvc     `?L254`
    \ 000067 490080               eor     ##-32768
    \ 00006a 1028     `?L254`:    bpl     `?L132`
0398                  	{
0399                  		for (j=0;j<tracks;j++)
0400                  		{
0401                  			// read parameters to play from Memory
0402                  			note=Tracker[i][(j*3)]; 
0403                  			volume = Tracker[i][(j*3)+1];
0404                  			instrument=Tracker[i][(j*3)+2];
0405                  			
0406                  			// If there is a note to play
0407                  			if (note != 0)
0408                  			{
0409                  				hiFreq=SidNotes[note][0];
0410                  				loFreq=SidNotes[note][1];
0411                  				switch (j)
0412                  				{
0413                  					case 0: // play voice 1
0414                  						// Gate Out previous note
0415                  						SID0_V1_CTRL = wave1-1;  
0416                  						// Set Volume 
0417                  						SID0_MODE_VOL=volume;  // Set sid chip volume, note! volume can only be controlled in track 1! 
0418                  						// if there's a new instrument change it before playing note
0419                  						wave1=setInstrumentSID(1, instrument);
0420                  
0421                  						if (note<100)
0422                  						{
0423                  							// play new note 							
0424                  							SID0_V1_FREQ_LO = loFreq; 
0425                  							SID0_V1_FREQ_HI = hiFreq;
0426                  							if (instrument==3)
0427                  							{
0428                  								SID0_V1_PW_LO = loFreq;
0429                  								SID0_V1_PW_HI = hiFreq;
0430                  							}
0431                  							SID0_V1_CTRL=wave1; // Gate in New note!						
0432                  						}
0433                  						else
0434                  							SID0_V1_CTRL=wave1-1; // Gate out note!						
0435                  					break;
0436                  					case 1:  // play voice 2
0437                  						// Gate Out previous note
0438                  						SID0_V2_CTRL = wave2-1;
0439                  						// if there's a new instrument change it before playing note
0440                  						wave2=setInstrumentSID(2, instrument);
0441                  						if (note<100)
0442                  						{
0443                  							// play new note 
0444                  							SID0_V2_FREQ_LO = loFreq; 
0445                  							SID0_V2_FREQ_HI = hiFreq;
0446                  							if (instrument==3)
0447                  							{
0448                  								SID0_V2_PW_LO = loFreq;
0449                  								SID0_V2_PW_HI = hiFreq;
0450                  							}
0451                  
0452                  							SID0_V2_CTRL=wave2; // Gate in New note!
0453                  						}
0454                  						else
0455                  							SID0_V2_CTRL=wave2-1; // Gate out note!						
0456                  					break;
0457                  					case 2: // play voice 3
0458                  						// Gate Out previous note
0459                  						SID0_V3_CTRL = wave3-1;  
0460                  						// if there's a new instrument change it before playing note
0461                  						wave3=setInstrumentSID(3, instrument);
0462                  						if (note<100)
0463                  						{
0464                  							// play new note 
0465                  							SID0_V3_FREQ_LO = loFreq; 
0466                  							SID0_V3_FREQ_HI = hiFreq;
0467                  							if (instrument==3)
0468                  							{
0469                  								SID0_V3_PW_LO = loFreq;
0470                  								SID0_V3_PW_HI = hiFreq;
0471                  							}
0472                  
0473                  							SID0_V3_CTRL=wave3; // Gate in New note!
0474                  						}
0475                  						else
0476                  							SID0_V3_CTRL=wave3-1; // Gate out note!
0477                  					break; 
0478                  				}
0479                  			}
0480                  		}
0481                  		delay( (65535*5)/tempo); // wait for 1/16th
0482                  	}
0483                  	SID0_V1_CTRL=wave1-1; // Gate out last note!
    \ 00006c a30b                 lda     11,s
    \ 00006e 3a                   dec     a
    \ 00006f e220                 sep     #32
    \ 000071 8f04e4af             sta     long:11527172
    \ 000075 c220                 rep     #32
0484                  	SID0_V2_CTRL=wave2-1; // Gate out last note!
    \ 000077 a307                 lda     7,s
    \ 000079 3a                   dec     a
    \ 00007a e220                 sep     #32
    \ 00007c 8f0be4af             sta     long:11527179
    \ 000080 c220                 rep     #32
0485                  	SID0_V3_CTRL=wave3-1; // Gate out last note!
    \ 000082 a305                 lda     5,s
    \ 000084 3a                   dec     a
    \ 000085 e220                 sep     #32
    \ 000087 8f12e4af             sta     long:11527186
    \ 00008b c220                 rep     #32
0486                  }
    \ 00008d 3b                   tsc
    \ 00008e 18                   clc
    \ 00008f 691c00               adc     ##28
    \ 000092 1b                   tcs
    \ 000093 6b                   rtl
    \ 000094 a90000   `?L132`:    lda     ##0
    \ 000097 8317                 sta     23,s
    \ 000099 a307                 lda     7,s
    \ 00009b 8315                 sta     21,s
    \ 00009d a305                 lda     5,s
    \ 00009f 8313     `?L294`:    sta     19,s
    \ 0000a1 a317                 lda     23,s
    \ 0000a3 38                   sec
    \ 0000a4 e303                 sbc     3,s
    \ 0000a6 5003                 bvc     `?L256`
    \ 0000a8 490080               eor     ##-32768
    \ 0000ab 3035     `?L256`:    bmi     `?L136`
    \ 0000ad a9fbff               lda     ##65531
    \ 0000b0 85..                 sta     dp:.tiny _Dp
    \ 0000b2 a90400               lda     ##4
    \ 0000b5 85..                 sta     dp:.tiny (_Dp+2)
    \ 0000b7 a320                 lda     32,s
    \ 0000b9 a20000               ldx     ##0
    \ 0000bc a8                   tay
    \ 0000bd 1001                 bpl     `?L258`
    \ 0000bf ca                   dex
    \ 0000c0          `?L258`:
    \ 0000c0 86..                 stx     dp:.tiny (_Dp+6)
    \ 0000c2 85..                 sta     dp:.tiny (_Dp+4)
    \ 0000c4 22......             jsl     long:_Div32
    \ 0000c8 22......             jsl     long:_SInt32ToFloat32
    \ 0000cc 22......             jsl     long:delay
    \ 0000d0 a311                 lda     17,s
    \ 0000d2 1a                   inc     a
    \ 0000d3 8305                 sta     5,s
    \ 0000d5 a305                 lda     5,s
    \ 0000d7 8311                 sta     17,s
    \ 0000d9 a315                 lda     21,s
    \ 0000db 8307                 sta     7,s
    \ 0000dd a313                 lda     19,s
    \ 0000df 4c....               jmp     .kbank `?L295`
    \ 0000e2 a317     `?L136`:    lda     23,s
    \ 0000e4 8307                 sta     7,s
    \ 0000e6 8305                 sta     5,s
    \ 0000e8 a307                 lda     7,s
    \ 0000ea 0a                   asl     a
    \ 0000eb 8307                 sta     7,s
    \ 0000ed 18                   clc
    \ 0000ee 6305                 adc     5,s
    \ 0000f0 8305                 sta     5,s
    \ 0000f2 a30f                 lda     15,s
    \ 0000f4 08                   php
    \ 0000f5 78                   sei
    \ 0000f6 8d0201               sta     258
    \ 0000f9 a312                 lda     18,s
    \ 0000fb 8d0001               sta     256
    \ 0000fe ad0401               lda     260
    \ 000101 28                   plp
    \ 000102 18                   clc
    \ 000103 630d                 adc     13,s
    \ 000105 a8                   tay
    \ 000106 b305                 lda     (5,s),y
    \ 000108 29ff00               and     ##255
    \ 00010b 8319                 sta     25,s
    \ 00010d a317                 lda     23,s
    \ 00010f 8307                 sta     7,s
    \ 000111 8305                 sta     5,s
    \ 000113 a307                 lda     7,s
    \ 000115 0a                   asl     a
    \ 000116 8307                 sta     7,s
    \ 000118 18                   clc
    \ 000119 6305                 adc     5,s
    \ 00011b 8305                 sta     5,s
    \ 00011d a30f                 lda     15,s
    \ 00011f 08                   php
    \ 000120 78                   sei
    \ 000121 8d0201               sta     258
    \ 000124 a312                 lda     18,s
    \ 000126 8d0001               sta     256
    \ 000129 ad0401               lda     260
    \ 00012c 28                   plp
    \ 00012d 18                   clc
    \ 00012e 630d                 adc     13,s
    \ 000130 85..                 sta     dp:.tiny _Dp
    \ 000132 a305                 lda     5,s
    \ 000134 22......             jsl     long:`?L307`
    \ 000138 8305                 sta     5,s
    \ 00013a a317                 lda     23,s
    \ 00013c 8309                 sta     9,s
    \ 00013e 8307                 sta     7,s
    \ 000140 a309                 lda     9,s
    \ 000142 0a                   asl     a
    \ 000143 8309                 sta     9,s
    \ 000145 18                   clc
    \ 000146 6307                 adc     7,s
    \ 000148 8307                 sta     7,s
    \ 00014a a30f                 lda     15,s
    \ 00014c 08                   php
    \ 00014d 78                   sei
    \ 00014e 8d0201               sta     258
    \ 000151 a312                 lda     18,s
    \ 000153 8d0001               sta     256
    \ 000156 ad0401               lda     260
    \ 000159 28                   plp
    \ 00015a 18                   clc
    \ 00015b 630d                 adc     13,s
    \ 00015d 85..                 sta     dp:.tiny _Dp
    \ 00015f a307                 lda     7,s
    \ 000161 1a                   inc     a
    \ 000162 22......             jsl     long:`?L307`
    \ 000166 8309                 sta     9,s
    \ 000168 a319                 lda     25,s
    \ 00016a d003                 bne     `?L364`
    \ 00016c 4c....               jmp     .kbank `?L140`
    \ 00016f 1a       `?L364`:    inc     a
    \ 000170 3a                   dec     a
    \ 000171 0a                   asl     a
    \ 000172 aa                   tax
    \ 000173 e220                 sep     #32
    \ 000175 bd....               lda     SidNotes,x
    \ 000178 831b                 sta     27,s
    \ 00017a c220                 rep     #32
    \ 00017c a319                 lda     25,s
    \ 00017e 0a                   asl     a
    \ 00017f 18                   clc
    \ 000180 69....               adc     ##SidNotes
    \ 000183 aa                   tax
    \ 000184 e220                 sep     #32
    \ 000186 bd0100               lda     1,x
    \ 000189 831c                 sta     28,s
    \ 00018b c220                 rep     #32
    \ 00018d a317                 lda     23,s
    \ 00018f 8307                 sta     7,s
    \ 000191 d003                 bne     `?L365`
    \ 000193 4c....               jmp     .kbank `?L147`
    \ 000196 a307     `?L365`:    lda     7,s
    \ 000198 c90100               cmp     ##1
    \ 00019b f075                 beq     `?L146`
    \ 00019d 1a                   inc     a
    \ 00019e 3a                   dec     a
    \ 00019f c90200               cmp     ##2
    \ 0001a2 f009                 beq     `?L145`
    \ 0001a4 a30b                 lda     11,s
    \ 0001a6 8309                 sta     9,s
    \ 0001a8 a315                 lda     21,s
    \ 0001aa 4c....               jmp     .kbank `?L293`
    \ 0001ad a313     `?L145`:    lda     19,s
    \ 0001af 3a                   dec     a
    \ 0001b0 e220                 sep     #32
    \ 0001b2 8f12e4af             sta     long:11527186
    \ 0001b6 c220                 rep     #32
    \ 0001b8 a309                 lda     9,s
    \ 0001ba 85..                 sta     dp:.tiny _Dp
    \ 0001bc a90300               lda     ##3
    \ 0001bf 22......             jsl     long:setInstrumentSID
    \ 0001c3 8305                 sta     5,s
    \ 0001c5 a319                 lda     25,s
    \ 0001c7 38                   sec
    \ 0001c8 e96400               sbc     ##100
    \ 0001cb 5003                 bvc     `?L264`
    \ 0001cd 490080               eor     ##-32768
    \ 0001d0 102a     `?L264`:    bpl     `?L162`
    \ 0001d2 e220                 sep     #32
    \ 0001d4 a31c                 lda     28,s
    \ 0001d6 8f0ee4af             sta     long:11527182
    \ 0001da a31b                 lda     27,s
    \ 0001dc 8f0fe4af             sta     long:11527183
    \ 0001e0 22......             jsl     long:`?L308`
    \ 0001e4 d010                 bne     `?L166`
    \ 0001e6 e220                 sep     #32
    \ 0001e8 a31c                 lda     28,s
    \ 0001ea 8f10e4af             sta     long:11527184
    \ 0001ee a31b                 lda     27,s
    \ 0001f0 8f11e4af             sta     long:11527185
    \ 0001f4 c220                 rep     #32
    \ 0001f6 e220     `?L166`:    sep     #32
    \ 0001f8 a305                 lda     5,s
    \ 0001fa 8005                 bra     `?L290`
    \ 0001fc a305     `?L162`:    lda     5,s
    \ 0001fe 3a                   dec     a
    \ 0001ff e220                 sep     #32
    \ 000201 8f12e4af `?L290`:    sta     long:11527186
    \ 000205 c220                 rep     #32
    \ 000207 a30b                 lda     11,s
    \ 000209 8309                 sta     9,s
    \ 00020b a315                 lda     21,s
    \ 00020d 8307                 sta     7,s
    \ 00020f 4c....               jmp     .kbank `?L138`
    \ 000212 a315     `?L146`:    lda     21,s
    \ 000214 3a                   dec     a
    \ 000215 e220                 sep     #32
    \ 000217 8f0be4af             sta     long:11527179
    \ 00021b c220                 rep     #32
    \ 00021d a309                 lda     9,s
    \ 00021f 85..                 sta     dp:.tiny _Dp
    \ 000221 a90200               lda     ##2
    \ 000224 22......             jsl     long:setInstrumentSID
    \ 000228 8305                 sta     5,s
    \ 00022a a319                 lda     25,s
    \ 00022c 38                   sec
    \ 00022d e96400               sbc     ##100
    \ 000230 5003                 bvc     `?L267`
    \ 000232 490080               eor     ##-32768
    \ 000235 102a     `?L267`:    bpl     `?L155`
    \ 000237 e220                 sep     #32
    \ 000239 a31c                 lda     28,s
    \ 00023b 8f07e4af             sta     long:11527175
    \ 00023f a31b                 lda     27,s
    \ 000241 8f08e4af             sta     long:11527176
    \ 000245 22......             jsl     long:`?L308`
    \ 000249 d010                 bne     `?L159`
    \ 00024b e220                 sep     #32
    \ 00024d a31c                 lda     28,s
    \ 00024f 8f09e4af             sta     long:11527177
    \ 000253 a31b                 lda     27,s
    \ 000255 8f0ae4af             sta     long:11527178
    \ 000259 c220                 rep     #32
    \ 00025b e220     `?L159`:    sep     #32
    \ 00025d a305                 lda     5,s
    \ 00025f 8005                 bra     `?L291`
    \ 000261 a305     `?L155`:    lda     5,s
    \ 000263 3a                   dec     a
    \ 000264 e220                 sep     #32
    \ 000266 8f0be4af `?L291`:    sta     long:11527179
    \ 00026a c220                 rep     #32
    \ 00026c a30b                 lda     11,s
    \ 00026e 8309                 sta     9,s
    \ 000270 a305                 lda     5,s
    \ 000272 8066                 bra     `?L293`
    \ 000274 a30b     `?L147`:    lda     11,s
    \ 000276 3a                   dec     a
    \ 000277 e220                 sep     #32
    \ 000279 8f04e4af             sta     long:11527172
    \ 00027d a305                 lda     5,s
    \ 00027f 8f18e4af             sta     long:11527192
    \ 000283 c220                 rep     #32
    \ 000285 a309                 lda     9,s
    \ 000287 85..                 sta     dp:.tiny _Dp
    \ 000289 a90100               lda     ##1
    \ 00028c 22......             jsl     long:setInstrumentSID
    \ 000290 8305                 sta     5,s
    \ 000292 a319                 lda     25,s
    \ 000294 38                   sec
    \ 000295 e96400               sbc     ##100
    \ 000298 5003                 bvc     `?L270`
    \ 00029a 490080               eor     ##-32768
    \ 00029d 102a     `?L270`:    bpl     `?L148`
    \ 00029f e220                 sep     #32
    \ 0002a1 a31c                 lda     28,s
    \ 0002a3 8f00e4af             sta     long:11527168
    \ 0002a7 a31b                 lda     27,s
    \ 0002a9 8f01e4af             sta     long:11527169
    \ 0002ad 22......             jsl     long:`?L308`
    \ 0002b1 d010                 bne     `?L152`
    \ 0002b3 e220                 sep     #32
    \ 0002b5 a31c                 lda     28,s
    \ 0002b7 8f02e4af             sta     long:11527170
    \ 0002bb a31b                 lda     27,s
    \ 0002bd 8f03e4af             sta     long:11527171
    \ 0002c1 c220                 rep     #32
    \ 0002c3 e220     `?L152`:    sep     #32
    \ 0002c5 a305                 lda     5,s
    \ 0002c7 8005                 bra     `?L292`
    \ 0002c9 a305     `?L148`:    lda     5,s
    \ 0002cb 3a                   dec     a
    \ 0002cc e220                 sep     #32
    \ 0002ce 8f04e4af `?L292`:    sta     long:11527172
    \ 0002d2 c220                 rep     #32
    \ 0002d4 a305                 lda     5,s
    \ 0002d6 8309                 sta     9,s
    \ 0002d8 a315                 lda     21,s
    \ 0002da 8307     `?L293`:    sta     7,s
    \ 0002dc a313                 lda     19,s
    \ 0002de 8305                 sta     5,s
    \ 0002e0 800c                 bra     `?L138`
    \ 0002e2 a30b     `?L140`:    lda     11,s
    \ 0002e4 8309                 sta     9,s
    \ 0002e6 a315                 lda     21,s
    \ 0002e8 8307                 sta     7,s
    \ 0002ea a313                 lda     19,s
    \ 0002ec 8305                 sta     5,s
    \ 0002ee a317     `?L138`:    lda     23,s
    \ 0002f0 1a                   inc     a
    \ 0002f1 830b                 sta     11,s
    \ 0002f3 a30b                 lda     11,s
    \ 0002f5 8317                 sta     23,s
    \ 0002f7 a309                 lda     9,s
    \ 0002f9 830b                 sta     11,s
    \ 0002fb a307                 lda     7,s
    \ 0002fd 8315                 sta     21,s
    \ 0002ff a305                 lda     5,s
    \ 000301 4c....               jmp     .kbank `?L294`
0487                  
0488                  
0489                  int setInstrumentSID(int voice, int instrument)
0490                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public setInstrumentSID
    \ 000000          setInstrumentSID:
    \ 000000 a8                   tay
    \ 000001 3b                   tsc
    \ 000002 38                   sec
    \ 000003 e90c00               sbc     ##12
    \ 000006 1b                   tcs
    \ 000007 98                   tya
    \ 000008 8301                 sta     1,s
0491                  	int attack,decay,sustain,release,waveform,pulseWidth;
0492                  	
0493                  	instrument-=1;
    \ 00000a a5..                 lda     dp:.tiny _Dp
    \ 00000c 3a                   dec     a
    \ 00000d a8                   tay
0494                  	
0495                  	attack = SID_envelope[instrument][0];
    \ 00000e 98                   tya
    \ 00000f 0a                   asl     a
    \ 000010 0a                   asl     a
    \ 000011 0a                   asl     a
    \ 000012 0a                   asl     a
    \ 000013 aa                   tax
    \ 000014 bd....               lda     SID_envelope,x
    \ 000017 8303                 sta     3,s
0496                  	decay=SID_envelope[instrument][1];
0497                  	sustain=SID_envelope[instrument][2];
0498                  	release=SID_envelope[instrument][3];
0499                  	waveform=SID_envelope[instrument][4];
0500                  	pulseWidth=SID_envelope[instrument][5];		
0501                  
0502                  	//printf(".");
0503                  	//printf("Voice %d - A:%d D:%d S:%d R:%d WF:%d PWL:%d PWH:%d\r",voice,attack,decay,sustain,release,waveform,pulseWidth & 0x00FF, (pulseWidth - (pulseWidth & 0x00FF))/256);
0504                  	
0505                  	// configure selected Voice
0506                  	switch (voice)
    \ 000019 22......             jsl     long:`?L301`
    \ 00001d aa                   tax
    \ 00001e bd0200               lda     2,x
    \ 000021 8305                 sta     5,s
    \ 000023 22......             jsl     long:`?L301`
    \ 000027 aa                   tax
    \ 000028 bd0400               lda     4,x
    \ 00002b 8307                 sta     7,s
    \ 00002d 22......             jsl     long:`?L301`
    \ 000031 aa                   tax
    \ 000032 bd0600               lda     6,x
    \ 000035 8309                 sta     9,s
    \ 000037 22......             jsl     long:`?L301`
    \ 00003b aa                   tax
    \ 00003c bd0800               lda     8,x
    \ 00003f 830b                 sta     11,s
    \ 000041 22......             jsl     long:`?L301`
    \ 000045 a8                   tay
    \ 000046 be0a00               ldx     10,y
    \ 000049 a301                 lda     1,s
    \ 00004b c90100               cmp     ##1
    \ 00004e f07c                 beq     `?L176`
    \ 000050 a301                 lda     1,s
    \ 000052 c90200               cmp     ##2
    \ 000055 f040                 beq     `?L175`
    \ 000057 c90300               cmp     ##3
    \ 00005a f006                 beq     `?L174`
0507                  	{
0508                  		case 1:
0509                  			// SET VOICE 1 Parameters
0510                  			// set Attack/Decay /Sustain/release parameters	
0511                  			SID0_V1_ATCK_DECY = attack*16+decay;
0512                  			SID0_V1_SSTN_RLSE = sustain*16+release;
0513                  			// Set PulseWidth
0514                  			SID0_V1_PW_LO = pulseWidth & 0x00FF;
0515                  			SID0_V1_PW_HI = (int) pulseWidth /256;
0516                  			//Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc1->Osc2 (bit 2), Sync Osc1->Osc2 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0517                  			return waveform*16+1;
0518                  			break;
0519                  		case 2:
0520                  			// SET VOICE 2 Parameters
0521                  			// set Attack/Decay /Sustain/release parameters	
0522                  			SID0_V2_ATCK_DECY = attack*16+decay;
0523                  			SID0_V2_SSTN_RLSE = sustain*16+release;
0524                  			// Set PulseWidth
0525                  			SID0_V2_PW_LO = pulseWidth & 0x00FF;
0526                  			SID0_V2_PW_HI = (int) pulseWidth /256;
0527                  			//Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc1->Osc2 (bit 2), Sync Osc1->Osc2 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0528                  			return waveform*16+1;
0529                  			break;
0530                  		case 3:
0531                  			// SET VOICE 3 Parameters
0532                  			// set Attack/Decay /Sustain/release parameters	
0533                  			SID0_V3_ATCK_DECY = attack*16+decay;
0534                  			SID0_V3_SSTN_RLSE = sustain*16+release;
0535                  			// Set PulseWidth
0536                  			SID0_V3_PW_LO = pulseWidth & 0x00FF;
0537                  			SID0_V3_PW_HI = (int) pulseWidth /256;
0538                  			//Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc1->Osc2 (bit 2), Sync Osc1->Osc2 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0539                  			return waveform*16+1;
0540                  			break;
0541                  	}
0542                  	return 0;
    \ 00005c a90000               lda     ##0
    \ 00005f 4c....               jmp     .kbank `?L171`
    \ 000062          `?L174`:
    \ 000062 22......             jsl     long:`?L298`
    \ 000066 8f13e4af             sta     long:11527187
    \ 00006a 22......             jsl     long:`?L299`
    \ 00006e e220                 sep     #32
    \ 000070 8f14e4af             sta     long:11527188
    \ 000074 c220                 rep     #32
    \ 000076 8a                   txa
    \ 000077 e220                 sep     #32
    \ 000079 8f10e4af             sta     long:11527184
    \ 00007d c220                 rep     #32
    \ 00007f 8a                   txa
    \ 000080 08                   php
    \ 000081 78                   sei
    \ 000082 8d1a01               sta     282
    \ 000085 a90001               lda     ##256
    \ 000088 8d1801               sta     280
    \ 00008b ad1c01               lda     284
    \ 00008e 28                   plp
    \ 00008f e220                 sep     #32
    \ 000091 8f11e4af             sta     long:11527185
    \ 000095 8068                 bra     `?L296`
    \ 000097          `?L175`:
    \ 000097 22......             jsl     long:`?L298`
    \ 00009b 8f0ce4af             sta     long:11527180
    \ 00009f 22......             jsl     long:`?L299`
    \ 0000a3 e220                 sep     #32
    \ 0000a5 8f0de4af             sta     long:11527181
    \ 0000a9 c220                 rep     #32
    \ 0000ab 8a                   txa
    \ 0000ac e220                 sep     #32
    \ 0000ae 8f09e4af             sta     long:11527177
    \ 0000b2 c220                 rep     #32
    \ 0000b4 8a                   txa
    \ 0000b5 08                   php
    \ 0000b6 78                   sei
    \ 0000b7 8d1a01               sta     282
    \ 0000ba a90001               lda     ##256
    \ 0000bd 8d1801               sta     280
    \ 0000c0 ad1c01               lda     284
    \ 0000c3 28                   plp
    \ 0000c4 e220                 sep     #32
    \ 0000c6 8f0ae4af             sta     long:11527178
    \ 0000ca 8033                 bra     `?L296`
    \ 0000cc          `?L176`:
    \ 0000cc 22......             jsl     long:`?L298`
    \ 0000d0 8f05e4af             sta     long:11527173
    \ 0000d4 22......             jsl     long:`?L299`
    \ 0000d8 e220                 sep     #32
    \ 0000da 8f06e4af             sta     long:11527174
    \ 0000de c220                 rep     #32
    \ 0000e0 8a                   txa
    \ 0000e1 e220                 sep     #32
    \ 0000e3 8f02e4af             sta     long:11527170
    \ 0000e7 c220                 rep     #32
    \ 0000e9 8a                   txa
    \ 0000ea 08                   php
    \ 0000eb 78                   sei
    \ 0000ec 8d1a01               sta     282
    \ 0000ef a90001               lda     ##256
    \ 0000f2 8d1801               sta     280
    \ 0000f5 ad1c01               lda     284
    \ 0000f8 28                   plp
    \ 0000f9 e220                 sep     #32
    \ 0000fb 8f03e4af             sta     long:11527171
    \ 0000ff c220     `?L296`:    rep     #32
    \ 000101 a30b                 lda     11,s
    \ 000103 0a                   asl     a
    \ 000104 0a                   asl     a
    \ 000105 0a                   asl     a
    \ 000106 0a                   asl     a
    \ 000107 1a                   inc     a
    \ 000108          `?L171`:
0543                  }
    \ 000108 a8                   tay
    \ 000109 3b                   tsc
    \ 00010a 18                   clc
    \ 00010b 690c00               adc     ##12
    \ 00010e 1b                   tcs
    \ 00010f 98                   tya
    \ 000110 6b                   rtl
0544                  
0545                  void delay (float value)
0546                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public delay
    \ 000000          delay:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 86..                 stx     dp:.tiny (_Dp+10)
    \ 000006 85..                 sta     dp:.tiny (_Dp+8)
0547                  	// Just a Busy loop to waste time!
0548                  	float i;
0549                  	for (i=0;i<value;i++)
    \ 000008 a90000               lda     ##0
    \ 00000b 85..                 sta     dp:.tiny (_Dp+4)
    \ 00000d 85..                 sta     dp:.tiny (_Dp+6)
    \ 00000f          `?L188`:
    \ 00000f a6..                 ldx     dp:.tiny (_Dp+6)
    \ 000011 a5..                 lda     dp:.tiny (_Dp+4)
    \ 000013 a4..                 ldy     dp:.tiny (_Dp+8)
    \ 000015 84..                 sty     dp:.tiny _Dp
    \ 000017 a4..                 ldy     dp:.tiny (_Dp+10)
    \ 000019 84..                 sty     dp:.tiny (_Dp+2)
    \ 00001b 22......             jsl     long:_Float32LT
    \ 00001f 9007                 bcc     `?L189`
0550                  		;
0551                  }
    \ 000021 7a                   ply
    \ 000022 84..                 sty     dp:.tiny (_Dp+10)
    \ 000024 7a                   ply
    \ 000025 84..                 sty     dp:.tiny (_Dp+8)
    \ 000027 6b                   rtl
    \ 000028          `?L189`:
    \ 000028 a5..                 lda     dp:.tiny (_Dp+4)
    \ 00002a 85..                 sta     dp:.tiny _Dp
    \ 00002c a5..                 lda     dp:.tiny (_Dp+6)
    \ 00002e 85..                 sta     dp:.tiny (_Dp+2)
    \ 000030 a90000               lda     ##0
    \ 000033 a2803f               ldx     ##16256
    \ 000036 22......             jsl     long:_Float32Add
    \ 00003a 86..                 stx     dp:.tiny (_Dp+6)
    \ 00003c 85..                 sta     dp:.tiny (_Dp+4)
    \ 00003e 80cf                 bra     `?L188`
0552                  
0553                  void resetSID()
0554                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public resetSID
    \ 000000          resetSID:
0555                  	SID0_V1_FREQ_LO=0;
    \ 000000 e220                 sep     #32
    \ 000002 a900                 lda     #0
    \ 000004 8f00e4af             sta     long:11527168
0556                  	SID0_V1_FREQ_HI=0;
    \ 000008 8f01e4af             sta     long:11527169
0557                  	SID0_V1_PW_LO=0;
    \ 00000c 8f02e4af             sta     long:11527170
0558                  	SID0_V1_PW_HI=0;
    \ 000010 8f03e4af             sta     long:11527171
0559                  	SID0_V1_CTRL=0;
    \ 000014 8f04e4af             sta     long:11527172
0560                  	SID0_V1_ATCK_DECY=0;
    \ 000018 8f05e4af             sta     long:11527173
0561                  	SID0_V1_SSTN_RLSE=0;
    \ 00001c 8f06e4af             sta     long:11527174
0562                  	SID0_V2_FREQ_LO=0;
    \ 000020 8f07e4af             sta     long:11527175
0563                  	SID0_V2_FREQ_HI=0;
    \ 000024 8f08e4af             sta     long:11527176
0564                  	SID0_V2_PW_LO=0;
    \ 000028 8f09e4af             sta     long:11527177
0565                  	SID0_V2_PW_HI=0;
    \ 00002c 8f0ae4af             sta     long:11527178
0566                  	SID0_V2_CTRL=0;
    \ 000030 8f0be4af             sta     long:11527179
0567                  	SID0_V2_ATCK_DECY=0;
    \ 000034 8f0ce4af             sta     long:11527180
0568                  	SID0_V2_SSTN_RLSE=0;
    \ 000038 8f0de4af             sta     long:11527181
0569                  	SID0_V3_FREQ_LO=0;
    \ 00003c 8f0ee4af             sta     long:11527182
0570                  	SID0_V3_FREQ_HI=0;
    \ 000040 8f0fe4af             sta     long:11527183
0571                  	SID0_V3_PW_LO=0;
    \ 000044 8f10e4af             sta     long:11527184
0572                  	SID0_V3_PW_HI=0;
    \ 000048 8f11e4af             sta     long:11527185
0573                  	SID0_V3_CTRL=0;
    \ 00004c 8f12e4af             sta     long:11527186
0574                  	SID0_V3_ATCK_DECY=0;
    \ 000050 8f13e4af             sta     long:11527187
0575                  	SID0_V3_SSTN_RLSE=0;
    \ 000054 8f14e4af             sta     long:11527188
0576                  	SID0_FC_LO=0;
    \ 000058 8f15e4af             sta     long:11527189
0577                  	SID0_FC_HI=0;
    \ 00005c 8f16e4af             sta     long:11527190
0578                  	SID0_RES_FILT=0;
    \ 000060 8f17e4af             sta     long:11527191
0579                  	SID0_MODE_VOL=0;
    \ 000064 8f18e4af             sta     long:11527192
    \ 000068 c220                 rep     #32
0580                  }
    \ 00006a 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 1a       `?L297`:    inc     a
    \ 000001 18                   clc
    \ 000002 65..                 adc     dp:.tiny _Dp
    \ 000004 aa                   tax
    \ 000005 a316                 lda     22,s
    \ 000007 e220                 sep     #32
    \ 000009 9d0000               sta     0,x
    \ 00000c c220                 rep     #32
    \ 00000e a325                 lda     37,s
    \ 000010 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a306     `?L298`:    lda     6,s
    \ 000002 e220                 sep     #32
    \ 000004 0a                   asl     a
    \ 000005 0a                   asl     a
    \ 000006 0a                   asl     a
    \ 000007 0a                   asl     a
    \ 000008 c220                 rep     #32
    \ 00000a 18                   clc
    \ 00000b 6308                 adc     8,s
    \ 00000d e220                 sep     #32
    \ 00000f 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 c220     `?L299`:    rep     #32
    \ 000002 a30a                 lda     10,s
    \ 000004 e220                 sep     #32
    \ 000006 0a                   asl     a
    \ 000007 0a                   asl     a
    \ 000008 0a                   asl     a
    \ 000009 0a                   asl     a
    \ 00000a c220                 rep     #32
    \ 00000c 18                   clc
    \ 00000d 630c                 adc     12,s
    \ 00000f 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 1a       `?L300`:    inc     a
    \ 000001 18                   clc
    \ 000002 65..                 adc     dp:.tiny _Dp
    \ 000004 aa                   tax
    \ 000005 e220                 sep     #32
    \ 000007 a900                 lda     #0
    \ 000009 9d0000               sta     0,x
    \ 00000c c220                 rep     #32
    \ 00000e 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 98       `?L301`:    tya
    \ 000001 0a                   asl     a
    \ 000002 0a                   asl     a
    \ 000003 0a                   asl     a
    \ 000004 0a                   asl     a
    \ 000005 18                   clc
    \ 000006 69....               adc     ##SID_envelope
    \ 000009 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 1a       `?L302`:    inc     a
    \ 000001 18                   clc
    \ 000002 65..                 adc     dp:.tiny _Dp
    \ 000004 aa                   tax
    \ 000005 a31e                 lda     30,s
    \ 000007 e220                 sep     #32
    \ 000009 9d0000               sta     0,x
    \ 00000c c220                 rep     #32
    \ 00000e a312                 lda     18,s
    \ 000010 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a327     `?L303`:    lda     39,s
    \ 000002 a8                   tay
    \ 000003 b31a                 lda     (26,s),y
    \ 000005 e220                 sep     #32
    \ 000007 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 29ff00   `?L304`:    and     ##255
    \ 000003 38                   sec
    \ 000004 e93000               sbc     ##48
    \ 000007 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 18       `?L305`:    clc
    \ 000001 691d00               adc     ##29
    \ 000004 a8                   tay
    \ 000005 8a                   txa
    \ 000006 e220                 sep     #32
    \ 000008 9316                 sta     (22,s),y
    \ 00000a c220                 rep     #32
    \ 00000c 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 18       `?L306`:    clc
    \ 000001 632f                 adc     47,s
    \ 000003 a8                   tay
    \ 000004 e220                 sep     #32
    \ 000006 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 1a       `?L307`:    inc     a
    \ 000001 18                   clc
    \ 000002 65..                 adc     dp:.tiny _Dp
    \ 000004 aa                   tax
    \ 000005 bd0000               lda     0,x
    \ 000008 29ff00               and     ##255
    \ 00000b 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 c220     `?L308`:    rep     #32
    \ 000002 a30c                 lda     12,s
    \ 000004 c90300               cmp     ##3
    \ 000007 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 e220     `?L309`:    sep     #32
    \ 000002 c930                 cmp     #48
    \ 000004 c220                 rep     #32
    \ 000006 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a327     `?L310`:    lda     39,s
    \ 000002 a8                   tay
    \ 000003 b30a                 lda     (10,s),y
    \ 000005 e220                 sep     #32
    \ 000007 6b                   rtl
    \ 000000                      .section switch,rodata
    \ 000000 0400     `?L200`:    .word   4
    \ 000002 ....                 .word   .word0 (`?L33`-1)
    \ 000004 6800                 .word   104
    \ 000006 ....                 .word   .word0 (`?L37`-1)
    \ 000008 7100                 .word   113
    \ 00000a ....                 .word   .word0 (`?L36`-1)
    \ 00000c 7300                 .word   115
    \ 00000e ....                 .word   .word0 (`?L34`-1)
    \ 000010 7400                 .word   116
    \ 000012 ....                 .word   .word0 (`?L35`-1)
    \ 000014 7700                 .word   119
    \ 000016 ....                 .word   .word0 (`?L38`-1)
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[13]`
    \ 000000          `_StringLiteral_[13]`:
    \ 000000 0d00                 .byte   13,0
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_%c`
    \ 000000          `_StringLiteral_%c`:
    \ 000000 256300               .byte   37,99,0
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_%d `
    \ 000000          `_StringLiteral_%d `:
    \ 000000 25642000             .byte   37,100,32,0
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_%d-`
    \ 000000          `_StringLiteral_%d-`:
    \ 000000 25642d00             .byte   37,100,45,0
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[60,45,32,85,110,101,120,112,101,99,116,101,100,32,99,104,97,114,97,99,116,101,114,13]`
    \ 000000          `_StringLiteral_[60,45,32,85,110,101,120,112,101,99,116,101,100,32,99,104,97,114,97,99,116,101,114,13]`:
    \ 000000 3c2d2055             .byte   60,45,32,85,110,101,120,112,101,99,116,101,100,32,99,104,97,114,97,99,116,101,114,13,0
    \ 000004 6e657870
    \ 000008 65637465
    \ 00000c 64206368
    \ 000010 61726163
    \ 000014 7465720d
    \ 000018 00

##########################
#                        #
# Memory sizes (decimal) #
#                        #
##########################

Executable        (Text): 3805 bytes
Constant                : 1270 bytes
Constant   __far        :   24 bytes
