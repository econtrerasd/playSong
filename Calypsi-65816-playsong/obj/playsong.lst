###############################################################################
#                                                                             #
# Calypsi ISO C compiler for 65816                              version 3.6.6 #
#                                                       17/Aug/2022  16:27:07 #
# Command line: --core=65816 --code-model=large --data-model=small            #
#               --target=Foenix -I ./include --speed -O2 --debug              #
#               --list-file=obj/playsong.lst -o obj/playsong.o                #
#               src/playsong.c                                                #
#                                                                             #
###############################################################################

    \ 000000                      .rtmodel version,"1"
    \ 000000                      .rtmodel codeModel,"large"
    \ 000000                      .rtmodel dataModel,"small"
    \ 000000                      .rtmodel core,"65816"
    \ 000000                      .rtmodel huge,"0"
    \ 000000                      .rtmodel doubleSize,"32"
    \ 000000                      .rtmodel target,"foenix"
    \ 000000                      .extern _Div32
    \ 000000                      .extern _Dp
    \ 000000                      .extern _Float32Add
    \ 000000                      .extern _Float32LT
    \ 000000                      .extern _Float32Mul
    \ 000000                      .extern _Float32ToSInt32
    \ 000000                      .extern _SInt32ToFloat32
    \ 000000                      .extern _ValueSwitch16
    \ 000000                      .extern _Vfp
    \ 000000                      .extern exit
    \ 000000                      .extern printf
    \ 000000                      .extern strcmp
    \ 000000                      .extern strlen
0001                  // ------------------------------------------------
0002                  // playsong.c
0003                  // Functions to implement the Simple Music commands
0004                  // ------------------------------------------------
0005                  
0006                  #include <stdio.h>
0007                  #include <stdlib.h>
0008                  #include <string.h>
0009                  
0010                  // function prototype
0011                  int addTrack(char tune[], int trackNumber, int rows, int cols, unsigned char (*Tracker)[cols]);
0012                  void cleanTracks(int rows,int cols,unsigned char (*Tracker)[cols]);
0013                  void showTracks(int rows,int cols,unsigned char (*Tracker)[cols]);
0014                  void playSongSID(int rows,int cols, unsigned char (*Tracker)[cols], int tempo);
0015                  int setInstrumentSID(int voice, int instrument);
0016                  void delay (float value);
0017                  void resetSID();
0018                  
0019                  // SID DEFINITIONS (Foenix U+ C256)
0020                  #define SID0_V1_FREQ_LO          (*(volatile __far uint8_t *)0xafe400)  //voice 1 Freq Low (Write Only)
0021                  #define SID0_V1_FREQ_HI          (*(volatile __far uint8_t *)0xafe401)  //voice 1 Freq Hi  (Write Only)
0022                  #define SID0_V1_PW_LO            (*(volatile __far uint8_t *)0xafe402)  //voice 1 Pulse Width Low (Write Only)
0023                  #define SID0_V1_PW_HI            (*(volatile __far uint8_t *)0xafe403)  //voice 1 Pulse Width Hi (Write Only)   [Unused (bits 7-4), Pulse Hi Nibble (bits 0-3)]
0024                  #define SID0_V1_CTRL             (*(volatile __far uint8_t *)0xafe404)  //voice 1 Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc3->Osc1 (bit 2), Sync Osc1->Osc3 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0025                  #define SID0_V1_ATCK_DECY        (*(volatile __far uint8_t *)0xafe405)  //voice 1 Attack/Decay (Write Only)     [Attack (bits 7-4), Decay (bits 0- 3)]
0026                  #define SID0_V1_SSTN_RLSE        (*(volatile __far uint8_t *)0xafe406)  //voice 1 Sustain/Release (Write Only)  [Sustain (bits 7-4), Release (bits 0- 3)]
0027                  #define SID0_V2_FREQ_LO          (*(volatile __far uint8_t *)0xafe407)  //voice 2 Freq Low (Write Only)
0028                  #define SID0_V2_FREQ_HI          (*(volatile __far uint8_t *)0xafe408)  //voice 2 Freq Hi  (Write Only)
0029                  #define SID0_V2_PW_LO            (*(volatile __far uint8_t *)0xafe409)  //voice 2 Pulse Width Low (Write Only)
0030                  #define SID0_V2_PW_HI            (*(volatile __far uint8_t *)0xafe40A)  //voice 2 Pulse Width Hi (Write Only)   [Unused (bits 7-4), Pulse Hi Nibble (bits 0-3)]
0031                  #define SID0_V2_CTRL             (*(volatile __far uint8_t *)0xafe40B)  //voice 2 Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc1->Osc2 (bit 2), Sync Osc1->Osc2 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0032                  #define SID0_V2_ATCK_DECY        (*(volatile __far uint8_t *)0xafe40C)  //voice 2 Attack/Decay (Write Only)     [Attack (bits 7-4), Decay (bits 0- 3)]
0033                  #define SID0_V2_SSTN_RLSE        (*(volatile __far uint8_t *)0xafe40D)  //voice 2 Sustain/Release (Write Only)  [Sustain (bits 7-4), Release (bits 0- 3)]
0034                  #define SID0_V3_FREQ_LO          (*(volatile __far uint8_t *)0xafe40E)  //voice 2 Freq Low (Write Only)
0035                  #define SID0_V3_FREQ_HI          (*(volatile __far uint8_t *)0xafe40F)  //voice 2 Freq Hi  (Write Only)
0036                  #define SID0_V3_PW_LO            (*(volatile __far uint8_t *)0xafe410)  //voice 2 Pulse Width Low (Write Only)
0037                  #define SID0_V3_PW_HI            (*(volatile __far uint8_t *)0xafe411)  //voice 2 Pulse Width Hi (Write Only)   [Unused (bits 7-4), Pulse Hi Nibble (bits 0-3)]
0038                  #define SID0_V3_CTRL             (*(volatile __far uint8_t *)0xafe412)  //voice 2 Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc2->Osc3 (bit 2), Sync Osc2->Osc3 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0039                  #define SID0_V3_ATCK_DECY        (*(volatile __far uint8_t *)0xafe413)  //voice 2 Attack/Decay (Write Only)     [Attack (bits 7-4), Decay (bits 0- 3)]
0040                  #define SID0_V3_SSTN_RLSE        (*(volatile __far uint8_t *)0xafe414)  //voice 2 Sustain/Release (Write Only)  [Sustain (bits 7-4), Release (bits 0- 3)]
0041                  #define SID0_FC_LO               (*(volatile __far uint8_t *)0xafe415)  //Filter Cutoff Low (Write Only)        [Unused (bits 7-4), Low-Nybble Bits (3-0)]
0042                  #define SID0_FC_HI               (*(volatile __far uint8_t *)0xafe416)  //Filter Cutoff Hi  (Write Only)        
0043                  #define SID0_RES_FILT            (*(volatile __far uint8_t *)0xafe417)  //Resonance/Filter Enable  (Write Only) [Resonance (bits 4-7), Filter voice 3 (bit 2), Filter voice 2 (bit 1), Filter voice 1 (bit 0)]
0044                  #define SID0_MODE_VOL            (*(volatile __far uint8_t *)0xafe418)  //Volume/Filter Type  (Write Only)      [High pass (bit 6), Bandpass (bit 5), Low pass (bit 4), Volume (bits 0- 3 )]
0045                  #define SID0_POT_X               (*(volatile __far uint8_t *)0xafe419)  //POT X (C256 - NOT USED)
0046                  #define SID0_POT_Y               (*(volatile __far uint8_t *)0xafe41A)  //POT Y (C256 - NOT USED)
0047                  #define SID0_OSC3_RND            (*(volatile __far uint8_t *)0xafe41B)  //OSC3 / RANDOM (Read Only)
0048                  #define SID0_ENV3                (*(volatile __far uint8_t *)0xafe41C)  //Misc (Read Only)  - ENV3
0049                  #define SID0_U1                  (*(volatile __far uint8_t *)0xafe41D)  //SID - L - NOT USED
0050                  #define SID0_U2                  (*(volatile __far uint8_t *)0xafe41E)  //SID - L - NOT USED
0051                  #define SID0_U3                  (*(volatile __far uint8_t *)0xafe41F)  //SID - L - NOT USED
0052                  
0053                  
0054                  const char notes[96][4]={
    \ 000000                      .section cdata,rodata
    \ 000000                      .public notes
    \ 000000 43300000 notes:      .byte   67,48,0,0
    \ 000004 43233000             .byte   67,35,48,0
    \ 000008 44300000             .byte   68,48,0,0
    \ 00000c 44233000             .byte   68,35,48,0
    \ 000010 45300000             .byte   69,48,0,0
    \ 000014 46300000             .byte   70,48,0,0
    \ 000018 46233000             .byte   70,35,48,0
    \ 00001c 47300000             .byte   71,48,0,0
    \ 000020 47233000             .byte   71,35,48,0
    \ 000024 41300000             .byte   65,48,0,0
    \ 000028 41233000             .byte   65,35,48,0
    \ 00002c 42300000             .byte   66,48,0,0
    \ 000030 43310000             .byte   67,49,0,0
    \ 000034 43233100             .byte   67,35,49,0
    \ 000038 44310000             .byte   68,49,0,0
    \ 00003c 44233100             .byte   68,35,49,0
    \ 000040 45310000             .byte   69,49,0,0
    \ 000044 46310000             .byte   70,49,0,0
    \ 000048 46233100             .byte   70,35,49,0
    \ 00004c 47310000             .byte   71,49,0,0
    \ 000050 47233100             .byte   71,35,49,0
    \ 000054 41310000             .byte   65,49,0,0
    \ 000058 41233100             .byte   65,35,49,0
    \ 00005c 42310000             .byte   66,49,0,0
    \ 000060 43320000             .byte   67,50,0,0
    \ 000064 43233200             .byte   67,35,50,0
    \ 000068 44320000             .byte   68,50,0,0
    \ 00006c 44233200             .byte   68,35,50,0
    \ 000070 45320000             .byte   69,50,0,0
    \ 000074 46320000             .byte   70,50,0,0
    \ 000078 46233200             .byte   70,35,50,0
    \ 00007c 47320000             .byte   71,50,0,0
    \ 000080 47233200             .byte   71,35,50,0
    \ 000084 41320000             .byte   65,50,0,0
    \ 000088 41233200             .byte   65,35,50,0
    \ 00008c 42320000             .byte   66,50,0,0
    \ 000090 43330000             .byte   67,51,0,0
    \ 000094 43233300             .byte   67,35,51,0
    \ 000098 44330000             .byte   68,51,0,0
    \ 00009c 44233300             .byte   68,35,51,0
    \ 0000a0 45330000             .byte   69,51,0,0
    \ 0000a4 46330000             .byte   70,51,0,0
    \ 0000a8 46233300             .byte   70,35,51,0
    \ 0000ac 47330000             .byte   71,51,0,0
    \ 0000b0 47233300             .byte   71,35,51,0
    \ 0000b4 41330000             .byte   65,51,0,0
    \ 0000b8 41233300             .byte   65,35,51,0
    \ 0000bc 42330000             .byte   66,51,0,0
    \ 0000c0 43340000             .byte   67,52,0,0
    \ 0000c4 43233400             .byte   67,35,52,0
    \ 0000c8 44340000             .byte   68,52,0,0
    \ 0000cc 44233400             .byte   68,35,52,0
    \ 0000d0 45340000             .byte   69,52,0,0
    \ 0000d4 46340000             .byte   70,52,0,0
    \ 0000d8 46233400             .byte   70,35,52,0
    \ 0000dc 47340000             .byte   71,52,0,0
    \ 0000e0 47233400             .byte   71,35,52,0
    \ 0000e4 41340000             .byte   65,52,0,0
    \ 0000e8 41233400             .byte   65,35,52,0
    \ 0000ec 42340000             .byte   66,52,0,0
    \ 0000f0 43350000             .byte   67,53,0,0
    \ 0000f4 43233500             .byte   67,35,53,0
    \ 0000f8 44350000             .byte   68,53,0,0
    \ 0000fc 44233500             .byte   68,35,53,0
    \ 000100 45350000             .byte   69,53,0,0
    \ 000104 46350000             .byte   70,53,0,0
    \ 000108 46233500             .byte   70,35,53,0
    \ 00010c 47350000             .byte   71,53,0,0
    \ 000110 47233500             .byte   71,35,53,0
    \ 000114 41350000             .byte   65,53,0,0
    \ 000118 41233500             .byte   65,35,53,0
    \ 00011c 42350000             .byte   66,53,0,0
    \ 000120 43360000             .byte   67,54,0,0
    \ 000124 43233600             .byte   67,35,54,0
    \ 000128 44360000             .byte   68,54,0,0
    \ 00012c 44233600             .byte   68,35,54,0
    \ 000130 45360000             .byte   69,54,0,0
    \ 000134 46360000             .byte   70,54,0,0
    \ 000138 46233600             .byte   70,35,54,0
    \ 00013c 47360000             .byte   71,54,0,0
    \ 000140 47233600             .byte   71,35,54,0
    \ 000144 41360000             .byte   65,54,0,0
    \ 000148 41233600             .byte   65,35,54,0
    \ 00014c 42360000             .byte   66,54,0,0
    \ 000150 43370000             .byte   67,55,0,0
    \ 000154 43233700             .byte   67,35,55,0
    \ 000158 44370000             .byte   68,55,0,0
    \ 00015c 44233700             .byte   68,35,55,0
    \ 000160 45370000             .byte   69,55,0,0
    \ 000164 46370000             .byte   70,55,0,0
    \ 000168 46233700             .byte   70,35,55,0
    \ 00016c 47370000             .byte   71,55,0,0
    \ 000170 47233700             .byte   71,35,55,0
    \ 000174 41370000             .byte   65,55,0,0
    \ 000178 41233700             .byte   65,35,55,0
    \ 00017c 42370000             .byte   66,55,0,0
0055                  	"C0","C#0","D0","D#0","E0","F0","F#0","G0","G#0","A0","A#0","B0",
0056                  	"C1","C#1","D1","D#1","E1","F1","F#1","G1","G#1","A1","A#1","B1",
0057                  	"C2","C#2","D2","D#2","E2","F2","F#2","G2","G#2","A2","A#2","B2",
0058                  	"C3","C#3","D3","D#3","E3","F3","F#3","G3","G#3","A3","A#3","B3",
0059                  	"C4","C#4","D4","D#4","E4","F4","F#4","G4","G#4","A4","A#4","B4",
0060                  	"C5","C#5","D5","D#5","E5","F5","F#5","G5","G#5","A5","A#5","B5",
0061                  	"C6","C#6","D6","D#6","E6","F6","F#6","G6","G#6","A6","A#6","B6",
0062                  	"C7","C#7","D7","D#7","E7","F7","F#7","G7","G#7","A7","A#7","B7"
0063                  };
0064                  
0065                  const float frequency[]  // Equal tempered scale values (Frequency)
    \ 000000                      .section cdata,rodata
    \ 000000                      .public frequency
    \ 000000 e5d08241 frequency:  .long   1099092197,1099599708,1100139725,1100716442,1101319373,1101964247,1102640579,1103364096
    \ 000004 5c8f8a41
    \ 000008 cdcc9241
    \ 00000c 9a999b41
    \ 000010 cdcca441
    \ 000014 d7a3ae41
    \ 000018 c3f5b841
    \ 00001c 0000c441
    \ 000020 14aecf41             .long   1104129556,1104936960,1105794276,1106702605,1107480596,1107990361,1108530456,1109102664
    \ 000024 0000dc41
    \ 000028 e414e941
    \ 00002c 0df1f641
    \ 000030 14d00242
    \ 000034 59970a42
    \ 000038 18d51242
    \ 00003c 48901b42
    \ 000040 48d02442             .long   1109708872,1110351151,1111031624,1111752547,1112516356,1113325568,1114182910,1115091213
    \ 000044 2f9d2e42
    \ 000048 48ff3842
    \ 00004c 63ff4342
    \ 000050 04a74f42
    \ 000054 00005c42
    \ 000058 fe146942
    \ 00005c 0df17642
    \ 000060 14d08242             .long   1115869204,1116378982,1116919064,1117491259,1118097493,1118739772,1119420232,1120141168
    \ 000064 66978a42
    \ 000068 18d59242
    \ 00006c 3b909b42
    \ 000070 55d0a442
    \ 000074 3c9dae42
    \ 000078 48ffb842
    \ 00007c 70ffc342
    \ 000080 e9a6cf42             .long   1120904937,1121714176,1122571518,1123479847,1124257825,1124767564,1125307646,1125879841
    \ 000084 0000dc42
    \ 000088 fe14e942
    \ 00008c 27f1f642
    \ 000090 21d00243
    \ 000094 4c970a43
    \ 000098 fed41243
    \ 00009c 21901b43
    \ 0000a0 62d02443             .long   1126486114,1127128367,1127808827,1128529789,1129293545,1130102784,1130960126,1131868455
    \ 0000a4 2f9d2e43
    \ 0000a8 3bff3843
    \ 0000ac 7dff4343
    \ 0000b0 e9a64f43
    \ 0000b4 00005c43
    \ 0000b8 fe146943
    \ 0000bc 27f17643
    \ 0000c0 21d08243             .long   1132646433,1133156205,1133696287,1134268482,1134874722,1135516975,1136197435,1136918364
    \ 0000c4 6d978a43
    \ 0000c8 1fd59243
    \ 0000cc 42909b43
    \ 0000d0 62d0a443
    \ 0000d4 2f9dae43
    \ 0000d8 3bffb843
    \ 0000dc 5cffc343
    \ 0000e0 0aa7cf43             .long   1137682186,1138491392,1139348734,1140257030,1141035024,1141544796,1142084895,1142657090
    \ 0000e4 0000dc43
    \ 0000e8 fe14e943
    \ 0000ec 06f1f643
    \ 0000f0 10d00244
    \ 0000f4 5c970a44
    \ 0000f8 1fd51244
    \ 0000fc 42901b44
    \ 000100 52d02444             .long   1143263314,1143905583,1144586060,1145306989,1146070778,1146880000,1147737342,1148645655
    \ 000104 2f9d2e44
    \ 000108 4cff3844
    \ 00010c 6dff4344
    \ 000110 faa64f44
    \ 000114 00005c44
    \ 000118 fe146944
    \ 00011c 17f17644
    \ 000120 00d08244             .long   1149423616,1149933404,1150473503,1151045714,1151651922,1152294175,1152974684,1153695580
    \ 000124 5c978a44
    \ 000128 1fd59244
    \ 00012c 52909b44
    \ 000130 52d0a444
    \ 000134 1f9dae44
    \ 000138 5cffb844
    \ 00013c 5cffc344
    \ 000140 0aa7cf44             .long   1154459402,1155268608,1156125983,1157034230,1157812224,1158322012,1158862111,1159434322
    \ 000144 0000dc44
    \ 000148 1f15e944
    \ 00014c f6f0f644
    \ 000150 00d00245
    \ 000154 5c970a45
    \ 000158 1fd51245
    \ 00015c 52901b45
    \ 000160 52d02445             .long   1160040530,1160682824,1161363292,1162084188,1162848010,1163657216,1164514550,1165422879
    \ 000164 489d2e45
    \ 000168 5cff3845
    \ 00016c 5cff4345
    \ 000170 0aa74f45
    \ 000174 00005c45
    \ 000178 f6146945
    \ 00017c 1ff17645
0066                  ={
0067                  	16.3520,17.3200,18.3500,19.4500,20.6000,21.8300,23.1200,24.5000,25.9600,27.5000,29.1352,30.8677,
0068                  	32.7032,34.6478,36.7081,38.8909,41.2034,43.6535,46.2493,48.9994,51.9131,55.0000,58.2705,61.7354,
0069                  	65.4064,69.2957,73.4162,77.7817,82.4069,87.3071,92.4986,97.9989,103.826,110.000,116.541,123.471,
0070                  	130.813,138.591,146.832,155.563,164.814,174.614,184.997,195.998,207.652,220.000,233.082,246.942,
0071                  	261.626,277.183,293.665,311.127,329.628,349.228,369.994,391.995,415.305,440.000,466.164,493.883,
0072                  	523.251,554.365,587.330,622.254,659.255,698.456,739.989,783.991,830.609,880.000,932.328,987.767,
0073                  	1046.50,1108.73,1174.66,1244.51,1318.51,1396.91,1479.98,1567.98,1661.22,1760.00,1864.66,1975.53,
0074                  	2093.00,2217.46,2349.32,2489.02,2637.02,2793.83,2959.96,3135.96,3322.44,3520.00,3729.31,3951.07
0075                  };
0076                  
0077                  const unsigned char SidNotes[96][2]={  // Sid HI, Sid Low
    \ 000000                      .section cdata,rodata
    \ 000000                      .public SidNotes
    \ 000000 010c     SidNotes:   .byte   1,12
    \ 000002 011c                 .byte   1,28
    \ 000004 012d                 .byte   1,45
    \ 000006 013e                 .byte   1,62
    \ 000008 0151                 .byte   1,81
    \ 00000a 0166                 .byte   1,102
    \ 00000c 017b                 .byte   1,123
    \ 00000e 0191                 .byte   1,-111
    \ 000010 01a9                 .byte   1,-87
    \ 000012 01c3                 .byte   1,-61
    \ 000014 01dd                 .byte   1,-35
    \ 000016 01fa                 .byte   1,-6
    \ 000018 0218                 .byte   2,24
    \ 00001a 0238                 .byte   2,56
    \ 00001c 025a                 .byte   2,90
    \ 00001e 027d                 .byte   2,125
    \ 000020 02a3                 .byte   2,-93
    \ 000022 02cc                 .byte   2,-52
    \ 000024 02f6                 .byte   2,-10
    \ 000026 0323                 .byte   3,35
    \ 000028 0353                 .byte   3,83
    \ 00002a 0386                 .byte   3,-122
    \ 00002c 03bb                 .byte   3,-69
    \ 00002e 03f4                 .byte   3,-12
    \ 000030 0430                 .byte   4,48
    \ 000032 0470                 .byte   4,112
    \ 000034 04b4                 .byte   4,-76
    \ 000036 04fb                 .byte   4,-5
    \ 000038 0547                 .byte   5,71
    \ 00003a 0598                 .byte   5,-104
    \ 00003c 05ed                 .byte   5,-19
    \ 00003e 0647                 .byte   6,71
    \ 000040 06a7                 .byte   6,-89
    \ 000042 070c                 .byte   7,12
    \ 000044 0777                 .byte   7,119
    \ 000046 07e9                 .byte   7,-23
    \ 000048 0861                 .byte   8,97
    \ 00004a 08e1                 .byte   8,-31
    \ 00004c 0968                 .byte   9,104
    \ 00004e 09f7                 .byte   9,-9
    \ 000050 0a8f                 .byte   10,-113
    \ 000052 0b30                 .byte   11,48
    \ 000054 0bda                 .byte   11,-38
    \ 000056 0c8f                 .byte   12,-113
    \ 000058 0d4e                 .byte   13,78
    \ 00005a 0e18                 .byte   14,24
    \ 00005c 0eef                 .byte   14,-17
    \ 00005e 0fd2                 .byte   15,-46
    \ 000060 10c3                 .byte   16,-61
    \ 000062 11c3                 .byte   17,-61
    \ 000064 12d1                 .byte   18,-47
    \ 000066 13ef                 .byte   19,-17
    \ 000068 151f                 .byte   21,31
    \ 00006a 1660                 .byte   22,96
    \ 00006c 17b5                 .byte   23,-75
    \ 00006e 191e                 .byte   25,30
    \ 000070 169c                 .byte   22,-100
    \ 000072 1c31                 .byte   28,49
    \ 000074 1ddf                 .byte   29,-33
    \ 000076 1fa5                 .byte   31,-91
    \ 000078 2187                 .byte   33,-121
    \ 00007a 2386                 .byte   35,-122
    \ 00007c 25a2                 .byte   37,-94
    \ 00007e 27df                 .byte   39,-33
    \ 000080 2a3e                 .byte   42,62
    \ 000082 2cc1                 .byte   44,-63
    \ 000084 2f6b                 .byte   47,107
    \ 000086 323c                 .byte   50,60
    \ 000088 3539                 .byte   53,57
    \ 00008a 3863                 .byte   56,99
    \ 00008c 3bbe                 .byte   59,-66
    \ 00008e 3f4b                 .byte   63,75
    \ 000090 430f                 .byte   67,15
    \ 000092 470c                 .byte   71,12
    \ 000094 4b45                 .byte   75,69
    \ 000096 4fbf                 .byte   79,-65
    \ 000098 547d                 .byte   84,125
    \ 00009a 5983                 .byte   89,-125
    \ 00009c 5ed6                 .byte   94,-42
    \ 00009e 6479                 .byte   100,121
    \ 0000a0 6a73                 .byte   106,115
    \ 0000a2 70c7                 .byte   112,-57
    \ 0000a4 777c                 .byte   119,124
    \ 0000a6 7e97                 .byte   126,-105
    \ 0000a8 861e                 .byte   -122,30
    \ 0000aa 8e18                 .byte   -114,24
    \ 0000ac 968b                 .byte   -106,-117
    \ 0000ae 9f7e                 .byte   -97,126
    \ 0000b0 a8fa                 .byte   -88,-6
    \ 0000b2 b306                 .byte   -77,6
    \ 0000b4 bdac                 .byte   -67,-84
    \ 0000b6 c8f3                 .byte   -56,-13
    \ 0000b8 d4e6                 .byte   -44,-26
    \ 0000ba e18f                 .byte   -31,-113
    \ 0000bc eef8                 .byte   -18,-8
    \ 0000be fdf6                 .byte   -3,-10
0078                  	{1,12},{1,28},{1,45},{1,62},{1,81},{1,102},{1,123},{1,145},{1,169},{1,195},{1,221},{1,250}, //Octave0
0079                  	{2,24},{2,56},{2,90},{2,125},{2,163},{2,204},{2,246},{3,35},{3,83},{3,134},{3,187},{3,244}, //Octave1
0080                  	{4,48},{4,112},{4,180},{4,251},{5,71},{5,152},{5,237},{6,71},{6,167},{7,12},{7,119},{7,233}, //Octave2
0081                  	{8,97},{8,225},{9,104},{9,247},{10,143},{11,48},{11,218},{12,143},{13,78},{14,24},{14,239},{15,210}, //Octave3
0082                  	{16,195},{17,195},{18,209},{19,239},{21,31},{22,96},{23,181},{25,30},{026,156},{28,49},{29,223},{31,165}, //Octave4
0083                  	{33,135},{35,134},{37,162},{39,223},{42,62},{44,193},{47,107},{50,60},{53,57},{56,99},{59,190},{63,75}, //Octave5
0084                  	{67,15},{71,12},{75,69},{79,191},{84,125},{89,131},{94,214},{100,121},{106,115},{112,199},{119,124},{126,151}, //Octave6
0085                  	{134,30},{142,24},{150,139},{159,126},{168,250},{179,6},{189,172},{200,243},{212,230},{225,143},{238,248},{253,246}  //Octave7
0086                  };
0087                  
0088                  // list of Instruments from c128 user manual
0089                  const int SID_envelope[16][8]={
    \ 000000                      .section cdata,rodata
    \ 000000                      .public SID_envelope
    \ 000000          SID_envelope:
    \ 000000 00000900             .word   0,9,0,0,4,2048,2,0
    \ 000004 00000000
    \ 000008 04000008
    \ 00000c 02000000
    \ 000010 08000200             .word   8,2,6,1,2,0,3,0
    \ 000014 06000100
    \ 000018 02000000
    \ 00001c 03000000
    \ 000020 00000300             .word   0,3,10,1,5,2048,1,0
    \ 000024 0a000100
    \ 000028 05000008
    \ 00002c 01000000
    \ 000030 00000500             .word   0,5,5,0,8,0,1,0
    \ 000034 05000000
    \ 000038 08000000
    \ 00003c 01000000
    \ 000040 08000300             .word   8,3,4,0,1,0,1,0
    \ 000044 04000000
    \ 000048 01000000
    \ 00004c 01000000
    \ 000050 00000800             .word   0,8,2,3,2,0,3,0
    \ 000054 02000300
    \ 000058 02000000
    \ 00005c 03000000
    \ 000060 00000900             .word   0,9,0,0,4,512,2,0
    \ 000064 00000000
    \ 000068 04000002
    \ 00006c 02000000
    \ 000070 03000a00             .word   3,10,10,1,4,2560,2,0
    \ 000074 0a000100
    \ 000078 0400000a
    \ 00007c 02000000
    \ 000080 07000700             .word   7,7,3,1,4,768,3,0
    \ 000084 03000100
    \ 000088 04000003
    \ 00008c 03000000
    \ 000090 00000800             .word   0,8,0,0,1,0,3,0
    \ 000094 00000000
    \ 000098 01000000
    \ 00009c 03000000
    \ 0000a0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000a4 00000000
    \ 0000a8 00000000
    \ 0000ac 00000000
    \ 0000b0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000b4 00000000
    \ 0000b8 00000000
    \ 0000bc 00000000
    \ 0000c0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000c4 00000000
    \ 0000c8 00000000
    \ 0000cc 00000000
    \ 0000d0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000d4 00000000
    \ 0000d8 00000000
    \ 0000dc 00000000
    \ 0000e0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000e4 00000000
    \ 0000e8 00000000
    \ 0000ec 00000000
    \ 0000f0 00000000             .word   0,0,0,0,0,0,0,0
    \ 0000f4 00000000
    \ 0000f8 00000000
    \ 0000fc 00000000
0090                  	// atk, dcy, sust, rel, wave [8-Noise Wave, 4-Pulse Wave, 2-Saw Wave, 1-Triangle Wave], pulseWidth, note length [1-normal, 2-legato (long), 3-staccato (short)]
0091                  	// note it's rarely used but you can add wave numbers to produce a more complex wave!! - see Distorted Synth, it has 5 as wave value (4 pulse + 1 triangle)
0092                  	{0,9,0,0,4,2048,2},  // 1.Piano
0093                  	{8,2,6,1,2,0,3},    // 2.Accordion
0094                  	{0,3,10,1,5,2048,1},  // 3.Distorted Synth
0095                  	{0,5,5,0,8,0,1},     // 4.GunShots
0096                  	{8,3,4,0,1,0,1},     // 5.Flute
0097                  	{0,8,2,3,2,0,3},     // 6.Guitar
0098                  	{0,9,0,0,4,512,2},   // 7.Harpsichord
0099                  	{3,10,10,1,4,2560,2},  // 8.Organ
0100                  	{7,7,3,1,4,768,3},   // 9.Oboe
0101                  	{0,8,0,0,1,0,3}      // 10.Xylophone
0102                  };
0103                  
0104                  const float noteLen[4]={0.75, 1.00 ,0.51}; // notelength for voices 1-3 (normal, legatto, staccatto)
    \ 000000                      .section cdata,rodata
    \ 000000                      .public noteLen
    \ 000000 0000403f noteLen:    .long   1061158912,1065353216,1057132380,0
    \ 000004 0000803f
    \ 000008 5c8f023f
    \ 00000c 00000000
0105                  
0106                  int addTrack(char tune[], int trackNumber, int rows, int cols, unsigned char (*Tracker)[cols])
0107                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public addTrack
    \ 000000 a8       addTrack:   tay
    \ 000001 3b                   tsc
    \ 000002 38                   sec
    \ 000003 e92600               sbc     ##38
    \ 000006 1b                   tcs
    \ 000007 98                   tya
    \ 000008 8324                 sta     36,s
0108                  	int tuneSize, c, t, pos, octave, octaveSubs, instrument, duration, volume, index;
0109                  	bool noteFlag, modFlag;
0110                  	char note[5];
0111                  	int gateOff, lengthNote;
0112                  	
0113                  	// set default value for parameters
0114                  	
0115                  	octave=4; // set default octave
    \ 00000a a90400               lda     ##4
    \ 00000d 8303                 sta     3,s
0116                  	instrument=1; // set default Instrument (SID Piano)
    \ 00000f a90100               lda     ##1
    \ 000012 8305                 sta     5,s
0117                  	volume=10; // set default volume 
    \ 000014 a90a00               lda     ##10
    \ 000017 8307                 sta     7,s
0118                  	trackNumber-=1; // First Tracks for users is track 1, but for functions it is track 0
    \ 000019 a5..                 lda     dp:.tiny _Dp
    \ 00001b 3a                   dec     a
    \ 00001c 8322                 sta     34,s
0119                  	
0120                  	// Initialize counters
0121                  	c=0;t=0; octaveSubs=0;
    \ 00001e a90000               lda     ##0
    \ 000021 8309                 sta     9,s
    \ 000023 830b                 sta     11,s
    \ 000025 1a                   inc     a
    \ 000026 3a                   dec     a
    \ 000027 8301                 sta     1,s
0122                  	
0123                  	tuneSize = strlen(tune);
    \ 000029 a324                 lda     36,s
    \ 00002b 22......             jsl     long:strlen
    \ 00002f 8311                 sta     17,s
0124                  	
0125                  	while (c<tuneSize)
    \ 000031 a309                 lda     9,s
    \ 000033 8317                 sta     23,s
    \ 000035 a30b                 lda     11,s
    \ 000037 8315                 sta     21,s
    \ 000039 a303                 lda     3,s
    \ 00003b 8319                 sta     25,s
    \ 00003d a305                 lda     5,s
    \ 00003f 830f                 sta     15,s
    \ 000041 a30d                 lda     13,s
    \ 000043 8303                 sta     3,s
    \ 000045 a307                 lda     7,s
    \ 000047 830d     `?L270`:    sta     13,s
    \ 000049 a317                 lda     23,s
    \ 00004b 38                   sec
    \ 00004c e311                 sbc     17,s
    \ 00004e 5003                 bvc     `?L203`
    \ 000050 490080               eor     ##-32768
    \ 000053 3003     `?L203`:    bmi     `?L339`
    \ 000055 4c....               jmp     .kbank `?L5`
    \ 000058          `?L339`:
0126                  	{
0127                  		pos=0;
    \ 000058 a90000               lda     ##0
    \ 00005b 8313                 sta     19,s
0128                  		octaveSubs=0;
    \ 00005d 8309                 sta     9,s
0129                  		modFlag=false;
    \ 00005f 830b                 sta     11,s
0130                  		noteFlag=false;
    \ 000061 1a                   inc     a
    \ 000062 3a                   dec     a
    \ 000063 8301                 sta     1,s
0131                  		// is code a note (A-G) or rest (R)?, if it is check the following: 
0132                  		// 1. is it sharp or flat? 
0133                  		// 2. has a specified Octave?
0134                  		// 3. has a duration?
0135                  		if ((tune[c]>='A' && tune[c]<='G') || (tune[c]=='R'))
    \ 000065 22......             jsl     long:`?L289`
    \ 000069 c941                 cmp     #65
    \ 00006b c220                 rep     #32
    \ 00006d 900e                 bcc     `?L182`
    \ 00006f a324                 lda     36,s
    \ 000071 a8                   tay
    \ 000072 a94700               lda     ##71
    \ 000075 e220                 sep     #32
    \ 000077 d317                 cmp     (23,s),y
    \ 000079 c220                 rep     #32
    \ 00007b b00d                 bcs     `?L9`
    \ 00007d          `?L182`:
    \ 00007d 22......             jsl     long:`?L289`
    \ 000081 c952                 cmp     #82
    \ 000083 c220                 rep     #32
    \ 000085 f003                 beq     `?L340`
    \ 000087 4c....               jmp     .kbank `?L7`
    \ 00008a          `?L340`:
    \ 00008a          `?L9`:
0136                  		{
0137                  			noteFlag=true;
    \ 00008a a90100               lda     ##1
    \ 00008d 8301                 sta     1,s
0138                  			// copy base note
0139                  			note[0]=tune[c];
0140                  			pos++;
0141                  			c++;
0142                  			if (tune[c] =='#')
    \ 00008f 22......             jsl     long:`?L289`
    \ 000093 831d                 sta     29,s
    \ 000095 c220                 rep     #32
    \ 000097 a313                 lda     19,s
    \ 000099 1a                   inc     a
    \ 00009a 8305                 sta     5,s
    \ 00009c a317                 lda     23,s
    \ 00009e 1a                   inc     a
    \ 00009f 8307                 sta     7,s
    \ 0000a1 22......             jsl     long:`?L295`
    \ 0000a5 c923                 cmp     #35
    \ 0000a7 c220                 rep     #32
    \ 0000a9 d03d                 bne     `?L10`
0143                  			{
0144                  				// Verify it's a valid Sharp note!
0145                  				if (note[0]!='B' && note[0]!='E')
    \ 0000ab a31d                 lda     29,s
    \ 0000ad e220                 sep     #32
    \ 0000af c942                 cmp     #66
    \ 0000b1 c220                 rep     #32
    \ 0000b3 f01b                 beq     `?L13`
    \ 0000b5 a31d                 lda     29,s
    \ 0000b7 e220                 sep     #32
    \ 0000b9 c945                 cmp     #69
    \ 0000bb c220                 rep     #32
    \ 0000bd f011                 beq     `?L13`
0146                  				{
    \ 0000bf 22......             jsl     long:`?L295`
0147                  					// Make it Sharp!	
0148                  					note[1]=tune[c];
    \ 0000c3 831e                 sta     30,s
    \ 0000c5 c220                 rep     #32
0149                  					pos++;
    \ 0000c7 a305                 lda     5,s
    \ 0000c9 1a                   inc     a
    \ 0000ca 8303                 sta     3,s
    \ 0000cc a303                 lda     3,s
    \ 0000ce 8004                 bra     `?L14`
    \ 0000d0 a305     `?L13`:     lda     5,s
    \ 0000d2 8303                 sta     3,s
    \ 0000d4          `?L14`:
0150                  				}
0151                  				c++;
    \ 0000d4 a307                 lda     7,s
    \ 0000d6 1a                   inc     a
    \ 0000d7 8305                 sta     5,s
    \ 0000d9 a305                 lda     5,s
    \ 0000db 8307                 sta     7,s
    \ 0000dd a303                 lda     3,s
    \ 0000df 8313                 sta     19,s
    \ 0000e1 a309                 lda     9,s
    \ 0000e3 8303                 sta     3,s
    \ 0000e5 4c....               jmp     .kbank `?L11`
    \ 0000e8          `?L10`:
0152                  			}
0153                  			else
0154                  			if (tune[c] =='$')
    \ 0000e8 22......             jsl     long:`?L295`
    \ 0000ec c924                 cmp     #36
    \ 0000ee c220                 rep     #32
    \ 0000f0 d07d                 bne     `?L16`
0155                  				// is it a flat note?
0156                  			{
0157                  				// modify note to be represented with a Sharp
0158                  				if (tune[c-1]==65)
    \ 0000f2 a307                 lda     7,s
    \ 0000f4 3a                   dec     a
    \ 0000f5 a8                   tay
    \ 0000f6 b324                 lda     (36,s),y
    \ 0000f8 e220                 sep     #32
    \ 0000fa c941                 cmp     #65
    \ 0000fc c220                 rep     #32
    \ 0000fe d024                 bne     `?L19`
0159                  					{
0160                  						note[0]='G';
    \ 000100 e220                 sep     #32
    \ 000102 a947                 lda     #71
    \ 000104 831d                 sta     29,s
    \ 000106 c220                 rep     #32
0161                  						if (octave > 0)
    \ 000108 a90000               lda     ##0
    \ 00010b 38                   sec
    \ 00010c e319                 sbc     25,s
    \ 00010e 5003                 bvc     `?L205`
    \ 000110 490080               eor     ##-32768
    \ 000113 1007     `?L205`:    bpl     `?L22`
0162                  							{octaveSubs=1;}
    \ 000115 a90100               lda     ##1
    \ 000118 8303                 sta     3,s
    \ 00011a 8002                 bra     `?L274`
    \ 00011c a309     `?L22`:     lda     9,s
    \ 00011e 8303     `?L274`:    sta     3,s
    \ 000120 a303                 lda     3,s
    \ 000122 8011                 bra     `?L20`
    \ 000124          `?L19`:
0163                  					}
0164                  				else
0165                  					{note[0]=tune[c-1]-1;}
    \ 000124 a307                 lda     7,s
    \ 000126 3a                   dec     a
    \ 000127 a8                   tay
    \ 000128 b324                 lda     (36,s),y
    \ 00012a 3a                   dec     a
    \ 00012b e220                 sep     #32
    \ 00012d 831d                 sta     29,s
    \ 00012f c220                 rep     #32
    \ 000131 a309                 lda     9,s
    \ 000133 8303                 sta     3,s
    \ 000135          `?L20`:
0166                  				// Add Sharp # symbol if needed
0167                  				if (note[0]!='E' && note[0]!='B' && note[0]!='R')
    \ 000135 a31d                 lda     29,s
    \ 000137 e220                 sep     #32
    \ 000139 c945                 cmp     #69
    \ 00013b c220                 rep     #32
    \ 00013d f025                 beq     `?L25`
    \ 00013f a31d                 lda     29,s
    \ 000141 e220                 sep     #32
    \ 000143 c942                 cmp     #66
    \ 000145 c220                 rep     #32
    \ 000147 f01b                 beq     `?L25`
    \ 000149 a31d                 lda     29,s
    \ 00014b e220                 sep     #32
    \ 00014d c952                 cmp     #82
    \ 00014f c220                 rep     #32
    \ 000151 f011                 beq     `?L25`
0168                  				{
0169                  					note[1]='#';
    \ 000153 e220                 sep     #32
    \ 000155 a923                 lda     #35
    \ 000157 831e                 sta     30,s
    \ 000159 c220                 rep     #32
0170                  					pos++;
    \ 00015b a305                 lda     5,s
    \ 00015d 1a                   inc     a
    \ 00015e 8305                 sta     5,s
    \ 000160 a305                 lda     5,s
    \ 000162 8002                 bra     `?L26`
    \ 000164 a305     `?L25`:     lda     5,s
    \ 000166          `?L26`:
0171                  				}
0172                  				c++;
    \ 000166 a307                 lda     7,s
    \ 000168 1a                   inc     a
    \ 000169 8307                 sta     7,s
    \ 00016b a303                 lda     3,s
    \ 00016d 8004                 bra     `?L17`
    \ 00016f a309     `?L16`:     lda     9,s
    \ 000171 8303                 sta     3,s
    \ 000173 a305     `?L17`:     lda     5,s
    \ 000175 8313                 sta     19,s
    \ 000177 a303                 lda     3,s
    \ 000179          `?L11`:
0173                  			}
0174                  			// ---------------
0175                  			// OCTAVE
0176                  			// ---------------
0177                  			if (tune[c] >='0' && tune[c]<='7') 
    \ 000179 a324                 lda     36,s
    \ 00017b a8                   tay
    \ 00017c b307                 lda     (7,s),y
    \ 00017e 22......             jsl     long:`?L294`
    \ 000182 9035                 bcc     `?L28`
    \ 000184 a324                 lda     36,s
    \ 000186 a8                   tay
    \ 000187 a93700               lda     ##55
    \ 00018a e220                 sep     #32
    \ 00018c d307                 cmp     (7,s),y
    \ 00018e c220                 rep     #32
    \ 000190 9027                 bcc     `?L28`
0178                  			{
0179                  			// verify if Octave was provided after note
0180                  				octave = tune[c]-48; // modify current octave number
    \ 000192 a324                 lda     36,s
    \ 000194 a8                   tay
    \ 000195 b307                 lda     (7,s),y
    \ 000197 22......             jsl     long:`?L290`
    \ 00019b 8305                 sta     5,s
0181                  				note[pos]=48+octave-octaveSubs; // get octave & add OctaveSubs just in case!
    \ 00019d a93000               lda     ##48
    \ 0001a0 18                   clc
    \ 0001a1 6305                 adc     5,s
    \ 0001a3 38                   sec
    \ 0001a4 e303                 sbc     3,s
    \ 0001a6 aa                   tax
    \ 0001a7 3b                   tsc
    \ 0001a8 22......             jsl     long:`?L291`
0182                  				c++;
    \ 0001ac a307                 lda     7,s
    \ 0001ae 1a                   inc     a
    \ 0001af 8303                 sta     3,s
    \ 0001b1 a303                 lda     3,s
    \ 0001b3 8307                 sta     7,s
    \ 0001b5 a305                 lda     5,s
    \ 0001b7 8011                 bra     `?L273`
    \ 0001b9          `?L28`:
0183                  			}
0184                  			else
0185                  			{
0186                  				// add Octave to note
0187                  				note[pos]=48+octave-octaveSubs;
    \ 0001b9 a93000               lda     ##48
    \ 0001bc 18                   clc
    \ 0001bd 6319                 adc     25,s
    \ 0001bf 38                   sec
    \ 0001c0 e303                 sbc     3,s
    \ 0001c2 aa                   tax
    \ 0001c3 3b                   tsc
    \ 0001c4 22......             jsl     long:`?L291`
    \ 0001c8 a319                 lda     25,s
    \ 0001ca 8303     `?L273`:    sta     3,s
0188                  			}
0189                  			// ---------------
0190                  			// LENGTH
0191                  			// ---------------
0192                  			switch (tune[c])
    \ 0001cc a9....               lda     ##.word0 `?L188`
    \ 0001cf 85..                 sta     dp:.tiny _Dp
    \ 0001d1 a9....               lda     ##.word2 `?L188`
    \ 0001d4 85..                 sta     dp:.tiny (_Dp+2)
    \ 0001d6 a324                 lda     36,s
    \ 0001d8 a8                   tay
    \ 0001d9 b307                 lda     (7,s),y
    \ 0001db 29ff00               and     ##255
    \ 0001de 22......             jsl     long:_ValueSwitch16
    \ 0001e2          `?L38`:
0193                  			{
0194                  				case 'w': // whole
0195                  					duration=16;
    \ 0001e2 a91000               lda     ##16
    \ 0001e5 8305                 sta     5,s
0196                  					c++;
    \ 0001e7 a307                 lda     7,s
    \ 0001e9 1a                   inc     a
    \ 0001ea 8307                 sta     7,s
0197                  					break;
    \ 0001ec a307                 lda     7,s
    \ 0001ee 8309                 sta     9,s
    \ 0001f0 a305                 lda     5,s
    \ 0001f2 8053                 bra     `?L272`
    \ 0001f4          `?L35`:
0198                  				case 'h': // half
0199                  					duration=8;
0200                  					c++;
0201                  					break;
0202                  				case 'q': // quarter
0203                  					duration=4;
0204                  					c++;
0205                  					break;
0206                  				case 't': // eight
0207                  					duration=2;
    \ 0001f4 a90200               lda     ##2
    \ 0001f7 8305                 sta     5,s
0208                  					c++;
    \ 0001f9 a307                 lda     7,s
    \ 0001fb 1a                   inc     a
    \ 0001fc 8307                 sta     7,s
0209                  					break;
    \ 0001fe a307                 lda     7,s
    \ 000200 8309                 sta     9,s
    \ 000202 a305                 lda     5,s
    \ 000204 8041                 bra     `?L272`
    \ 000206          `?L34`:
0210                  				case 's': // sixteenth
0211                  					duration=1;
    \ 000206 a90100               lda     ##1
    \ 000209 8305                 sta     5,s
0212                  					c++;
    \ 00020b a307                 lda     7,s
    \ 00020d 1a                   inc     a
    \ 00020e 8307                 sta     7,s
0213                  					break;
    \ 000210 a307                 lda     7,s
    \ 000212 8309                 sta     9,s
    \ 000214 a305                 lda     5,s
    \ 000216 802f                 bra     `?L272`
    \ 000218 a90400   `?L36`:     lda     ##4
    \ 00021b 8305                 sta     5,s
    \ 00021d a307                 lda     7,s
    \ 00021f 1a                   inc     a
    \ 000220 8307                 sta     7,s
    \ 000222 a307                 lda     7,s
    \ 000224 8309                 sta     9,s
    \ 000226 a305                 lda     5,s
    \ 000228 801d                 bra     `?L272`
    \ 00022a a90800   `?L37`:     lda     ##8
    \ 00022d 8305                 sta     5,s
    \ 00022f a307                 lda     7,s
    \ 000231 1a                   inc     a
    \ 000232 8307                 sta     7,s
    \ 000234 a307                 lda     7,s
    \ 000236 8309                 sta     9,s
    \ 000238 a305                 lda     5,s
    \ 00023a 800b                 bra     `?L272`
    \ 00023c          `?L33`:
0214                  				default:
0215                  					// if no duration is specified use quarter
0216                  					duration=4;
    \ 00023c a90400               lda     ##4
    \ 00023f 8305                 sta     5,s
    \ 000241 a307                 lda     7,s
    \ 000243 8309                 sta     9,s
    \ 000245 a305                 lda     5,s
    \ 000247 8307     `?L272`:    sta     7,s
0217                  			}
0218                  			// Check for dotted duration
0219                  			if (tune[c]=='.')
    \ 000249 a324                 lda     36,s
    \ 00024b a8                   tay
    \ 00024c b309                 lda     (9,s),y
    \ 00024e e220                 sep     #32
    \ 000250 c92e                 cmp     #46
    \ 000252 c220                 rep     #32
    \ 000254 d01f                 bne     `?L44`
0220                  			{
0221                  				duration+=duration/2;
    \ 000256 a307                 lda     7,s
    \ 000258 08                   php
    \ 000259 78                   sei
    \ 00025a 8d1a01               sta     282
    \ 00025d a90200               lda     ##2
    \ 000260 8d1801               sta     280
    \ 000263 ad1c01               lda     284
    \ 000266 28                   plp
    \ 000267 18                   clc
    \ 000268 6307                 adc     7,s
    \ 00026a 8307                 sta     7,s
0222                  				c++;
    \ 00026c a309                 lda     9,s
    \ 00026e 1a                   inc     a
    \ 00026f 8305                 sta     5,s
    \ 000271 a307                 lda     7,s
    \ 000273 8006                 bra     `?L271`
    \ 000275 a309     `?L44`:     lda     9,s
    \ 000277 8305                 sta     5,s
    \ 000279 a307                 lda     7,s
    \ 00027b 8309     `?L271`:    sta     9,s
    \ 00027d a305                 lda     5,s
    \ 00027f 8317                 sta     23,s
    \ 000281 a313                 lda     19,s
    \ 000283 8307                 sta     7,s
    \ 000285 a303                 lda     3,s
    \ 000287 8305                 sta     5,s
    \ 000289 a30f                 lda     15,s
    \ 00028b 831b                 sta     27,s
    \ 00028d a309                 lda     9,s
    \ 00028f 8319                 sta     25,s
    \ 000291 a30d                 lda     13,s
    \ 000293 8313                 sta     19,s
    \ 000295 a301                 lda     1,s
    \ 000297 830f                 sta     15,s
    \ 000299 a30b                 lda     11,s
    \ 00029b 4c....               jmp     .kbank `?L264`
    \ 00029e          `?L7`:
0223                  			}
0224                  		}
0225                  		else
0226                  		{
0227                  		//--------------------------
0228                  		// OTHER OPTIONS
0229                  		//--------------------------
0230                  			// no note was provided, only parameter changed!
0231                  			note[0]='\0';
    \ 00029e e220                 sep     #32
    \ 0002a0 a900                 lda     #0
    \ 0002a2 831d                 sta     29,s
    \ 0002a4 c220                 rep     #32
0232                  			noteFlag=false;
    \ 0002a6 a90000               lda     ##0
    \ 0002a9 8301                 sta     1,s
0233                  			// Modify Volume
0234                  			if (tune[c]=='V')
    \ 0002ab 22......             jsl     long:`?L289`
    \ 0002af c956                 cmp     #86
    \ 0002b1 c220                 rep     #32
    \ 0002b3 d07b                 bne     `?L47`
0235                  			{
0236                  				modFlag=true;
    \ 0002b5 a90100               lda     ##1
    \ 0002b8 8305                 sta     5,s
0237                  				c++;
    \ 0002ba a317                 lda     23,s
    \ 0002bc 1a                   inc     a
    \ 0002bd 8309                 sta     9,s
0238                  				if (tune[c]>='0' && tune[c]<='9')
    \ 0002bf a324                 lda     36,s
    \ 0002c1 a8                   tay
    \ 0002c2 b309                 lda     (9,s),y
    \ 0002c4 22......             jsl     long:`?L294`
    \ 0002c8 9022                 bcc     `?L50`
    \ 0002ca a324                 lda     36,s
    \ 0002cc a8                   tay
    \ 0002cd a93900               lda     ##57
    \ 0002d0 e220                 sep     #32
    \ 0002d2 d309                 cmp     (9,s),y
    \ 0002d4 c220                 rep     #32
    \ 0002d6 9014                 bcc     `?L50`
0239                  					{
0240                  						volume=tune[c]-48;
    \ 0002d8 a324                 lda     36,s
    \ 0002da a8                   tay
    \ 0002db b309                 lda     (9,s),y
    \ 0002dd 22......             jsl     long:`?L290`
    \ 0002e1 8307                 sta     7,s
0241                  						c++;
    \ 0002e3 a309                 lda     9,s
    \ 0002e5 1a                   inc     a
    \ 0002e6 8309                 sta     9,s
    \ 0002e8 a307                 lda     7,s
    \ 0002ea 8004                 bra     `?L51`
    \ 0002ec a30d     `?L50`:     lda     13,s
    \ 0002ee 8307                 sta     7,s
    \ 0002f0          `?L51`:
0242                  					}
0243                  				if (tune[c]>='a' && tune[c]<='f')
    \ 0002f0 a324                 lda     36,s
    \ 0002f2 a8                   tay
    \ 0002f3 b309                 lda     (9,s),y
    \ 0002f5 e220                 sep     #32
    \ 0002f7 c961                 cmp     #97
    \ 0002f9 c220                 rep     #32
    \ 0002fb 9025                 bcc     `?L53`
    \ 0002fd a324                 lda     36,s
    \ 0002ff a8                   tay
    \ 000300 a96600               lda     ##102
    \ 000303 e220                 sep     #32
    \ 000305 d309                 cmp     (9,s),y
    \ 000307 c220                 rep     #32
    \ 000309 9017                 bcc     `?L53`
0244                  					{	
0245                  						volume=tune[c]-87;
    \ 00030b a324                 lda     36,s
    \ 00030d a8                   tay
    \ 00030e b309                 lda     (9,s),y
    \ 000310 29ff00               and     ##255
    \ 000313 38                   sec
    \ 000314 e95700               sbc     ##87
    \ 000317 8307                 sta     7,s
0246                  						c++;
    \ 000319 a309                 lda     9,s
    \ 00031b 1a                   inc     a
    \ 00031c 8309                 sta     9,s
    \ 00031e a307                 lda     7,s
    \ 000320 8002                 bra     `?L54`
    \ 000322 a307     `?L53`:     lda     7,s
    \ 000324 a309     `?L54`:     lda     9,s
    \ 000326 8317                 sta     23,s
    \ 000328 a307                 lda     7,s
    \ 00032a 8309                 sta     9,s
    \ 00032c a305                 lda     5,s
    \ 00032e 8008                 bra     `?L48`
    \ 000330 a30d     `?L47`:     lda     13,s
    \ 000332 8309                 sta     9,s
    \ 000334 a30b                 lda     11,s
    \ 000336 8305                 sta     5,s
    \ 000338          `?L48`:
0247                  					}
0248                  			}
0249                  			// Modify Octave
0250                  			if (tune[c]=='O')
    \ 000338 a324                 lda     36,s
    \ 00033a a8                   tay
    \ 00033b b317                 lda     (23,s),y
    \ 00033d e220                 sep     #32
    \ 00033f c94f                 cmp     #79
    \ 000341 c220                 rep     #32
    \ 000343 d047                 bne     `?L56`
0251                  			{
0252                  				modFlag=true;
    \ 000345 a90100               lda     ##1
    \ 000348 8305                 sta     5,s
0253                  				c++;
    \ 00034a a317                 lda     23,s
    \ 00034c 1a                   inc     a
    \ 00034d 830b                 sta     11,s
0254                  				if (tune[c]>='0' && tune[c]<='7')
    \ 00034f a324                 lda     36,s
    \ 000351 a8                   tay
    \ 000352 b30b                 lda     (11,s),y
    \ 000354 22......             jsl     long:`?L294`
    \ 000358 9022                 bcc     `?L59`
    \ 00035a a324                 lda     36,s
    \ 00035c a8                   tay
    \ 00035d a93700               lda     ##55
    \ 000360 e220                 sep     #32
    \ 000362 d30b                 cmp     (11,s),y
    \ 000364 c220                 rep     #32
    \ 000366 9014                 bcc     `?L59`
0255                  				{
0256                  					octave=tune[c]-48;
    \ 000368 a324                 lda     36,s
    \ 00036a a8                   tay
    \ 00036b b30b                 lda     (11,s),y
    \ 00036d 22......             jsl     long:`?L290`
    \ 000371 8307                 sta     7,s
0257                  					c++;
    \ 000373 a30b                 lda     11,s
    \ 000375 1a                   inc     a
    \ 000376 830b                 sta     11,s
    \ 000378 a307                 lda     7,s
    \ 00037a 8004                 bra     `?L60`
    \ 00037c a319     `?L59`:     lda     25,s
    \ 00037e 8307                 sta     7,s
    \ 000380 a30b     `?L60`:     lda     11,s
    \ 000382 830d                 sta     13,s
    \ 000384 a307                 lda     7,s
    \ 000386 830b                 sta     11,s
    \ 000388 a305                 lda     5,s
    \ 00038a 800a                 bra     `?L57`
    \ 00038c a317     `?L56`:     lda     23,s
    \ 00038e 830d                 sta     13,s
    \ 000390 a319                 lda     25,s
    \ 000392 830b                 sta     11,s
    \ 000394 a305                 lda     5,s
    \ 000396          `?L57`:
0258                  				}
0259                  			}
0260                  			// Modify Instrument
0261                  			if (tune[c]=='I')
    \ 000396 a324                 lda     36,s
    \ 000398 a8                   tay
    \ 000399 b30d                 lda     (13,s),y
    \ 00039b e220                 sep     #32
    \ 00039d c949                 cmp     #73
    \ 00039f c220                 rep     #32
    \ 0003a1 f003                 beq     `?L341`
    \ 0003a3 4c....               jmp     .kbank `?L62`
    \ 0003a6          `?L341`:
0262                  			{
0263                  				modFlag=true;
    \ 0003a6 a90100               lda     ##1
    \ 0003a9 8305                 sta     5,s
0264                  				c++;
    \ 0003ab a30d                 lda     13,s
    \ 0003ad 1a                   inc     a
    \ 0003ae 830d                 sta     13,s
0265                  				if (tune[c]>='0' && tune[c]<='9')
    \ 0003b0 a324                 lda     36,s
    \ 0003b2 a8                   tay
    \ 0003b3 b30d                 lda     (13,s),y
    \ 0003b5 22......             jsl     long:`?L294`
    \ 0003b9 9022                 bcc     `?L65`
    \ 0003bb a324                 lda     36,s
    \ 0003bd a8                   tay
    \ 0003be a93900               lda     ##57
    \ 0003c1 e220                 sep     #32
    \ 0003c3 d30d                 cmp     (13,s),y
    \ 0003c5 c220                 rep     #32
    \ 0003c7 9014                 bcc     `?L65`
0266                  				{
0267                  					instrument=tune[c]-48;
    \ 0003c9 a324                 lda     36,s
    \ 0003cb a8                   tay
    \ 0003cc b30d                 lda     (13,s),y
    \ 0003ce 22......             jsl     long:`?L290`
    \ 0003d2 8307                 sta     7,s
0268                  					c++;
    \ 0003d4 a30d                 lda     13,s
    \ 0003d6 1a                   inc     a
    \ 0003d7 830d                 sta     13,s
    \ 0003d9 a307                 lda     7,s
    \ 0003db 8004                 bra     `?L66`
    \ 0003dd a30f     `?L65`:     lda     15,s
    \ 0003df 8307                 sta     7,s
    \ 0003e1          `?L66`:
0269                  				}
0270                  				if (tune[c]>='a' && tune[c]<='f')
    \ 0003e1 a324                 lda     36,s
    \ 0003e3 a8                   tay
    \ 0003e4 b30d                 lda     (13,s),y
    \ 0003e6 e220                 sep     #32
    \ 0003e8 c961                 cmp     #97
    \ 0003ea c220                 rep     #32
    \ 0003ec 9029                 bcc     `?L68`
    \ 0003ee a324                 lda     36,s
    \ 0003f0 a8                   tay
    \ 0003f1 a96600               lda     ##102
    \ 0003f4 e220                 sep     #32
    \ 0003f6 d30d                 cmp     (13,s),y
    \ 0003f8 c220                 rep     #32
    \ 0003fa 901b                 bcc     `?L68`
0271                  				{
0272                  					instrument=tune[c]-87;
    \ 0003fc a324                 lda     36,s
    \ 0003fe a8                   tay
    \ 0003ff b30d                 lda     (13,s),y
    \ 000401 29ff00               and     ##255
    \ 000404 38                   sec
    \ 000405 e95700               sbc     ##87
    \ 000408 8307                 sta     7,s
0273                  					c++;
    \ 00040a a30d                 lda     13,s
    \ 00040c 1a                   inc     a
    \ 00040d 830d                 sta     13,s
    \ 00040f a30d                 lda     13,s
    \ 000411 830f                 sta     15,s
    \ 000413 a307                 lda     7,s
    \ 000415 8006                 bra     `?L268`
    \ 000417 a30d     `?L68`:     lda     13,s
    \ 000419 830f                 sta     15,s
    \ 00041b a307                 lda     7,s
    \ 00041d 830d     `?L268`:    sta     13,s
    \ 00041f a30f                 lda     15,s
    \ 000421 8307                 sta     7,s
    \ 000423 a30d                 lda     13,s
    \ 000425 830f                 sta     15,s
    \ 000427 a305                 lda     5,s
    \ 000429 8006                 bra     `?L269`
    \ 00042b a30d     `?L62`:     lda     13,s
    \ 00042d 8307                 sta     7,s
    \ 00042f a305                 lda     5,s
    \ 000431 830d     `?L269`:    sta     13,s
    \ 000433 a307                 lda     7,s
    \ 000435 8317                 sta     23,s
    \ 000437 a313                 lda     19,s
    \ 000439 8307                 sta     7,s
    \ 00043b a30b                 lda     11,s
    \ 00043d 8305                 sta     5,s
    \ 00043f a30f                 lda     15,s
    \ 000441 831b                 sta     27,s
    \ 000443 a303                 lda     3,s
    \ 000445 8319                 sta     25,s
    \ 000447 a309                 lda     9,s
    \ 000449 8313                 sta     19,s
    \ 00044b a301                 lda     1,s
    \ 00044d 830f                 sta     15,s
    \ 00044f a30d                 lda     13,s
    \ 000451 8301     `?L264`:    sta     1,s
0274                  				}
0275                  			}
0276                  		}
0277                  			note[++pos]='\0';
    \ 000453 a307                 lda     7,s
    \ 000455 1a                   inc     a
    \ 000456 8303                 sta     3,s
    \ 000458 3b                   tsc
    \ 000459 18                   clc
    \ 00045a 691d00               adc     ##29
    \ 00045d a8                   tay
    \ 00045e e220                 sep     #32
    \ 000460 a900                 lda     #0
    \ 000462 9303                 sta     (3,s),y
    \ 000464 c220                 rep     #32
0278                  		//-------------------------------
0279                  		// Output Note in Track notation
0280                  		//-------------------------------
0281                  		if (noteFlag==true)
    \ 000466 a30f                 lda     15,s
    \ 000468 c90100               cmp     ##1
    \ 00046b f003                 beq     `?L342`
    \ 00046d 4c....               jmp     .kbank `?L71`
    \ 000470          `?L342`:
0282                  		{	
0283                  			t++;
    \ 000470 a315                 lda     21,s
    \ 000472 1a                   inc     a
    \ 000473 830d                 sta     13,s
0284                  			
0285                  			// Calculate normal, legatto or staccato duration of note 
0286                  			lengthNote=SID_envelope[instrument-1][6];
    \ 000475 a31b                 lda     27,s
    \ 000477 3a                   dec     a
    \ 000478 0a                   asl     a
    \ 000479 0a                   asl     a
    \ 00047a 0a                   asl     a
    \ 00047b 0a                   asl     a
    \ 00047c 18                   clc
    \ 00047d 69....               adc     ##SID_envelope
    \ 000480 aa                   tax
    \ 000481 bd0c00               lda     12,x
    \ 000484 8303                 sta     3,s
0287                  			gateOff= (int) (duration*noteLen[lengthNote-1]);
    \ 000486 a319                 lda     25,s
    \ 000488 a20000               ldx     ##0
    \ 00048b a8                   tay
    \ 00048c 1001                 bpl     `?L208`
    \ 00048e ca                   dex
    \ 00048f          `?L208`:
    \ 00048f 22......             jsl     long:_SInt32ToFloat32
    \ 000493 da                   phx
    \ 000494 48                   pha
    \ 000495 a307                 lda     7,s
    \ 000497 3a                   dec     a
    \ 000498 0a                   asl     a
    \ 000499 0a                   asl     a
    \ 00049a aa                   tax
    \ 00049b bc....               ldy     noteLen+2,x
    \ 00049e 84..                 sty     dp:.tiny (_Dp+2)
    \ 0004a0 bc....               ldy     noteLen,x
    \ 0004a3 84..                 sty     dp:.tiny _Dp
    \ 0004a5 68                   pla
    \ 0004a6 fa                   plx
    \ 0004a7 22......             jsl     long:_Float32Mul
    \ 0004ab 22......             jsl     long:_Float32ToSInt32
    \ 0004af 8303                 sta     3,s
0288                  			if (gateOff<=1)
    \ 0004b1 a90100               lda     ##1
    \ 0004b4 38                   sec
    \ 0004b5 e303                 sbc     3,s
    \ 0004b7 5003                 bvc     `?L213`
    \ 0004b9 490080               eor     ##-32768
    \ 0004bc 3009     `?L213`:    bmi     `?L74`
0289                  				gateOff=2; // if gateoff is calculated on the same 1/16th period as gateon we won't use parameter.
    \ 0004be a90200               lda     ##2
    \ 0004c1 8303                 sta     3,s
    \ 0004c3 8303                 sta     3,s
    \ 0004c5 8002                 bra     `?L75`
    \ 0004c7 a303     `?L74`:     lda     3,s
    \ 0004c9          `?L75`:
0290                  			//printf("Duration:%d lengthNote:%d factor:%f calc:%d GateOff: %d\r",duration,lengthNote,noteLen[lengthNote-1],(int) (duration*noteLen[lengthNote-1]),gateOff);
0291                  			
0292                  			index=0;
    \ 0004c9 a90000               lda     ##0
    \ 0004cc 8307                 sta     7,s
0293                  			if (note[0]=='R') // Rest
    \ 0004ce a31d                 lda     29,s
    \ 0004d0 e220                 sep     #32
    \ 0004d2 c952                 cmp     #82
    \ 0004d4 c220                 rep     #32
    \ 0004d6 f003                 beq     `?L343`
    \ 0004d8 4c....               jmp     .kbank `?L77`
    \ 0004db          `?L343`:
0294                  			{
0295                  				Tracker[t][(trackNumber*3)]=100;
    \ 0004db a322                 lda     34,s
    \ 0004dd 8307                 sta     7,s
    \ 0004df 8303                 sta     3,s
    \ 0004e1 a307                 lda     7,s
    \ 0004e3 0a                   asl     a
    \ 0004e4 8307                 sta     7,s
    \ 0004e6 18                   clc
    \ 0004e7 6303                 adc     3,s
    \ 0004e9 8303                 sta     3,s
    \ 0004eb a32a                 lda     42,s
    \ 0004ed 08                   php
    \ 0004ee 78                   sei
    \ 0004ef 8d0201               sta     258
    \ 0004f2 a30e                 lda     14,s
    \ 0004f4 8d0001               sta     256
    \ 0004f7 ad0401               lda     260
    \ 0004fa 28                   plp
0296                  				Tracker[t][(trackNumber*3)+1]=volume;
0297                  				Tracker[t][(trackNumber*3)+2]=instrument;
0298                  				while (--duration>0)
    \ 0004fb 22......             jsl     long:`?L292`
    \ 0004ff a964                 lda     #100
    \ 000501 9303                 sta     (3,s),y
    \ 000503 c220                 rep     #32
    \ 000505 a322                 lda     34,s
    \ 000507 8307                 sta     7,s
    \ 000509 8303                 sta     3,s
    \ 00050b a307                 lda     7,s
    \ 00050d 0a                   asl     a
    \ 00050e 8307                 sta     7,s
    \ 000510 18                   clc
    \ 000511 6303                 adc     3,s
    \ 000513 8303                 sta     3,s
    \ 000515 a32a                 lda     42,s
    \ 000517 08                   php
    \ 000518 78                   sei
    \ 000519 8d0201               sta     258
    \ 00051c a30e                 lda     14,s
    \ 00051e 8d0001               sta     256
    \ 000521 ad0401               lda     260
    \ 000524 28                   plp
    \ 000525 18                   clc
    \ 000526 632c                 adc     44,s
    \ 000528 85..                 sta     dp:.tiny _Dp
    \ 00052a a303                 lda     3,s
    \ 00052c 22......             jsl     long:`?L283`
    \ 000530 8307                 sta     7,s
    \ 000532 8303                 sta     3,s
    \ 000534 a307                 lda     7,s
    \ 000536 0a                   asl     a
    \ 000537 8307                 sta     7,s
    \ 000539 18                   clc
    \ 00053a 6303                 adc     3,s
    \ 00053c 8303                 sta     3,s
    \ 00053e a32a                 lda     42,s
    \ 000540 08                   php
    \ 000541 78                   sei
    \ 000542 8d0201               sta     258
    \ 000545 a30e                 lda     14,s
    \ 000547 8d0001               sta     256
    \ 00054a ad0401               lda     260
    \ 00054d 28                   plp
    \ 00054e 18                   clc
    \ 00054f 632c                 adc     44,s
    \ 000551 85..                 sta     dp:.tiny _Dp
    \ 000553 a303                 lda     3,s
    \ 000555 1a                   inc     a
    \ 000556 22......             jsl     long:`?L288`
    \ 00055a 8307                 sta     7,s
    \ 00055c a319                 lda     25,s
    \ 00055e          `?L266`:
0299                  				{
    \ 00055e 8303                 sta     3,s
    \ 000560 a303                 lda     3,s
    \ 000562 3a                   dec     a
    \ 000563 8309                 sta     9,s
    \ 000565 a90000               lda     ##0
    \ 000568 38                   sec
    \ 000569 e309                 sbc     9,s
    \ 00056b 5003                 bvc     `?L215`
    \ 00056d 490080               eor     ##-32768
    \ 000570 3003     `?L215`:    bmi     `?L344`
    \ 000572 4c....               jmp     .kbank `?L81`
    \ 000575          `?L344`:
0300                  					t+=1;
    \ 000575 a307                 lda     7,s
    \ 000577 1a                   inc     a
    \ 000578 830b                 sta     11,s
0301                  					Tracker[t][(trackNumber*3)]=0;
    \ 00057a a322                 lda     34,s
    \ 00057c 8307                 sta     7,s
    \ 00057e 8303                 sta     3,s
    \ 000580 a307                 lda     7,s
    \ 000582 0a                   asl     a
    \ 000583 8307                 sta     7,s
    \ 000585 18                   clc
    \ 000586 6303                 adc     3,s
    \ 000588 8303                 sta     3,s
    \ 00058a a32a                 lda     42,s
    \ 00058c 08                   php
    \ 00058d 78                   sei
    \ 00058e 8d0201               sta     258
    \ 000591 a30c                 lda     12,s
    \ 000593 8d0001               sta     256
    \ 000596 ad0401               lda     260
    \ 000599 28                   plp
    \ 00059a 22......             jsl     long:`?L292`
    \ 00059e a900                 lda     #0
    \ 0005a0 9303                 sta     (3,s),y
    \ 0005a2 c220                 rep     #32
0302                  					Tracker[t][(trackNumber*3)+1]=0;
    \ 0005a4 a322                 lda     34,s
    \ 0005a6 8307                 sta     7,s
    \ 0005a8 8303                 sta     3,s
    \ 0005aa a307                 lda     7,s
    \ 0005ac 0a                   asl     a
    \ 0005ad 8307                 sta     7,s
    \ 0005af 18                   clc
    \ 0005b0 6303                 adc     3,s
    \ 0005b2 8303                 sta     3,s
    \ 0005b4 a32a                 lda     42,s
    \ 0005b6 08                   php
    \ 0005b7 78                   sei
    \ 0005b8 8d0201               sta     258
    \ 0005bb a30c                 lda     12,s
    \ 0005bd 8d0001               sta     256
    \ 0005c0 ad0401               lda     260
    \ 0005c3 28                   plp
    \ 0005c4 18                   clc
    \ 0005c5 632c                 adc     44,s
    \ 0005c7 85..                 sta     dp:.tiny _Dp
    \ 0005c9 a303                 lda     3,s
    \ 0005cb 22......             jsl     long:`?L286`
0303                  					Tracker[t][(trackNumber*3)+2]=0;
    \ 0005cf a322                 lda     34,s
    \ 0005d1 8307                 sta     7,s
    \ 0005d3 8303                 sta     3,s
    \ 0005d5 a307                 lda     7,s
    \ 0005d7 0a                   asl     a
    \ 0005d8 8307                 sta     7,s
    \ 0005da 18                   clc
    \ 0005db 6303                 adc     3,s
    \ 0005dd 8303                 sta     3,s
    \ 0005df a32a                 lda     42,s
    \ 0005e1 08                   php
    \ 0005e2 78                   sei
    \ 0005e3 8d0201               sta     258
    \ 0005e6 a30c                 lda     12,s
    \ 0005e8 8d0001               sta     256
    \ 0005eb ad0401               lda     260
    \ 0005ee 28                   plp
    \ 0005ef 18                   clc
    \ 0005f0 632c                 adc     44,s
    \ 0005f2 85..                 sta     dp:.tiny _Dp
    \ 0005f4 a303                 lda     3,s
    \ 0005f6 1a                   inc     a
    \ 0005f7 22......             jsl     long:`?L286`
    \ 0005fb a30b                 lda     11,s
    \ 0005fd 8307                 sta     7,s
    \ 0005ff a309                 lda     9,s
    \ 000601 4c....               jmp     .kbank `?L266`
    \ 000604 a309     `?L81`:     lda     9,s
    \ 000606 4c....               jmp     .kbank `?L267`
    \ 000609          `?L77`:
0304                  				}
0305                  			}
0306                  			else 
0307                  			{ 
0308                  				// search for Note
0309                  				while (index<=96)
    \ 000609 a307                 lda     7,s
    \ 00060b          `?L265`:
0310                  				{
    \ 00060b 830b                 sta     11,s
    \ 00060d a96000               lda     ##96
    \ 000610 38                   sec
    \ 000611 e30b                 sbc     11,s
    \ 000613 5003                 bvc     `?L217`
    \ 000615 490080               eor     ##-32768
    \ 000618 3020     `?L217`:    bmi     `?L84`
0311                  					if (strcmp(note,notes[index])==0)
    \ 00061a a30b                 lda     11,s
    \ 00061c 0a                   asl     a
    \ 00061d 0a                   asl     a
    \ 00061e 18                   clc
    \ 00061f 69....               adc     ##notes
    \ 000622 85..                 sta     dp:.tiny _Dp
    \ 000624 3b                   tsc
    \ 000625 18                   clc
    \ 000626 691d00               adc     ##29
    \ 000629 22......             jsl     long:strcmp
    \ 00062d 1a                   inc     a
    \ 00062e 3a                   dec     a
    \ 00062f f009                 beq     `?L84`
0312                  						break;
0313                  					index++;
    \ 000631 a30b                 lda     11,s
    \ 000633 1a                   inc     a
    \ 000634 8307                 sta     7,s
    \ 000636 a307                 lda     7,s
    \ 000638 80d1                 bra     `?L265`
    \ 00063a          `?L84`:
0314                  				}
0315                  				Tracker[t][(trackNumber*3)]=index;
    \ 00063a a322                 lda     34,s
    \ 00063c 8309                 sta     9,s
    \ 00063e 8307                 sta     7,s
    \ 000640 a309                 lda     9,s
    \ 000642 0a                   asl     a
    \ 000643 8309                 sta     9,s
    \ 000645 18                   clc
    \ 000646 6307                 adc     7,s
    \ 000648 8307                 sta     7,s
    \ 00064a a32a                 lda     42,s
    \ 00064c 08                   php
    \ 00064d 78                   sei
    \ 00064e 8d0201               sta     258
    \ 000651 a30e                 lda     14,s
    \ 000653 8d0001               sta     256
    \ 000656 ad0401               lda     260
    \ 000659 28                   plp
0316                  				Tracker[t][(trackNumber*3)+1]=volume;
0317                  				Tracker[t][(trackNumber*3)+2]=instrument;
0318                  				
0319                  				while (--duration>0)
    \ 00065a 22......             jsl     long:`?L292`
    \ 00065e a30b                 lda     11,s
    \ 000660 9307                 sta     (7,s),y
    \ 000662 c220                 rep     #32
    \ 000664 a322                 lda     34,s
    \ 000666 8309                 sta     9,s
    \ 000668 8307                 sta     7,s
    \ 00066a a309                 lda     9,s
    \ 00066c 0a                   asl     a
    \ 00066d 8309                 sta     9,s
    \ 00066f 18                   clc
    \ 000670 6307                 adc     7,s
    \ 000672 8307                 sta     7,s
    \ 000674 a32a                 lda     42,s
    \ 000676 08                   php
    \ 000677 78                   sei
    \ 000678 8d0201               sta     258
    \ 00067b a30e                 lda     14,s
    \ 00067d 8d0001               sta     256
    \ 000680 ad0401               lda     260
    \ 000683 28                   plp
    \ 000684 18                   clc
    \ 000685 632c                 adc     44,s
    \ 000687 85..                 sta     dp:.tiny _Dp
    \ 000689 a307                 lda     7,s
    \ 00068b 22......             jsl     long:`?L283`
    \ 00068f 8309                 sta     9,s
    \ 000691 8307                 sta     7,s
    \ 000693 a309                 lda     9,s
    \ 000695 0a                   asl     a
    \ 000696 8309                 sta     9,s
    \ 000698 18                   clc
    \ 000699 6307                 adc     7,s
    \ 00069b 8307                 sta     7,s
    \ 00069d a32a                 lda     42,s
    \ 00069f 08                   php
    \ 0006a0 78                   sei
    \ 0006a1 8d0201               sta     258
    \ 0006a4 a30e                 lda     14,s
    \ 0006a6 8d0001               sta     256
    \ 0006a9 ad0401               lda     260
    \ 0006ac 28                   plp
    \ 0006ad 18                   clc
    \ 0006ae 632c                 adc     44,s
    \ 0006b0 85..                 sta     dp:.tiny _Dp
    \ 0006b2 a307                 lda     7,s
    \ 0006b4 1a                   inc     a
    \ 0006b5 22......             jsl     long:`?L288`
    \ 0006b9 8309                 sta     9,s
    \ 0006bb a319                 lda     25,s
    \ 0006bd          `?L263`:
0320                  				{
    \ 0006bd 8307                 sta     7,s
    \ 0006bf a307                 lda     7,s
    \ 0006c1 3a                   dec     a
    \ 0006c2 830b                 sta     11,s
    \ 0006c4 a90000               lda     ##0
    \ 0006c7 38                   sec
    \ 0006c8 e30b                 sbc     11,s
    \ 0006ca 5003                 bvc     `?L220`
    \ 0006cc 490080               eor     ##-32768
    \ 0006cf 3003     `?L220`:    bmi     `?L345`
    \ 0006d1 4c....               jmp     .kbank `?L91`
    \ 0006d4          `?L345`:
0321                  					t+=1;
    \ 0006d4 a309                 lda     9,s
    \ 0006d6 1a                   inc     a
    \ 0006d7 830d                 sta     13,s
0322                  					if (gateOff==duration)
    \ 0006d9 a30b                 lda     11,s
    \ 0006db c303                 cmp     3,s
    \ 0006dd f003                 beq     `?L346`
    \ 0006df 4c....               jmp     .kbank `?L93`
    \ 0006e2          `?L346`:
0323                  					{
0324                  						Tracker[t][(trackNumber*3)]=101;
    \ 0006e2 a322                 lda     34,s
    \ 0006e4 8309                 sta     9,s
    \ 0006e6 8307                 sta     7,s
    \ 0006e8 a309                 lda     9,s
    \ 0006ea 0a                   asl     a
    \ 0006eb 8309                 sta     9,s
    \ 0006ed 18                   clc
    \ 0006ee 6307                 adc     7,s
    \ 0006f0 8307                 sta     7,s
    \ 0006f2 a32a                 lda     42,s
    \ 0006f4 08                   php
    \ 0006f5 78                   sei
    \ 0006f6 8d0201               sta     258
    \ 0006f9 a30e                 lda     14,s
    \ 0006fb 8d0001               sta     256
    \ 0006fe ad0401               lda     260
    \ 000701 28                   plp
0325                  						Tracker[t][(trackNumber*3)+1]=volume;
0326                  						Tracker[t][(trackNumber*3)+2]=instrument;
    \ 000702 22......             jsl     long:`?L292`
    \ 000706 a965                 lda     #101
    \ 000708 9307                 sta     (7,s),y
    \ 00070a c220                 rep     #32
    \ 00070c a322                 lda     34,s
    \ 00070e 8309                 sta     9,s
    \ 000710 8307                 sta     7,s
    \ 000712 a309                 lda     9,s
    \ 000714 0a                   asl     a
    \ 000715 8309                 sta     9,s
    \ 000717 18                   clc
    \ 000718 6307                 adc     7,s
    \ 00071a 8307                 sta     7,s
    \ 00071c a32a                 lda     42,s
    \ 00071e 08                   php
    \ 00071f 78                   sei
    \ 000720 8d0201               sta     258
    \ 000723 a30e                 lda     14,s
    \ 000725 8d0001               sta     256
    \ 000728 ad0401               lda     260
    \ 00072b 28                   plp
    \ 00072c 18                   clc
    \ 00072d 632c                 adc     44,s
    \ 00072f 85..                 sta     dp:.tiny _Dp
    \ 000731 a307                 lda     7,s
    \ 000733 22......             jsl     long:`?L283`
    \ 000737 8309                 sta     9,s
    \ 000739 8307                 sta     7,s
    \ 00073b a309                 lda     9,s
    \ 00073d 0a                   asl     a
    \ 00073e 8309                 sta     9,s
    \ 000740 18                   clc
    \ 000741 6307                 adc     7,s
    \ 000743 8307                 sta     7,s
    \ 000745 a32a                 lda     42,s
    \ 000747 08                   php
    \ 000748 78                   sei
    \ 000749 8d0201               sta     258
    \ 00074c a30e                 lda     14,s
    \ 00074e 8d0001               sta     256
    \ 000751 ad0401               lda     260
    \ 000754 28                   plp
    \ 000755 18                   clc
    \ 000756 632c                 adc     44,s
    \ 000758 85..                 sta     dp:.tiny _Dp
    \ 00075a a307                 lda     7,s
    \ 00075c 1a                   inc     a
    \ 00075d 1a                   inc     a
    \ 00075e 18                   clc
    \ 00075f 65..                 adc     dp:.tiny _Dp
    \ 000761 aa                   tax
    \ 000762 a31b                 lda     27,s
    \ 000764 e220                 sep     #32
    \ 000766 4c....               jmp     .kbank `?L262`
    \ 000769          `?L93`:
0327                  					}
0328                  					else
0329                  					{
0330                  						Tracker[t][(trackNumber*3)]=0;
    \ 000769 a322                 lda     34,s
    \ 00076b 8309                 sta     9,s
    \ 00076d 8307                 sta     7,s
    \ 00076f a309                 lda     9,s
    \ 000771 0a                   asl     a
    \ 000772 8309                 sta     9,s
    \ 000774 18                   clc
    \ 000775 6307                 adc     7,s
    \ 000777 8307                 sta     7,s
    \ 000779 a32a                 lda     42,s
    \ 00077b 08                   php
    \ 00077c 78                   sei
    \ 00077d 8d0201               sta     258
    \ 000780 a30e                 lda     14,s
    \ 000782 8d0001               sta     256
    \ 000785 ad0401               lda     260
    \ 000788 28                   plp
0331                  						Tracker[t][(trackNumber*3)+1]=0;
0332                  						Tracker[t][(trackNumber*3)+2]=0;
    \ 000789 22......             jsl     long:`?L292`
    \ 00078d a900                 lda     #0
    \ 00078f 9307                 sta     (7,s),y
    \ 000791 c220                 rep     #32
    \ 000793 a322                 lda     34,s
    \ 000795 8309                 sta     9,s
    \ 000797 8307                 sta     7,s
    \ 000799 a309                 lda     9,s
    \ 00079b 0a                   asl     a
    \ 00079c 8309                 sta     9,s
    \ 00079e 18                   clc
    \ 00079f 6307                 adc     7,s
    \ 0007a1 8307                 sta     7,s
    \ 0007a3 a32a                 lda     42,s
    \ 0007a5 08                   php
    \ 0007a6 78                   sei
    \ 0007a7 8d0201               sta     258
    \ 0007aa a30e                 lda     14,s
    \ 0007ac 8d0001               sta     256
    \ 0007af ad0401               lda     260
    \ 0007b2 28                   plp
    \ 0007b3 18                   clc
    \ 0007b4 632c                 adc     44,s
    \ 0007b6 85..                 sta     dp:.tiny _Dp
    \ 0007b8 a307                 lda     7,s
    \ 0007ba 22......             jsl     long:`?L286`
    \ 0007be a322                 lda     34,s
    \ 0007c0 8309                 sta     9,s
    \ 0007c2 8307                 sta     7,s
    \ 0007c4 a309                 lda     9,s
    \ 0007c6 0a                   asl     a
    \ 0007c7 8309                 sta     9,s
    \ 0007c9 18                   clc
    \ 0007ca 6307                 adc     7,s
    \ 0007cc 8307                 sta     7,s
    \ 0007ce a32a                 lda     42,s
    \ 0007d0 08                   php
    \ 0007d1 78                   sei
    \ 0007d2 8d0201               sta     258
    \ 0007d5 a30e                 lda     14,s
    \ 0007d7 8d0001               sta     256
    \ 0007da ad0401               lda     260
    \ 0007dd 28                   plp
    \ 0007de 18                   clc
    \ 0007df 632c                 adc     44,s
    \ 0007e1 85..                 sta     dp:.tiny _Dp
    \ 0007e3 a307                 lda     7,s
    \ 0007e5 1a                   inc     a
    \ 0007e6 1a                   inc     a
    \ 0007e7 18                   clc
    \ 0007e8 65..                 adc     dp:.tiny _Dp
    \ 0007ea aa                   tax
    \ 0007eb e220                 sep     #32
    \ 0007ed a900                 lda     #0
    \ 0007ef 9d0000   `?L262`:    sta     0,x
    \ 0007f2 c220                 rep     #32
    \ 0007f4 a30d                 lda     13,s
    \ 0007f6 8309                 sta     9,s
    \ 0007f8 a30b                 lda     11,s
    \ 0007fa 4c....               jmp     .kbank `?L263`
    \ 0007fd a309     `?L91`:     lda     9,s
    \ 0007ff 8307                 sta     7,s
    \ 000801 a30b                 lda     11,s
    \ 000803 8303     `?L267`:    sta     3,s
    \ 000805 a303                 lda     3,s
    \ 000807 8008                 bra     `?L72`
    \ 000809 a315     `?L71`:     lda     21,s
    \ 00080b 8307                 sta     7,s
    \ 00080d a319                 lda     25,s
    \ 00080f 8303                 sta     3,s
    \ 000811          `?L72`:
0333                  					}
0334                  				}
0335                  			}
0336                  		}
0337                  		// Check for Errors on Song string
0338                  		if (noteFlag==false && modFlag==false && c!=tuneSize)
    \ 000811 a30f                 lda     15,s
    \ 000813 d049                 bne     `?L97`
    \ 000815 a301                 lda     1,s
    \ 000817 d045                 bne     `?L97`
    \ 000819 a311                 lda     17,s
    \ 00081b c317                 cmp     23,s
    \ 00081d f03f                 beq     `?L97`
0339                  		{
0340                  			// invalid character
0341                  			for (index=0;index<=c;index++)
    \ 00081f a90000               lda     ##0
    \ 000822 8301                 sta     1,s
    \ 000824 8309     `?L275`:    sta     9,s
    \ 000826 a317                 lda     23,s
    \ 000828 38                   sec
    \ 000829 e309                 sbc     9,s
    \ 00082b 5003                 bvc     `?L222`
    \ 00082d 490080               eor     ##-32768
    \ 000830 1010     `?L222`:    bpl     `?L99`
0342                  				printf("%c",tune[index]);
0343                  			printf ("<- Unexpected character\r");
    \ 000832 a9....               lda     ##`_StringLiteral_[60,45,32,85,110,101,120,112,101,99,116,101,100,32,99,104,97,114,97,99,116,101,114,13]`
    \ 000835 22......             jsl     long:printf
0344                  			exit(-1);
    \ 000839 a9ffff               lda     ##-1
    \ 00083c 22......             jsl     long:exit
    \ 000840 801c                 bra     `?L97`
    \ 000842 a324     `?L99`:     lda     36,s
    \ 000844 a8                   tay
    \ 000845 b309                 lda     (9,s),y
    \ 000847 29ff00               and     ##255
    \ 00084a 48                   pha
    \ 00084b a9....               lda     ##`_StringLiteral_%c`
    \ 00084e 22......             jsl     long:printf
    \ 000852 8303                 sta     3,s
    \ 000854 68                   pla
    \ 000855 a309                 lda     9,s
    \ 000857 1a                   inc     a
    \ 000858 8301                 sta     1,s
    \ 00085a a301                 lda     1,s
    \ 00085c 80c6                 bra     `?L275`
    \ 00085e a307     `?L97`:     lda     7,s
    \ 000860 8315                 sta     21,s
    \ 000862 a305                 lda     5,s
    \ 000864 8319                 sta     25,s
    \ 000866 a31b                 lda     27,s
    \ 000868 830f                 sta     15,s
    \ 00086a a313                 lda     19,s
    \ 00086c 4c....               jmp     .kbank `?L270`
    \ 00086f          `?L5`:
0345                  		}
0346                  	}
0347                  	return t;
    \ 00086f a315                 lda     21,s
0348                  }
    \ 000871 a8                   tay
    \ 000872 3b                   tsc
    \ 000873 18                   clc
    \ 000874 692600               adc     ##38
    \ 000877 1b                   tcs
    \ 000878 98                   tya
    \ 000879 6b                   rtl
0349                  
0350                  // Clean Track Memory
0351                  void cleanTracks(int rows,int cols,unsigned char (*Tracker)[cols])
0352                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public cleanTracks
    \ 000000          cleanTracks:
    \ 000000 5a                   phy
    \ 000001 5a                   phy
    \ 000002 5a                   phy
    \ 000003 5a                   phy
    \ 000004 8301                 sta     1,s
    \ 000006 a5..                 lda     dp:.tiny _Dp
    \ 000008 8305                 sta     5,s
0353                  	int i,j;
0354                  	for (i=0;i<rows;i++)
    \ 00000a a90000               lda     ##0
    \ 00000d 8307     `?L276`:    sta     7,s
    \ 00000f a307                 lda     7,s
    \ 000011 38                   sec
    \ 000012 e301                 sbc     1,s
    \ 000014 5003                 bvc     `?L227`
    \ 000016 490080               eor     ##-32768
    \ 000019 3005     `?L227`:    bmi     `?L107`
0355                  		for (j=0;j<cols;j++)
0356                  			Tracker[i][j]=0;
0357                  }
    \ 00001b 7a                   ply
    \ 00001c 7a                   ply
    \ 00001d 7a                   ply
    \ 00001e 7a                   ply
    \ 00001f 6b                   rtl
    \ 000020 a90000   `?L107`:    lda     ##0
    \ 000023 8303                 sta     3,s
    \ 000025 a303     `?L112`:    lda     3,s
    \ 000027 38                   sec
    \ 000028 e305                 sbc     5,s
    \ 00002a 5003                 bvc     `?L229`
    \ 00002c 490080               eor     ##-32768
    \ 00002f 3009     `?L229`:    bmi     `?L111`
    \ 000031 a307                 lda     7,s
    \ 000033 1a                   inc     a
    \ 000034 8303                 sta     3,s
    \ 000036 a303                 lda     3,s
    \ 000038 80d3                 bra     `?L276`
    \ 00003a a305     `?L111`:    lda     5,s
    \ 00003c 08                   php
    \ 00003d 78                   sei
    \ 00003e 8d0201               sta     258
    \ 000041 a308                 lda     8,s
    \ 000043 8d0001               sta     256
    \ 000046 ad0401               lda     260
    \ 000049 28                   plp
    \ 00004a 18                   clc
    \ 00004b 65..                 adc     dp:.tiny (_Dp+2)
    \ 00004d a8                   tay
    \ 00004e e220                 sep     #32
    \ 000050 a900                 lda     #0
    \ 000052 9303                 sta     (3,s),y
    \ 000054 c220                 rep     #32
    \ 000056 a303                 lda     3,s
    \ 000058 1a                   inc     a
    \ 000059 8303                 sta     3,s
    \ 00005b 80c8                 bra     `?L112`
0358                  
0359                  // Print Track Memory
0360                  void showTracks(int rows,int cols, unsigned char (*Tracker)[cols])
0361                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public showTracks
    \ 000000          showTracks:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 a8                   tay
    \ 000003 3b                   tsc
    \ 000004 38                   sec
    \ 000005 e90a00               sbc     ##10
    \ 000008 1b                   tcs
    \ 000009 98                   tya
    \ 00000a 8303                 sta     3,s
    \ 00000c a5..                 lda     dp:.tiny _Dp
    \ 00000e 8305                 sta     5,s
    \ 000010 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000012 85..                 sta     dp:.tiny (_Dp+8)
0362                  	int i,j;
0363                  	for (i=0;i<=rows;i++)
    \ 000014 a90000               lda     ##0
    \ 000017 8309     `?L278`:    sta     9,s
    \ 000019 a303                 lda     3,s
    \ 00001b 38                   sec
    \ 00001c e309                 sbc     9,s
    \ 00001e 5003                 bvc     `?L231`
    \ 000020 490080               eor     ##-32768
    \ 000023 100a     `?L231`:    bpl     `?L118`
0364                  	{
0365                  		printf("%d-",i);
0366                  		for (j=0;j<cols;j++)
0367                  		{
0368                  			printf("%d ",Tracker[i][j]);
0369                  		}
0370                  		printf("\r");
0371                  	}
0372                  }
    \ 000025 3b                   tsc
    \ 000026 18                   clc
    \ 000027 690a00               adc     ##10
    \ 00002a 1b                   tcs
    \ 00002b 7a                   ply
    \ 00002c 84..                 sty     dp:.tiny (_Dp+8)
    \ 00002e 6b                   rtl
    \ 00002f a309     `?L118`:    lda     9,s
    \ 000031 48                   pha
    \ 000032 a9....               lda     ##`_StringLiteral_%d-`
    \ 000035 22......             jsl     long:printf
    \ 000039 8303                 sta     3,s
    \ 00003b 68                   pla
    \ 00003c a90000               lda     ##0
    \ 00003f 8301                 sta     1,s
    \ 000041 8307     `?L277`:    sta     7,s
    \ 000043 a307                 lda     7,s
    \ 000045 38                   sec
    \ 000046 e305                 sbc     5,s
    \ 000048 5003                 bvc     `?L234`
    \ 00004a 490080               eor     ##-32768
    \ 00004d 3010     `?L234`:    bmi     `?L122`
    \ 00004f a9....               lda     ##`_StringLiteral_[13]`
    \ 000052 22......             jsl     long:printf
    \ 000056 a309                 lda     9,s
    \ 000058 1a                   inc     a
    \ 000059 8301                 sta     1,s
    \ 00005b a301                 lda     1,s
    \ 00005d 80b8                 bra     `?L278`
    \ 00005f a305     `?L122`:    lda     5,s
    \ 000061 08                   php
    \ 000062 78                   sei
    \ 000063 8d0201               sta     258
    \ 000066 a30a                 lda     10,s
    \ 000068 8d0001               sta     256
    \ 00006b ad0401               lda     260
    \ 00006e 28                   plp
    \ 00006f 18                   clc
    \ 000070 65..                 adc     dp:.tiny (_Dp+8)
    \ 000072 a8                   tay
    \ 000073 b307                 lda     (7,s),y
    \ 000075 29ff00               and     ##255
    \ 000078 48                   pha
    \ 000079 a9....               lda     ##`_StringLiteral_%d `
    \ 00007c 22......             jsl     long:printf
    \ 000080 8303                 sta     3,s
    \ 000082 68                   pla
    \ 000083 a307                 lda     7,s
    \ 000085 1a                   inc     a
    \ 000086 8301                 sta     1,s
    \ 000088 a301                 lda     1,s
    \ 00008a 80b5                 bra     `?L277`
0373                  
0374                  // Play Trak in Track Memory
0375                  void playSongSID(int rows,int cols, unsigned char (*Tracker)[cols], int tempo)
0376                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public playSongSID
    \ 000000          playSongSID:
    \ 000000 a8                   tay
    \ 000001 3b                   tsc
    \ 000002 38                   sec
    \ 000003 e91e00               sbc     ##30
    \ 000006 1b                   tcs
    \ 000007 98                   tya
    \ 000008 8301                 sta     1,s
    \ 00000a a5..                 lda     dp:.tiny _Dp
    \ 00000c 8311                 sta     17,s
    \ 00000e a5..                 lda     dp:.tiny (_Dp+2)
    \ 000010 830d                 sta     13,s
0377                  	int i,j,note,volume,instrument,wave1,wave2,wave3;
0378                  	unsigned char hiFreq, loFreq;
0379                  	int tracks=cols/3;
    \ 000012 a311                 lda     17,s
    \ 000014 08                   php
    \ 000015 78                   sei
    \ 000016 8d1a01               sta     282
    \ 000019 a90300               lda     ##3
    \ 00001c 8d1801               sta     280
    \ 00001f ad1c01               lda     284
    \ 000022 28                   plp
    \ 000023 8303                 sta     3,s
0380                  	
0381                  	// Initialize SID CHIP
0382                  	resetSID();
    \ 000025 22......             jsl     long:resetSID
0383                  	
0384                  	// set the Default Instrument to Piano for the 3 voices
0385                  	 wave1=setInstrumentSID(1, 1);
    \ 000029 a20100               ldx     ##1
    \ 00002c 86..                 stx     dp:.tiny _Dp
    \ 00002e 8a                   txa
    \ 00002f 22......             jsl     long:setInstrumentSID
    \ 000033 8305                 sta     5,s
0386                  	 wave2=setInstrumentSID(2, 1);
    \ 000035 a20100               ldx     ##1
    \ 000038 86..                 stx     dp:.tiny _Dp
    \ 00003a a90200               lda     ##2
    \ 00003d 22......             jsl     long:setInstrumentSID
    \ 000041 8307                 sta     7,s
0387                  	 wave3=setInstrumentSID(3, 1);
    \ 000043 a20100               ldx     ##1
    \ 000046 86..                 stx     dp:.tiny _Dp
    \ 000048 a90300               lda     ##3
    \ 00004b 22......             jsl     long:setInstrumentSID
    \ 00004f 8309                 sta     9,s
0388                  	
0389                  	// Init Music playing
0390                  	for (i=0;i<=rows;i++)
    \ 000051 a90000               lda     ##0
    \ 000054 830b                 sta     11,s
    \ 000056 8313                 sta     19,s
    \ 000058 a305                 lda     5,s
    \ 00005a 830b                 sta     11,s
    \ 00005c a309                 lda     9,s
    \ 00005e 8305     `?L281`:    sta     5,s
    \ 000060 a301                 lda     1,s
    \ 000062 38                   sec
    \ 000063 e313                 sbc     19,s
    \ 000065 5003                 bvc     `?L242`
    \ 000067 490080               eor     ##-32768
    \ 00006a 1028     `?L242`:    bpl     `?L129`
0391                  	{
0392                  		for (j=0;j<tracks;j++)
0393                  		{
0394                  			// read parameters to play from Memory
0395                  			note=Tracker[i][(j*3)]; 
0396                  			volume = Tracker[i][(j*3)+1];
0397                  			instrument=Tracker[i][(j*3)+2];
0398                  			
0399                  			// If there is a note to play
0400                  			if (note != 0)
0401                  			{
0402                  				hiFreq=SidNotes[note][0];
0403                  				loFreq=SidNotes[note][1];
0404                  				switch (j)
0405                  				{
0406                  					case 0: // play voice 1
0407                  						// Gate Out previous note
0408                  						SID0_V1_CTRL = wave1-1;  
0409                  						// Set Volume 
0410                  						SID0_MODE_VOL=volume;  // Set sid chip volume, note! volume can only be controlled in track 1! 
0411                  						// if there's a new instrument change it before playing note
0412                  						wave1=setInstrumentSID(1, instrument);
0413                  
0414                  						if (note<=100)
0415                  						{
0416                  							// play new note 							
0417                  							SID0_V1_FREQ_LO = loFreq; 
0418                  							SID0_V1_FREQ_HI = hiFreq;
0419                  						}
0420                  							SID0_V1_CTRL=wave1; // Gate in New note!						
0421                  					break;
0422                  					case 1:  // play voice 2
0423                  						// Gate Out previous note
0424                  						SID0_V2_CTRL = wave2-1;
0425                  						// if there's a new instrument change it before playing note
0426                  						wave2=setInstrumentSID(2, instrument);
0427                  						if (note<=100)
0428                  						{
0429                  							// play new note 
0430                  							SID0_V2_FREQ_LO = loFreq; 
0431                  							SID0_V2_FREQ_HI = hiFreq;
0432                  						}
0433                  							SID0_V2_CTRL=wave2; // Gate in New note!						
0434                  					break;
0435                  					case 2: // play voice 3
0436                  						// Gate Out previous note
0437                  						SID0_V3_CTRL = wave3-1;  
0438                  						// if there's a new instrument change it before playing note
0439                  						wave3=setInstrumentSID(3, instrument);
0440                  						if (note<100)
0441                  						{
0442                  							// play new note 
0443                  							SID0_V3_FREQ_LO = loFreq; 
0444                  							SID0_V3_FREQ_HI = hiFreq;
0445                  						}
0446                  							SID0_V3_CTRL=wave3; // Gate in New note!
0447                  					break; 
0448                  				}
0449                  			}
0450                  		}
0451                  		delay( (65535*5)/tempo); // wait for 1/16th
0452                  	}
0453                  	SID0_V1_CTRL=wave1-1; // Gate out last note!
    \ 00006c a30b                 lda     11,s
    \ 00006e 3a                   dec     a
    \ 00006f e220                 sep     #32
    \ 000071 8f04e4af             sta     long:11527172
    \ 000075 c220                 rep     #32
0454                  	SID0_V2_CTRL=wave2-1; // Gate out last note!
    \ 000077 a307                 lda     7,s
    \ 000079 3a                   dec     a
    \ 00007a e220                 sep     #32
    \ 00007c 8f0be4af             sta     long:11527179
    \ 000080 c220                 rep     #32
0455                  	SID0_V3_CTRL=wave3-1; // Gate out last note!
    \ 000082 a305                 lda     5,s
    \ 000084 3a                   dec     a
    \ 000085 e220                 sep     #32
    \ 000087 8f12e4af             sta     long:11527186
    \ 00008b c220                 rep     #32
0456                  }
    \ 00008d 3b                   tsc
    \ 00008e 18                   clc
    \ 00008f 691e00               adc     ##30
    \ 000092 1b                   tcs
    \ 000093 6b                   rtl
    \ 000094 a90000   `?L129`:    lda     ##0
    \ 000097 831b                 sta     27,s
    \ 000099 a30b                 lda     11,s
    \ 00009b 8319                 sta     25,s
    \ 00009d a307                 lda     7,s
    \ 00009f 8317                 sta     23,s
    \ 0000a1 a305                 lda     5,s
    \ 0000a3 8315     `?L280`:    sta     21,s
    \ 0000a5 a31b                 lda     27,s
    \ 0000a7 38                   sec
    \ 0000a8 e303                 sbc     3,s
    \ 0000aa 5003                 bvc     `?L244`
    \ 0000ac 490080               eor     ##-32768
    \ 0000af 3039     `?L244`:    bmi     `?L133`
    \ 0000b1 a9fbff               lda     ##65531
    \ 0000b4 85..                 sta     dp:.tiny _Dp
    \ 0000b6 a90400               lda     ##4
    \ 0000b9 85..                 sta     dp:.tiny (_Dp+2)
    \ 0000bb a322                 lda     34,s
    \ 0000bd a20000               ldx     ##0
    \ 0000c0 a8                   tay
    \ 0000c1 1001                 bpl     `?L246`
    \ 0000c3 ca                   dex
    \ 0000c4          `?L246`:
    \ 0000c4 86..                 stx     dp:.tiny (_Dp+6)
    \ 0000c6 85..                 sta     dp:.tiny (_Dp+4)
    \ 0000c8 22......             jsl     long:_Div32
    \ 0000cc 22......             jsl     long:_SInt32ToFloat32
    \ 0000d0 22......             jsl     long:delay
    \ 0000d4 a313                 lda     19,s
    \ 0000d6 1a                   inc     a
    \ 0000d7 8305                 sta     5,s
    \ 0000d9 a305                 lda     5,s
    \ 0000db 8313                 sta     19,s
    \ 0000dd a319                 lda     25,s
    \ 0000df 830b                 sta     11,s
    \ 0000e1 a317                 lda     23,s
    \ 0000e3 8307                 sta     7,s
    \ 0000e5 a315                 lda     21,s
    \ 0000e7 4c....               jmp     .kbank `?L281`
    \ 0000ea a31b     `?L133`:    lda     27,s
    \ 0000ec 8307                 sta     7,s
    \ 0000ee 8305                 sta     5,s
    \ 0000f0 a307                 lda     7,s
    \ 0000f2 0a                   asl     a
    \ 0000f3 8307                 sta     7,s
    \ 0000f5 18                   clc
    \ 0000f6 6305                 adc     5,s
    \ 0000f8 8305                 sta     5,s
    \ 0000fa a311                 lda     17,s
    \ 0000fc 08                   php
    \ 0000fd 78                   sei
    \ 0000fe 8d0201               sta     258
    \ 000101 a314                 lda     20,s
    \ 000103 8d0001               sta     256
    \ 000106 ad0401               lda     260
    \ 000109 28                   plp
    \ 00010a 18                   clc
    \ 00010b 630d                 adc     13,s
    \ 00010d a8                   tay
    \ 00010e b305                 lda     (5,s),y
    \ 000110 29ff00               and     ##255
    \ 000113 831d                 sta     29,s
    \ 000115 a31b                 lda     27,s
    \ 000117 8307                 sta     7,s
    \ 000119 8305                 sta     5,s
    \ 00011b a307                 lda     7,s
    \ 00011d 0a                   asl     a
    \ 00011e 8307                 sta     7,s
    \ 000120 18                   clc
    \ 000121 6305                 adc     5,s
    \ 000123 8305                 sta     5,s
    \ 000125 a311                 lda     17,s
    \ 000127 08                   php
    \ 000128 78                   sei
    \ 000129 8d0201               sta     258
    \ 00012c a314                 lda     20,s
    \ 00012e 8d0001               sta     256
    \ 000131 ad0401               lda     260
    \ 000134 28                   plp
    \ 000135 18                   clc
    \ 000136 630d                 adc     13,s
    \ 000138 85..                 sta     dp:.tiny _Dp
    \ 00013a a305                 lda     5,s
    \ 00013c 22......             jsl     long:`?L293`
    \ 000140 8305                 sta     5,s
    \ 000142 a31b                 lda     27,s
    \ 000144 8309                 sta     9,s
    \ 000146 8307                 sta     7,s
    \ 000148 a309                 lda     9,s
    \ 00014a 0a                   asl     a
    \ 00014b 8309                 sta     9,s
    \ 00014d 18                   clc
    \ 00014e 6307                 adc     7,s
    \ 000150 8307                 sta     7,s
    \ 000152 a311                 lda     17,s
    \ 000154 08                   php
    \ 000155 78                   sei
    \ 000156 8d0201               sta     258
    \ 000159 a314                 lda     20,s
    \ 00015b 8d0001               sta     256
    \ 00015e ad0401               lda     260
    \ 000161 28                   plp
    \ 000162 18                   clc
    \ 000163 630d                 adc     13,s
    \ 000165 85..                 sta     dp:.tiny _Dp
    \ 000167 a307                 lda     7,s
    \ 000169 1a                   inc     a
    \ 00016a 22......             jsl     long:`?L293`
    \ 00016e 8307                 sta     7,s
    \ 000170 a31d                 lda     29,s
    \ 000172 d003                 bne     `?L347`
    \ 000174 4c....               jmp     .kbank `?L137`
    \ 000177 1a       `?L347`:    inc     a
    \ 000178 3a                   dec     a
    \ 000179 0a                   asl     a
    \ 00017a aa                   tax
    \ 00017b e220                 sep     #32
    \ 00017d bd....               lda     SidNotes,x
    \ 000180 8309                 sta     9,s
    \ 000182 c220                 rep     #32
    \ 000184 a31d                 lda     29,s
    \ 000186 0a                   asl     a
    \ 000187 18                   clc
    \ 000188 69....               adc     ##SidNotes
    \ 00018b aa                   tax
    \ 00018c e220                 sep     #32
    \ 00018e bd0100               lda     1,x
    \ 000191 830b                 sta     11,s
    \ 000193 c220                 rep     #32
    \ 000195 a31b                 lda     27,s
    \ 000197 830f                 sta     15,s
    \ 000199 d003                 bne     `?L348`
    \ 00019b 4c....               jmp     .kbank `?L144`
    \ 00019e a30f     `?L348`:    lda     15,s
    \ 0001a0 c90100               cmp     ##1
    \ 0001a3 f05a                 beq     `?L143`
    \ 0001a5 1a                   inc     a
    \ 0001a6 3a                   dec     a
    \ 0001a7 c90200               cmp     ##2
    \ 0001aa f009                 beq     `?L142`
    \ 0001ac a319                 lda     25,s
    \ 0001ae 8309                 sta     9,s
    \ 0001b0 a317                 lda     23,s
    \ 0001b2 4c....               jmp     .kbank `?L279`
    \ 0001b5 a315     `?L142`:    lda     21,s
    \ 0001b7 3a                   dec     a
    \ 0001b8 e220                 sep     #32
    \ 0001ba 8f12e4af             sta     long:11527186
    \ 0001be c220                 rep     #32
    \ 0001c0 a307                 lda     7,s
    \ 0001c2 85..                 sta     dp:.tiny _Dp
    \ 0001c4 a90300               lda     ##3
    \ 0001c7 22......             jsl     long:setInstrumentSID
    \ 0001cb 8305                 sta     5,s
    \ 0001cd a31d                 lda     29,s
    \ 0001cf 38                   sec
    \ 0001d0 e96400               sbc     ##100
    \ 0001d3 5003                 bvc     `?L252`
    \ 0001d5 490080               eor     ##-32768
    \ 0001d8 1010     `?L252`:    bpl     `?L154`
    \ 0001da e220                 sep     #32
    \ 0001dc a30b                 lda     11,s
    \ 0001de 8f0ee4af             sta     long:11527182
    \ 0001e2 a309                 lda     9,s
    \ 0001e4 8f0fe4af             sta     long:11527183
    \ 0001e8 c220                 rep     #32
    \ 0001ea e220     `?L154`:    sep     #32
    \ 0001ec a305                 lda     5,s
    \ 0001ee 8f12e4af             sta     long:11527186
    \ 0001f2 c220                 rep     #32
    \ 0001f4 a319                 lda     25,s
    \ 0001f6 8309                 sta     9,s
    \ 0001f8 a317                 lda     23,s
    \ 0001fa 8307                 sta     7,s
    \ 0001fc 4c....               jmp     .kbank `?L135`
    \ 0001ff a317     `?L143`:    lda     23,s
    \ 000201 3a                   dec     a
    \ 000202 e220                 sep     #32
    \ 000204 8f0be4af             sta     long:11527179
    \ 000208 c220                 rep     #32
    \ 00020a a307                 lda     7,s
    \ 00020c 85..                 sta     dp:.tiny _Dp
    \ 00020e a90200               lda     ##2
    \ 000211 22......             jsl     long:setInstrumentSID
    \ 000215 8305                 sta     5,s
    \ 000217 a96400               lda     ##100
    \ 00021a 38                   sec
    \ 00021b e31d                 sbc     29,s
    \ 00021d 5003                 bvc     `?L255`
    \ 00021f 490080               eor     ##-32768
    \ 000222 3010     `?L255`:    bmi     `?L150`
    \ 000224 e220                 sep     #32
    \ 000226 a30b                 lda     11,s
    \ 000228 8f07e4af             sta     long:11527175
    \ 00022c a309                 lda     9,s
    \ 00022e 8f08e4af             sta     long:11527176
    \ 000232 c220                 rep     #32
    \ 000234 e220     `?L150`:    sep     #32
    \ 000236 a305                 lda     5,s
    \ 000238 8f0be4af             sta     long:11527179
    \ 00023c c220                 rep     #32
    \ 00023e a319                 lda     25,s
    \ 000240 8309                 sta     9,s
    \ 000242 a305                 lda     5,s
    \ 000244 804b                 bra     `?L279`
    \ 000246 a319     `?L144`:    lda     25,s
    \ 000248 3a                   dec     a
    \ 000249 e220                 sep     #32
    \ 00024b 8f04e4af             sta     long:11527172
    \ 00024f a305                 lda     5,s
    \ 000251 8f18e4af             sta     long:11527192
    \ 000255 c220                 rep     #32
    \ 000257 a307                 lda     7,s
    \ 000259 85..                 sta     dp:.tiny _Dp
    \ 00025b a90100               lda     ##1
    \ 00025e 22......             jsl     long:setInstrumentSID
    \ 000262 8305                 sta     5,s
    \ 000264 a96400               lda     ##100
    \ 000267 38                   sec
    \ 000268 e31d                 sbc     29,s
    \ 00026a 5003                 bvc     `?L258`
    \ 00026c 490080               eor     ##-32768
    \ 00026f 3010     `?L258`:    bmi     `?L146`
    \ 000271 e220                 sep     #32
    \ 000273 a30b                 lda     11,s
    \ 000275 8f00e4af             sta     long:11527168
    \ 000279 a309                 lda     9,s
    \ 00027b 8f01e4af             sta     long:11527169
    \ 00027f c220                 rep     #32
    \ 000281 e220     `?L146`:    sep     #32
    \ 000283 a305                 lda     5,s
    \ 000285 8f04e4af             sta     long:11527172
    \ 000289 c220                 rep     #32
    \ 00028b a305                 lda     5,s
    \ 00028d 8309                 sta     9,s
    \ 00028f a317                 lda     23,s
    \ 000291 8307     `?L279`:    sta     7,s
    \ 000293 a315                 lda     21,s
    \ 000295 8305                 sta     5,s
    \ 000297 800c                 bra     `?L135`
    \ 000299 a319     `?L137`:    lda     25,s
    \ 00029b 8309                 sta     9,s
    \ 00029d a317                 lda     23,s
    \ 00029f 8307                 sta     7,s
    \ 0002a1 a315                 lda     21,s
    \ 0002a3 8305                 sta     5,s
    \ 0002a5 a31b     `?L135`:    lda     27,s
    \ 0002a7 1a                   inc     a
    \ 0002a8 830b                 sta     11,s
    \ 0002aa a30b                 lda     11,s
    \ 0002ac 831b                 sta     27,s
    \ 0002ae a309                 lda     9,s
    \ 0002b0 8319                 sta     25,s
    \ 0002b2 a307                 lda     7,s
    \ 0002b4 8317                 sta     23,s
    \ 0002b6 a305                 lda     5,s
    \ 0002b8 4c....               jmp     .kbank `?L280`
0457                  
0458                  
0459                  int setInstrumentSID(int voice, int instrument)
0460                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public setInstrumentSID
    \ 000000          setInstrumentSID:
    \ 000000 a8                   tay
    \ 000001 3b                   tsc
    \ 000002 38                   sec
    \ 000003 e90c00               sbc     ##12
    \ 000006 1b                   tcs
    \ 000007 98                   tya
    \ 000008 8301                 sta     1,s
0461                  	int attack,decay,sustain,release,waveform,pulseWidth;
0462                  	
0463                  	instrument-=1;
    \ 00000a a5..                 lda     dp:.tiny _Dp
    \ 00000c 3a                   dec     a
    \ 00000d a8                   tay
0464                  	
0465                  	attack = SID_envelope[instrument][0];
    \ 00000e 98                   tya
    \ 00000f 0a                   asl     a
    \ 000010 0a                   asl     a
    \ 000011 0a                   asl     a
    \ 000012 0a                   asl     a
    \ 000013 aa                   tax
    \ 000014 bd....               lda     SID_envelope,x
    \ 000017 8303                 sta     3,s
0466                  	decay=SID_envelope[instrument][1];
0467                  	sustain=SID_envelope[instrument][2];
0468                  	release=SID_envelope[instrument][3];
0469                  	waveform=SID_envelope[instrument][4];
0470                  	pulseWidth=SID_envelope[instrument][5];		
0471                  
0472                  	//printf(".");
0473                  	//printf("Voice %d - A:%d D:%d S:%d R:%d WF:%d PWL:%d PWH:%d\r",voice,attack,decay,sustain,release,waveform,pulseWidth & 0x00FF, (pulseWidth - (pulseWidth & 0x00FF))/256);
0474                  	
0475                  	// configure selected Voice
0476                  	switch (voice)
    \ 000019 22......             jsl     long:`?L287`
    \ 00001d aa                   tax
    \ 00001e bd0200               lda     2,x
    \ 000021 8305                 sta     5,s
    \ 000023 22......             jsl     long:`?L287`
    \ 000027 aa                   tax
    \ 000028 bd0400               lda     4,x
    \ 00002b 8307                 sta     7,s
    \ 00002d 22......             jsl     long:`?L287`
    \ 000031 aa                   tax
    \ 000032 bd0600               lda     6,x
    \ 000035 8309                 sta     9,s
    \ 000037 22......             jsl     long:`?L287`
    \ 00003b aa                   tax
    \ 00003c bd0800               lda     8,x
    \ 00003f 830b                 sta     11,s
    \ 000041 22......             jsl     long:`?L287`
    \ 000045 a8                   tay
    \ 000046 be0a00               ldx     10,y
    \ 000049 a301                 lda     1,s
    \ 00004b c90100               cmp     ##1
    \ 00004e f07c                 beq     `?L164`
    \ 000050 a301                 lda     1,s
    \ 000052 c90200               cmp     ##2
    \ 000055 f040                 beq     `?L163`
    \ 000057 c90300               cmp     ##3
    \ 00005a f006                 beq     `?L162`
0477                  	{
0478                  		case 1:
0479                  			// SET VOICE 1 Parameters
0480                  			// set Attack/Decay /Sustain/release parameters	
0481                  			SID0_V1_ATCK_DECY = attack*16+decay;
0482                  			SID0_V1_SSTN_RLSE = sustain*16+release;
0483                  			// Set PulseWidth
0484                  			SID0_V1_PW_LO = pulseWidth & 0x00FF;
0485                  			SID0_V1_PW_HI = (int) pulseWidth /256;
0486                  			//Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc1->Osc2 (bit 2), Sync Osc1->Osc2 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0487                  			return waveform*16+1;
0488                  			break;
0489                  		case 2:
0490                  			// SET VOICE 2 Parameters
0491                  			// set Attack/Decay /Sustain/release parameters	
0492                  			SID0_V2_ATCK_DECY = attack*16+decay;
0493                  			SID0_V2_SSTN_RLSE = sustain*16+release;
0494                  			// Set PulseWidth
0495                  			SID0_V2_PW_LO = pulseWidth & 0x00FF;
0496                  			SID0_V2_PW_HI = (int) pulseWidth /256;
0497                  			//Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc1->Osc2 (bit 2), Sync Osc1->Osc2 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0498                  			return waveform*16+1;
0499                  			break;
0500                  		case 3:
0501                  			// SET VOICE 3 Parameters
0502                  			// set Attack/Decay /Sustain/release parameters	
0503                  			SID0_V3_ATCK_DECY = attack*16+decay;
0504                  			SID0_V3_SSTN_RLSE = sustain*16+release;
0505                  			// Set PulseWidth
0506                  			SID0_V3_PW_LO = pulseWidth & 0x00FF;
0507                  			SID0_V3_PW_HI = (int) pulseWidth /256;
0508                  			//Control Register (Write Only) [Noise Wave (bit 7), Pulse Wave (bit 6), Saw Wave (bit 5), Triangle Wave (bit 4), Test (bit 3), Ring Modulate Osc1->Osc2 (bit 2), Sync Osc1->Osc2 (bit 1), Gate Bit (bit 0, 1-initiate Atk/sus/Dec, 0 - Initiate Rel)]
0509                  			return waveform*16+1;
0510                  			break;
0511                  	}
0512                  	return 0;
    \ 00005c a90000               lda     ##0
    \ 00005f 4c....               jmp     .kbank `?L159`
    \ 000062          `?L162`:
    \ 000062 22......             jsl     long:`?L284`
    \ 000066 8f13e4af             sta     long:11527187
    \ 00006a 22......             jsl     long:`?L285`
    \ 00006e e220                 sep     #32
    \ 000070 8f14e4af             sta     long:11527188
    \ 000074 c220                 rep     #32
    \ 000076 8a                   txa
    \ 000077 e220                 sep     #32
    \ 000079 8f10e4af             sta     long:11527184
    \ 00007d c220                 rep     #32
    \ 00007f 8a                   txa
    \ 000080 08                   php
    \ 000081 78                   sei
    \ 000082 8d1a01               sta     282
    \ 000085 a90001               lda     ##256
    \ 000088 8d1801               sta     280
    \ 00008b ad1c01               lda     284
    \ 00008e 28                   plp
    \ 00008f e220                 sep     #32
    \ 000091 8f11e4af             sta     long:11527185
    \ 000095 8068                 bra     `?L282`
    \ 000097          `?L163`:
    \ 000097 22......             jsl     long:`?L284`
    \ 00009b 8f0ce4af             sta     long:11527180
    \ 00009f 22......             jsl     long:`?L285`
    \ 0000a3 e220                 sep     #32
    \ 0000a5 8f0de4af             sta     long:11527181
    \ 0000a9 c220                 rep     #32
    \ 0000ab 8a                   txa
    \ 0000ac e220                 sep     #32
    \ 0000ae 8f09e4af             sta     long:11527177
    \ 0000b2 c220                 rep     #32
    \ 0000b4 8a                   txa
    \ 0000b5 08                   php
    \ 0000b6 78                   sei
    \ 0000b7 8d1a01               sta     282
    \ 0000ba a90001               lda     ##256
    \ 0000bd 8d1801               sta     280
    \ 0000c0 ad1c01               lda     284
    \ 0000c3 28                   plp
    \ 0000c4 e220                 sep     #32
    \ 0000c6 8f0ae4af             sta     long:11527178
    \ 0000ca 8033                 bra     `?L282`
    \ 0000cc          `?L164`:
    \ 0000cc 22......             jsl     long:`?L284`
    \ 0000d0 8f05e4af             sta     long:11527173
    \ 0000d4 22......             jsl     long:`?L285`
    \ 0000d8 e220                 sep     #32
    \ 0000da 8f06e4af             sta     long:11527174
    \ 0000de c220                 rep     #32
    \ 0000e0 8a                   txa
    \ 0000e1 e220                 sep     #32
    \ 0000e3 8f02e4af             sta     long:11527170
    \ 0000e7 c220                 rep     #32
    \ 0000e9 8a                   txa
    \ 0000ea 08                   php
    \ 0000eb 78                   sei
    \ 0000ec 8d1a01               sta     282
    \ 0000ef a90001               lda     ##256
    \ 0000f2 8d1801               sta     280
    \ 0000f5 ad1c01               lda     284
    \ 0000f8 28                   plp
    \ 0000f9 e220                 sep     #32
    \ 0000fb 8f03e4af             sta     long:11527171
    \ 0000ff c220     `?L282`:    rep     #32
    \ 000101 a30b                 lda     11,s
    \ 000103 0a                   asl     a
    \ 000104 0a                   asl     a
    \ 000105 0a                   asl     a
    \ 000106 0a                   asl     a
    \ 000107 1a                   inc     a
    \ 000108          `?L159`:
0513                  }
    \ 000108 a8                   tay
    \ 000109 3b                   tsc
    \ 00010a 18                   clc
    \ 00010b 690c00               adc     ##12
    \ 00010e 1b                   tcs
    \ 00010f 98                   tya
    \ 000110 6b                   rtl
0514                  
0515                  void delay (float value)
0516                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public delay
    \ 000000          delay:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 86..                 stx     dp:.tiny (_Dp+10)
    \ 000006 85..                 sta     dp:.tiny (_Dp+8)
0517                  	// Just a Busy loop to waste time!
0518                  	float i;
0519                  	for (i=0;i<value;i++)
    \ 000008 a90000               lda     ##0
    \ 00000b 85..                 sta     dp:.tiny (_Dp+4)
    \ 00000d 85..                 sta     dp:.tiny (_Dp+6)
    \ 00000f          `?L176`:
    \ 00000f a6..                 ldx     dp:.tiny (_Dp+6)
    \ 000011 a5..                 lda     dp:.tiny (_Dp+4)
    \ 000013 a4..                 ldy     dp:.tiny (_Dp+8)
    \ 000015 84..                 sty     dp:.tiny _Dp
    \ 000017 a4..                 ldy     dp:.tiny (_Dp+10)
    \ 000019 84..                 sty     dp:.tiny (_Dp+2)
    \ 00001b 22......             jsl     long:_Float32LT
    \ 00001f 9007                 bcc     `?L177`
0520                  		;
0521                  }
    \ 000021 7a                   ply
    \ 000022 84..                 sty     dp:.tiny (_Dp+10)
    \ 000024 7a                   ply
    \ 000025 84..                 sty     dp:.tiny (_Dp+8)
    \ 000027 6b                   rtl
    \ 000028          `?L177`:
    \ 000028 a5..                 lda     dp:.tiny (_Dp+4)
    \ 00002a 85..                 sta     dp:.tiny _Dp
    \ 00002c a5..                 lda     dp:.tiny (_Dp+6)
    \ 00002e 85..                 sta     dp:.tiny (_Dp+2)
    \ 000030 a90000               lda     ##0
    \ 000033 a2803f               ldx     ##16256
    \ 000036 22......             jsl     long:_Float32Add
    \ 00003a 86..                 stx     dp:.tiny (_Dp+6)
    \ 00003c 85..                 sta     dp:.tiny (_Dp+4)
    \ 00003e 80cf                 bra     `?L176`
0522                  
0523                  void resetSID()
0524                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public resetSID
    \ 000000          resetSID:
0525                  	SID0_V1_FREQ_LO=0;
    \ 000000 e220                 sep     #32
    \ 000002 a900                 lda     #0
    \ 000004 8f00e4af             sta     long:11527168
0526                  	SID0_V1_FREQ_HI=0;
    \ 000008 8f01e4af             sta     long:11527169
0527                  	SID0_V1_PW_LO=0;
    \ 00000c 8f02e4af             sta     long:11527170
0528                  	SID0_V1_PW_HI=0;
    \ 000010 8f03e4af             sta     long:11527171
0529                  	SID0_V1_CTRL=0;
    \ 000014 8f04e4af             sta     long:11527172
0530                  	SID0_V1_ATCK_DECY=0;
    \ 000018 8f05e4af             sta     long:11527173
0531                  	SID0_V1_SSTN_RLSE=0;
    \ 00001c 8f06e4af             sta     long:11527174
0532                  	SID0_V2_FREQ_LO=0;
    \ 000020 8f07e4af             sta     long:11527175
0533                  	SID0_V2_FREQ_HI=0;
    \ 000024 8f08e4af             sta     long:11527176
0534                  	SID0_V2_PW_LO=0;
    \ 000028 8f09e4af             sta     long:11527177
0535                  	SID0_V2_PW_HI=0;
    \ 00002c 8f0ae4af             sta     long:11527178
0536                  	SID0_V2_CTRL=0;
    \ 000030 8f0be4af             sta     long:11527179
0537                  	SID0_V2_ATCK_DECY=0;
    \ 000034 8f0ce4af             sta     long:11527180
0538                  	SID0_V2_SSTN_RLSE=0;
    \ 000038 8f0de4af             sta     long:11527181
0539                  	SID0_V3_FREQ_LO=0;
    \ 00003c 8f0ee4af             sta     long:11527182
0540                  	SID0_V3_FREQ_HI=0;
    \ 000040 8f0fe4af             sta     long:11527183
0541                  	SID0_V3_PW_LO=0;
    \ 000044 8f10e4af             sta     long:11527184
0542                  	SID0_V3_PW_HI=0;
    \ 000048 8f11e4af             sta     long:11527185
0543                  	SID0_V3_CTRL=0;
    \ 00004c 8f12e4af             sta     long:11527186
0544                  	SID0_V3_ATCK_DECY=0;
    \ 000050 8f13e4af             sta     long:11527187
0545                  	SID0_V3_SSTN_RLSE=0;
    \ 000054 8f14e4af             sta     long:11527188
0546                  	SID0_FC_LO=0;
    \ 000058 8f15e4af             sta     long:11527189
0547                  	SID0_FC_HI=0;
    \ 00005c 8f16e4af             sta     long:11527190
0548                  	SID0_RES_FILT=0;
    \ 000060 8f17e4af             sta     long:11527191
0549                  	SID0_MODE_VOL=0;
    \ 000064 8f18e4af             sta     long:11527192
    \ 000068 c220                 rep     #32
0550                  }
    \ 00006a 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 1a       `?L283`:    inc     a
    \ 000001 18                   clc
    \ 000002 65..                 adc     dp:.tiny _Dp
    \ 000004 aa                   tax
    \ 000005 a316                 lda     22,s
    \ 000007 e220                 sep     #32
    \ 000009 9d0000               sta     0,x
    \ 00000c c220                 rep     #32
    \ 00000e a325                 lda     37,s
    \ 000010 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a306     `?L284`:    lda     6,s
    \ 000002 e220                 sep     #32
    \ 000004 0a                   asl     a
    \ 000005 0a                   asl     a
    \ 000006 0a                   asl     a
    \ 000007 0a                   asl     a
    \ 000008 c220                 rep     #32
    \ 00000a 18                   clc
    \ 00000b 6308                 adc     8,s
    \ 00000d e220                 sep     #32
    \ 00000f 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 c220     `?L285`:    rep     #32
    \ 000002 a30a                 lda     10,s
    \ 000004 e220                 sep     #32
    \ 000006 0a                   asl     a
    \ 000007 0a                   asl     a
    \ 000008 0a                   asl     a
    \ 000009 0a                   asl     a
    \ 00000a c220                 rep     #32
    \ 00000c 18                   clc
    \ 00000d 630c                 adc     12,s
    \ 00000f 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 1a       `?L286`:    inc     a
    \ 000001 18                   clc
    \ 000002 65..                 adc     dp:.tiny _Dp
    \ 000004 aa                   tax
    \ 000005 e220                 sep     #32
    \ 000007 a900                 lda     #0
    \ 000009 9d0000               sta     0,x
    \ 00000c c220                 rep     #32
    \ 00000e 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 98       `?L287`:    tya
    \ 000001 0a                   asl     a
    \ 000002 0a                   asl     a
    \ 000003 0a                   asl     a
    \ 000004 0a                   asl     a
    \ 000005 18                   clc
    \ 000006 69....               adc     ##SID_envelope
    \ 000009 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 1a       `?L288`:    inc     a
    \ 000001 18                   clc
    \ 000002 65..                 adc     dp:.tiny _Dp
    \ 000004 aa                   tax
    \ 000005 a31e                 lda     30,s
    \ 000007 e220                 sep     #32
    \ 000009 9d0000               sta     0,x
    \ 00000c c220                 rep     #32
    \ 00000e a310                 lda     16,s
    \ 000010 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a327     `?L289`:    lda     39,s
    \ 000002 a8                   tay
    \ 000003 b31a                 lda     (26,s),y
    \ 000005 e220                 sep     #32
    \ 000007 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 29ff00   `?L290`:    and     ##255
    \ 000003 38                   sec
    \ 000004 e93000               sbc     ##48
    \ 000007 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 18       `?L291`:    clc
    \ 000001 691d00               adc     ##29
    \ 000004 a8                   tay
    \ 000005 8a                   txa
    \ 000006 e220                 sep     #32
    \ 000008 9316                 sta     (22,s),y
    \ 00000a c220                 rep     #32
    \ 00000c 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 18       `?L292`:    clc
    \ 000001 632f                 adc     47,s
    \ 000003 a8                   tay
    \ 000004 e220                 sep     #32
    \ 000006 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 1a       `?L293`:    inc     a
    \ 000001 18                   clc
    \ 000002 65..                 adc     dp:.tiny _Dp
    \ 000004 aa                   tax
    \ 000005 bd0000               lda     0,x
    \ 000008 29ff00               and     ##255
    \ 00000b 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 e220     `?L294`:    sep     #32
    \ 000002 c930                 cmp     #48
    \ 000004 c220                 rep     #32
    \ 000006 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a327     `?L295`:    lda     39,s
    \ 000002 a8                   tay
    \ 000003 b30a                 lda     (10,s),y
    \ 000005 e220                 sep     #32
    \ 000007 6b                   rtl
    \ 000000                      .section switch,rodata
    \ 000000 0400     `?L188`:    .word   4
    \ 000002 ....                 .word   .word0 (`?L33`-1)
    \ 000004 6800                 .word   104
    \ 000006 ....                 .word   .word0 (`?L37`-1)
    \ 000008 7100                 .word   113
    \ 00000a ....                 .word   .word0 (`?L36`-1)
    \ 00000c 7300                 .word   115
    \ 00000e ....                 .word   .word0 (`?L34`-1)
    \ 000010 7400                 .word   116
    \ 000012 ....                 .word   .word0 (`?L35`-1)
    \ 000014 7700                 .word   119
    \ 000016 ....                 .word   .word0 (`?L38`-1)
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[13]`
    \ 000000          `_StringLiteral_[13]`:
    \ 000000 0d00                 .byte   13,0
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_%c`
    \ 000000          `_StringLiteral_%c`:
    \ 000000 256300               .byte   37,99,0
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_%d `
    \ 000000          `_StringLiteral_%d `:
    \ 000000 25642000             .byte   37,100,32,0
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_%d-`
    \ 000000          `_StringLiteral_%d-`:
    \ 000000 25642d00             .byte   37,100,45,0
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[60,45,32,85,110,101,120,112,101,99,116,101,100,32,99,104,97,114,97,99,116,101,114,13]`
    \ 000000          `_StringLiteral_[60,45,32,85,110,101,120,112,101,99,116,101,100,32,99,104,97,114,97,99,116,101,114,13]`:
    \ 000000 3c2d2055             .byte   60,45,32,85,110,101,120,112,101,99,116,101,100,32,99,104,97,114,97,99,116,101,114,13,0
    \ 000004 6e657870
    \ 000008 65637465
    \ 00000c 64206368
    \ 000010 61726163
    \ 000014 7465720d
    \ 000018 00

##########################
#                        #
# Memory sizes (decimal) #
#                        #
##########################

Executable        (Text): 3700 bytes
Constant                : 1270 bytes
Constant   __far        :   24 bytes
